var session=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=543)}([function(t,e,n){"use strict";var r=n(2),i=n(26),o=n(18),s=n(17),a=n(25),c=function t(e,n,c){var u,f,l,h,p=e&t.F,d=e&t.G,y=e&t.P,v=e&t.B,g=d?r:e&t.S?r[n]||(r[n]={}):(r[n]||{}).prototype,m=d?i:i[n]||(i[n]={}),b=m.prototype||(m.prototype={});for(u in d&&(c=n),c)l=((f=!p&&g&&void 0!==g[u])?g:c)[u],h=v&&f?a(l,r):y&&"function"==typeof l?a(Function.call,l):l,g&&s(g,u,l,e&t.U),m[u]!=l&&o(m,u,h),y&&b[u]!=l&&(b[u]=l)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e,n){"use strict";var r=n(4);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){"use strict";var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e,n){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){return"object"===(void 0===t?"undefined":r(t))?null!==t:"function"==typeof t}},function(t,e,n){"use strict";var r=n(84)("wks"),i=n(46),o=n(2).Symbol,s="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=s&&o[t]||(s?o:i)("Symbol."+t))}).store=r},function(t,e,n){"use strict";var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"===("undefined"==typeof window?"undefined":i(window))&&(r=window)}t.exports=r},function(t,e,n){"use strict";var r=n(30),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){"use strict";var r=n(1),i=n(188),o=n(32),s=Object.defineProperty;e.f=n(9)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";t.exports=!n(3)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){"use strict";var r=n(31);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";(function(t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=200,o="__lodash_hash_undefined__",s=800,a=16,c=9007199254740991,u="[object Arguments]",f="[object AsyncFunction]",l="[object Function]",h="[object GeneratorFunction]",p="[object Null]",d="[object Object]",y="[object Proxy]",v="[object Undefined]",g=/^\[object .+?Constructor\]$/,m=/^(?:0|[1-9]\d*)$/,b={};b["[object Float32Array]"]=b["[object Float64Array]"]=b["[object Int8Array]"]=b["[object Int16Array]"]=b["[object Int32Array]"]=b["[object Uint8Array]"]=b["[object Uint8ClampedArray]"]=b["[object Uint16Array]"]=b["[object Uint32Array]"]=!0,b[u]=b["[object Array]"]=b["[object ArrayBuffer]"]=b["[object Boolean]"]=b["[object DataView]"]=b["[object Date]"]=b["[object Error]"]=b[l]=b["[object Map]"]=b["[object Number]"]=b[d]=b["[object RegExp]"]=b["[object Set]"]=b["[object String]"]=b["[object WeakMap]"]=!1;var _="object"==(void 0===t?"undefined":r(t))&&t&&t.Object===Object&&t,w="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,C=_||w||Function("return this")(),k="object"==r(e)&&e&&!e.nodeType&&e,S=k&&"object"==r(n)&&n&&!n.nodeType&&n,E=S&&S.exports===k,x=E&&_.process,O=function(){try{return x&&x.binding&&x.binding("util")}catch(t){}}(),A=O&&O.isTypedArray;function P(t,e){return"__proto__"==e?void 0:t[e]}var j,T,M,R=Array.prototype,I=Function.prototype,F=Object.prototype,N=C["__core-js_shared__"],D=I.toString,B=F.hasOwnProperty,L=(j=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"",U=F.toString,q=D.call(Object),z=RegExp("^"+D.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=E?C.Buffer:void 0,W=C.Symbol,J=C.Uint8Array,H=V?V.allocUnsafe:void 0,$=(T=Object.getPrototypeOf,M=Object,function(t){return T(M(t))}),G=Object.create,Y=F.propertyIsEnumerable,Q=R.splice,X=W?W.toStringTag:void 0,Z=function(){try{var t=kt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),K=V?V.isBuffer:void 0,tt=Math.max,et=Date.now,nt=kt(C,"Map"),rt=kt(Object,"create"),it=function(){function t(){}return function(e){if(!It(e))return{};if(G)return G(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function ot(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function st(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function at(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function ct(t){var e=this.__data__=new st(t);this.size=e.size}function ut(t,e){var n=Pt(t),r=!n&&At(t),i=!n&&!r&&Tt(t),o=!n&&!r&&!i&&Nt(t),s=n||r||i||o,a=s?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=a.length;for(var u in t)!e&&!B.call(t,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||St(u,c))||a.push(u);return a}function ft(t,e,n){(void 0===n||Ot(t[e],n))&&(void 0!==n||e in t)||pt(t,e,n)}function lt(t,e,n){var r=t[e];B.call(t,e)&&Ot(r,n)&&(void 0!==n||e in t)||pt(t,e,n)}function ht(t,e){for(var n=t.length;n--;)if(Ot(t[n][0],e))return n;return-1}function pt(t,e,n){"__proto__"==e&&Z?Z(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}ot.prototype.clear=function(){this.__data__=rt?rt(null):{},this.size=0},ot.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ot.prototype.get=function(t){var e=this.__data__;if(rt){var n=e[t];return n===o?void 0:n}return B.call(e,t)?e[t]:void 0},ot.prototype.has=function(t){var e=this.__data__;return rt?void 0!==e[t]:B.call(e,t)},ot.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=rt&&void 0===e?o:e,this},st.prototype.clear=function(){this.__data__=[],this.size=0},st.prototype.delete=function(t){var e=this.__data__,n=ht(e,t);return!(n<0||(n==e.length-1?e.pop():Q.call(e,n,1),--this.size,0))},st.prototype.get=function(t){var e=this.__data__,n=ht(e,t);return n<0?void 0:e[n][1]},st.prototype.has=function(t){return ht(this.__data__,t)>-1},st.prototype.set=function(t,e){var n=this.__data__,r=ht(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},at.prototype.clear=function(){this.size=0,this.__data__={hash:new ot,map:new(nt||st),string:new ot}},at.prototype.delete=function(t){var e=Ct(this,t).delete(t);return this.size-=e?1:0,e},at.prototype.get=function(t){return Ct(this,t).get(t)},at.prototype.has=function(t){return Ct(this,t).has(t)},at.prototype.set=function(t,e){var n=Ct(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},ct.prototype.clear=function(){this.__data__=new st,this.size=0},ct.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},ct.prototype.get=function(t){return this.__data__.get(t)},ct.prototype.has=function(t){return this.__data__.has(t)},ct.prototype.set=function(t,e){var n=this.__data__;if(n instanceof st){var r=n.__data__;if(!nt||r.length<i-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new at(r)}return n.set(t,e),this.size=n.size,this};var dt,yt=function(t,e,n){for(var r=-1,i=Object(t),o=n(t),s=o.length;s--;){var a=o[dt?s:++r];if(!1===e(i[a],a,i))break}return t};function vt(t){return null==t?void 0===t?v:p:X&&X in Object(t)?function(t){var e=B.call(t,X),n=t[X];try{t[X]=void 0;var r=!0}catch(t){}var i=U.call(t);r&&(e?t[X]=n:delete t[X]);return i}(t):function(t){return U.call(t)}(t)}function gt(t){return Ft(t)&&vt(t)==u}function mt(t){return!(!It(t)||L&&L in t)&&(Mt(t)?z:g).test(function(t){if(null!=t){try{return D.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function bt(t){if(!It(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=Et(t),n=[];for(var r in t)("constructor"!=r||!e&&B.call(t,r))&&n.push(r);return n}function _t(t,e,n,r,i){t!==e&&yt(e,function(o,s){if(It(o))i||(i=new ct),function(t,e,n,r,i,o,s){var a=P(t,n),c=P(e,n),u=s.get(c);if(u)return void ft(t,n,u);var f=o?o(a,c,n+"",t,e,s):void 0,l=void 0===f;if(l){var h=Pt(c),p=!h&&Tt(c),y=!h&&!p&&Nt(c);f=c,h||p||y?Pt(a)?f=a:Ft(_=a)&&jt(_)?f=function(t,e){var n=-1,r=t.length;e||(e=Array(r));for(;++n<r;)e[n]=t[n];return e}(a):p?(l=!1,f=function(t,e){if(e)return t.slice();var n=t.length,r=H?H(n):new t.constructor(n);return t.copy(r),r}(c,!0)):y?(l=!1,v=c,g=!0?(m=v.buffer,b=new m.constructor(m.byteLength),new J(b).set(new J(m)),b):v.buffer,f=new v.constructor(g,v.byteOffset,v.length)):f=[]:function(t){if(!Ft(t)||vt(t)!=d)return!1;var e=$(t);if(null===e)return!0;var n=B.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&D.call(n)==q}(c)||At(c)?(f=a,At(a)?f=function(t){return function(t,e,n,r){var i=!n;n||(n={});var o=-1,s=e.length;for(;++o<s;){var a=e[o],c=r?r(n[a],t[a],a,n,t):void 0;void 0===c&&(c=t[a]),i?pt(n,a,c):lt(n,a,c)}return n}(t,Dt(t))}(a):(!It(a)||r&&Mt(a))&&(f=function(t){return"function"!=typeof t.constructor||Et(t)?{}:it($(t))}(c))):l=!1}var v,g,m,b;var _;l&&(s.set(c,f),i(f,c,r,o,s),s.delete(c));ft(t,n,f)}(t,e,s,n,_t,r,i);else{var a=r?r(P(t,s),o,s+"",t,e,i):void 0;void 0===a&&(a=o),ft(t,s,a)}},Dt)}function wt(t,e){return xt(function(t,e,n){return e=tt(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=tt(r.length-e,0),s=Array(o);++i<o;)s[i]=r[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=r[i];return a[e]=n(s),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,a)}}(t,e,Ut),t+"")}function Ct(t,e){var n,i,o=t.__data__;return("string"==(i=void 0===(n=e)?"undefined":r(n))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function kt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return mt(n)?n:void 0}function St(t,e){var n=void 0===t?"undefined":r(t);return!!(e=null==e?c:e)&&("number"==n||"symbol"!=n&&m.test(t))&&t>-1&&t%1==0&&t<e}function Et(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||F)}var xt=function(t){var e=0,n=0;return function(){var r=et(),i=a-(r-n);if(n=r,i>0){if(++e>=s)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Z?function(t,e){return Z(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:Ut);function Ot(t,e){return t===e||t!=t&&e!=e}var At=gt(function(){return arguments}())?gt:function(t){return Ft(t)&&B.call(t,"callee")&&!Y.call(t,"callee")},Pt=Array.isArray;function jt(t){return null!=t&&Rt(t.length)&&!Mt(t)}var Tt=K||function(){return!1};function Mt(t){if(!It(t))return!1;var e=vt(t);return e==l||e==h||e==f||e==y}function Rt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function It(t){var e=void 0===t?"undefined":r(t);return null!=t&&("object"==e||"function"==e)}function Ft(t){return null!=t&&"object"==(void 0===t?"undefined":r(t))}var Nt=A?function(t){return function(e){return t(e)}}(A):function(t){return Ft(t)&&Rt(t.length)&&!!b[vt(t)]};function Dt(t){return jt(t)?ut(t,!0):bt(t)}var Bt,Lt=(Bt=function(t,e,n){_t(t,e,n)},wt(function(t,e){var n=-1,i=e.length,o=i>1?e[i-1]:void 0,s=i>2?e[2]:void 0;for(o=Bt.length>3&&"function"==typeof o?(i--,o):void 0,s&&function(t,e,n){if(!It(n))return!1;var i=void 0===e?"undefined":r(e);return!!("number"==i?jt(n)&&St(e,n.length):"string"==i&&e in n)&&Ot(n[e],t)}(e[0],e[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var a=e[n];a&&Bt(t,a,n,o)}return t}));function Ut(t){return t}n.exports=Lt}).call(this,n(6),n(54)(t))},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function s(t){return"object"===(void 0===t?"undefined":r(t))&&null!==t}function a(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,r,i,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(a(n=this._events[t]))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),c=1;c<r;c++)i[c-1]=arguments[c];n.apply(this,i)}else if(s(n)){for(r=arguments.length,i=new Array(r-1),c=1;c<r;c++)i[c-1]=arguments[c];for(r=(u=n.slice()).length,c=0;c<r;c++)u[c].apply(this,i)}return!0},i.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned)&&((n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()));return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!o(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},i.prototype.removeListener=function(t,e){var n,r,i,a;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(n=this._events[t]).length,r=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=i;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(o(n=this._events[t]))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.listenerCount=function(t,e){return t._events&&t._events[e]?o(t._events[e])?1:t._events[e].length:0}},function(t,e,n){"use strict";(function(r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(313)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(15))},function(t,e,n){"use strict";t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){"use strict";var r,i,o=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var u,f=[],l=!1,h=-1;function p(){l&&u&&(l=!1,u.length?f=u.concat(f):h=-1,f.length&&d())}function d(){if(!l){var t=c(p);l=!0;for(var e=f.length;e;){for(u=f,f=[];++h<e;)u&&u[h].run();h=-1,e=f.length}u=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new y(t,e)),1!==f.length||l||c(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){"use strict";var r=n(0),i=n(3),o=n(31),s=/"/g,a=function(t,e,n,r){var i=String(o(t)),a="<"+e;return""!==n&&(a+=" "+n+'="'+String(r).replace(s,"&quot;")+'"'),a+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(a),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e,n){"use strict";var r=n(2),i=n(18),o=n(22),s=n(46)("src"),a=Function.toString,c=(""+a).split("toString");n(26).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,n,a){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(u&&(o(n,s)||i(n,s,t[e]?""+t[e]:c.join(String(e)))),t===r?t[e]=n:a?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(t,e,n){"use strict";var r=n(8),i=n(47);t.exports=n(9)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){"use strict";var r=n(22),i=n(10),o=n(117)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){"use strict";var r=n(63),i=n(47),o=n(21),s=n(32),a=n(22),c=n(188),u=Object.getOwnPropertyDescriptor;e.f=n(9)?u:function(t,e){if(t=o(t),e=s(e,!0),c)try{return u(t,e)}catch(t){}if(a(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){"use strict";var r=n(64),i=n(31);t.exports=function(t){return r(i(t))}},function(t,e,n){"use strict";var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){"use strict";var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e,n){"use strict";var r=n(14);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){"use strict";var r=t.exports={version:"2.5.6"};"number"==typeof __e&&(__e=r)},function(t,e,n){"use strict";var r=n(330),i=n(329);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[o+a]=s[a];return e||i(s)}},function(t,e,n){"use strict";var r=n(25),i=n(64),o=n(10),s=n(7),a=n(100);t.exports=function(t,e){var n=1==t,c=2==t,u=3==t,f=4==t,l=6==t,h=5==t||l,p=e||a;return function(e,a,d){for(var y,v,g=o(e),m=i(g),b=r(a,d,3),_=s(m.length),w=0,C=n?p(e,_):c?p(e,0):void 0;_>w;w++)if((h||w in m)&&(v=b(y=m[w],w,g),t))if(n)C[w]=v;else if(v)switch(t){case 3:return!0;case 5:return y;case 6:return w;case 2:C.push(y)}else if(f)return!1;return l?-1:u||f?f:C}}},function(t,e,n){"use strict";var r=n(0),i=n(26),o=n(3);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],s={};s[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",s)}},function(t,e,n){"use strict";var r=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:r)(t)}},function(t,e,n){"use strict";t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){"use strict";var r=n(4);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(167),o=n(0),s=n(84)("metadata"),a=s.store||(s.store=new(n(164))),c=function(t,e,n){var r=a.get(t);if(!r){if(!n)return;a.set(t,r=new i)}var o=r.get(e);if(!o){if(!n)return;r.set(e,o=new i)}return o};t.exports={store:a,map:c,has:function(t,e,n){var r=c(e,n,!1);return void 0!==r&&r.has(t)},get:function(t,e,n){var r=c(e,n,!1);return void 0===r?void 0:r.get(t)},set:function(t,e,n,r){c(n,r,!0).set(t,e)},keys:function(t,e){var n=c(t,e,!1),r=[];return n&&n.forEach(function(t,e){r.push(e)}),r},key:function(t){return void 0===t||"symbol"==(void 0===t?"undefined":r(t))?t:String(t)},exp:function(t){o(o.S,"Reflect",t)}}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};if(n(9)){var i=n(36),o=n(2),s=n(3),a=n(0),c=n(73),u=n(94),f=n(25),l=n(40),h=n(47),p=n(18),d=n(38),y=n(30),v=n(7),g=n(162),m=n(44),b=n(32),_=n(22),w=n(62),C=n(4),k=n(10),S=n(103),E=n(43),x=n(19),O=n(42).f,A=n(101),P=n(46),j=n(5),T=n(28),M=n(83),R=n(76),I=n(98),F=n(56),N=n(79),D=n(41),B=n(99),L=n(172),U=n(8),q=n(20),z=U.f,V=q.f,W=o.RangeError,J=o.TypeError,H=o.Uint8Array,$=Array.prototype,G=u.ArrayBuffer,Y=u.DataView,Q=T(0),X=T(2),Z=T(3),K=T(4),tt=T(5),et=T(6),nt=M(!0),rt=M(!1),it=I.values,ot=I.keys,st=I.entries,at=$.lastIndexOf,ct=$.reduce,ut=$.reduceRight,ft=$.join,lt=$.sort,ht=$.slice,pt=$.toString,dt=$.toLocaleString,yt=j("iterator"),vt=j("toStringTag"),gt=P("typed_constructor"),mt=P("def_constructor"),bt=c.CONSTR,_t=c.TYPED,wt=c.VIEW,Ct=T(1,function(t,e){return Ot(R(t,t[mt]),e)}),kt=s(function(){return 1===new H(new Uint16Array([1]).buffer)[0]}),St=!!H&&!!H.prototype.set&&s(function(){new H(1).set({})}),Et=function(t,e){var n=y(t);if(n<0||n%e)throw W("Wrong offset!");return n},xt=function(t){if(C(t)&&_t in t)return t;throw J(t+" is not a typed array!")},Ot=function(t,e){if(!(C(t)&&gt in t))throw J("It is not a typed array constructor!");return new t(e)},At=function(t,e){return Pt(R(t,t[mt]),e)},Pt=function(t,e){for(var n=0,r=e.length,i=Ot(t,r);r>n;)i[n]=e[n++];return i},jt=function(t,e,n){z(t,e,{get:function(){return this._d[n]}})},Tt=function(t){var e,n,r,i,o,s,a=k(t),c=arguments.length,u=c>1?arguments[1]:void 0,l=void 0!==u,h=A(a);if(void 0!=h&&!S(h)){for(s=h.call(a),r=[],e=0;!(o=s.next()).done;e++)r.push(o.value);a=r}for(l&&c>2&&(u=f(u,arguments[2],2)),e=0,n=v(a.length),i=Ot(this,n);n>e;e++)i[e]=l?u(a[e],e):a[e];return i},Mt=function(){for(var t=0,e=arguments.length,n=Ot(this,e);e>t;)n[t]=arguments[t++];return n},Rt=!!H&&s(function(){dt.call(new H(1))}),It=function(){return dt.apply(Rt?ht.call(xt(this)):xt(this),arguments)},Ft={copyWithin:function(t,e){return L.call(xt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return K(xt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return B.apply(xt(this),arguments)},filter:function(t){return At(this,X(xt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return tt(xt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return et(xt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Q(xt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return rt(xt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return nt(xt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ft.apply(xt(this),arguments)},lastIndexOf:function(t){return at.apply(xt(this),arguments)},map:function(t){return Ct(xt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ct.apply(xt(this),arguments)},reduceRight:function(t){return ut.apply(xt(this),arguments)},reverse:function(){for(var t,e=xt(this).length,n=Math.floor(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this},some:function(t){return Z(xt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return lt.call(xt(this),t)},subarray:function(t,e){var n=xt(this),r=n.length,i=m(t,r);return new(R(n,n[mt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===e?r:m(e,r))-i))}},Nt=function(t,e){return At(this,ht.call(xt(this),t,e))},Dt=function(t){xt(this);var e=Et(arguments[1],1),n=this.length,r=k(t),i=v(r.length),o=0;if(i+e>n)throw W("Wrong length!");for(;o<i;)this[e+o]=r[o++]},Bt={entries:function(){return st.call(xt(this))},keys:function(){return ot.call(xt(this))},values:function(){return it.call(xt(this))}},Lt=function(t,e){return C(t)&&t[_t]&&"symbol"!=(void 0===e?"undefined":r(e))&&e in t&&String(+e)==String(e)},Ut=function(t,e){return Lt(t,e=b(e,!0))?h(2,t[e]):V(t,e)},qt=function(t,e,n){return!(Lt(t,e=b(e,!0))&&C(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?z(t,e,n):(t[e]=n.value,t)};bt||(q.f=Ut,U.f=qt),a(a.S+a.F*!bt,"Object",{getOwnPropertyDescriptor:Ut,defineProperty:qt}),s(function(){pt.call({})})&&(pt=dt=function(){return ft.call(this)});var zt=d({},Ft);d(zt,Bt),p(zt,yt,Bt.values),d(zt,{slice:Nt,set:Dt,constructor:function(){},toString:pt,toLocaleString:It}),jt(zt,"buffer","b"),jt(zt,"byteOffset","o"),jt(zt,"byteLength","l"),jt(zt,"length","e"),z(zt,vt,{get:function(){return this[_t]}}),t.exports=function(t,e,n,r){var u=t+((r=!!r)?"Clamped":"")+"Array",f="get"+t,h="set"+t,d=o[u],y=d||{},m=d&&x(d),b=!d||!c.ABV,_={},k=d&&d.prototype,S=function(t,n){z(t,n,{get:function(){return function(t,n){var r=t._d;return r.v[f](n*e+r.o,kt)}(this,n)},set:function(t){return function(t,n,i){var o=t._d;r&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[h](n*e+o.o,i,kt)}(this,n,t)},enumerable:!0})};b?(d=n(function(t,n,r,i){l(t,d,u,"_d");var o,s,a,c,f=0,h=0;if(C(n)){if(!(n instanceof G||"ArrayBuffer"==(c=w(n))||"SharedArrayBuffer"==c))return _t in n?Pt(d,n):Tt.call(d,n);o=n,h=Et(r,e);var y=n.byteLength;if(void 0===i){if(y%e)throw W("Wrong length!");if((s=y-h)<0)throw W("Wrong length!")}else if((s=v(i)*e)+h>y)throw W("Wrong length!");a=s/e}else a=g(n),o=new G(s=a*e);for(p(t,"_d",{b:o,o:h,l:s,e:a,v:new Y(o)});f<a;)S(t,f++)}),k=d.prototype=E(zt),p(k,"constructor",d)):s(function(){d(1)})&&s(function(){new d(-1)})&&N(function(t){new d,new d(null),new d(1.5),new d(t)},!0)||(d=n(function(t,n,r,i){var o;return l(t,d,u),C(n)?n instanceof G||"ArrayBuffer"==(o=w(n))||"SharedArrayBuffer"==o?void 0!==i?new y(n,Et(r,e),i):void 0!==r?new y(n,Et(r,e)):new y(n):_t in n?Pt(d,n):Tt.call(d,n):new y(g(n))}),Q(m!==Function.prototype?O(y).concat(O(m)):O(y),function(t){t in d||p(d,t,y[t])}),d.prototype=k,i||(k.constructor=d));var A=k[yt],P=!!A&&("values"==A.name||void 0==A.name),j=Bt.values;p(d,gt,!0),p(k,_t,u),p(k,wt,!0),p(k,mt,d),(r?new d(1)[vt]==u:vt in k)||z(k,vt,{get:function(){return u}}),_[u]=d,a(a.G+a.W+a.F*(d!=y),_),a(a.S,u,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*s(function(){y.of.call(d,1)}),u,{from:Tt,of:Mt}),"BYTES_PER_ELEMENT"in k||p(k,"BYTES_PER_ELEMENT",e),a(a.P,u,Ft),D(u),a(a.P+a.F*St,u,{set:Dt}),a(a.P+a.F*!P,u,Bt),i||k.toString==pt||(k.toString=pt),a(a.P+a.F*s(function(){new d(1).slice()}),u,{slice:Nt}),a(a.P+a.F*(s(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!s(function(){k.toLocaleString.call([1,2])})),u,{toLocaleString:It}),F[u]=P?A:j,i||P||p(k,yt,j)}}else t.exports=function(){}},function(t,e,n){"use strict";var r=n(5)("unscopables"),i=Array.prototype;void 0==i[r]&&n(18)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e,n){"use strict";t.exports=!1},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(46)("meta"),o=n(4),s=n(22),a=n(8).f,c=0,u=Object.isExtensible||function(){return!0},f=!n(3)(function(){return u(Object.preventExtensions({}))}),l=function(t){a(t,i,{value:{i:"O"+ ++c,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==(void 0===t?"undefined":r(t))?t:("string"==typeof t?"S":"P")+t;if(!s(t,i)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[i].i},getWeak:function(t,e){if(!s(t,i)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[i].w},onFreeze:function(t){return f&&h.NEED&&u(t)&&!s(t,i)&&l(t),t}}},function(t,e,n){"use strict";var r=n(17);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){"use strict";var r=n(25),i=n(174),o=n(103),s=n(1),a=n(7),c=n(101),u={},f={},l=t.exports=function(t,e,n,l,h){var p,d,y,v,g=h?function(){return t}:c(t),m=r(n,l,e?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(p=a(t.length);p>b;b++)if((v=e?m(s(d=t[b])[0],d[1]):m(t[b]))===u||v===f)return v}else for(y=g.call(t);!(d=y.next()).done;)if((v=i(y,m,d.value,e))===u||v===f)return v};l.BREAK=u,l.RETURN=f},function(t,e,n){"use strict";t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){"use strict";var r=n(2),i=n(8),o=n(9),s=n(5)("species");t.exports=function(t){var e=r[t];o&&e&&!e[s]&&i.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){"use strict";var r=n(186),i=n(116).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){"use strict";var r=n(1),i=n(185),o=n(116),s=n(117)("IE_PROTO"),a=function(){},c=function(){var t,e=n(119)("iframe"),r=o.length;for(e.style.display="none",n(115).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;r--;)delete c.prototype[o[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=r(t),n=new a,a.prototype=null,n[s]=t):n=c(),void 0===e?n:i(n,e)}},function(t,e,n){"use strict";var r=n(30),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){"use strict";var r=n(186),i=n(116);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){"use strict";var r=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+i).toString(36))}},function(t,e,n){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){"use strict";(function(e){var n=Object.assign?Object.assign:function(t,e,n,r){for(var i=1;i<arguments.length;i++)a(Object(arguments[i]),function(e,n){t[n]=e});return t},r=function(){if(Object.create)return function(t,e,r,i){var o=s(arguments,1);return n.apply(this,[Object.create(t)].concat(o))};var t=function(){};return function(e,r,i,o){var a=s(arguments,1);return t.prototype=e,n.apply(this,[new t].concat(a))}}(),i=String.prototype.trim?function(t){return String.prototype.trim.call(t)}:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},o="undefined"!=typeof window?window:e;function s(t,e){return Array.prototype.slice.call(t,e||0)}function a(t,e){c(t,function(t,n){return e(t,n),!1})}function c(t,e){if(u(t)){for(var n=0;n<t.length;n++)if(e(t[n],n))return t[n]}else for(var r in t)if(t.hasOwnProperty(r)&&e(t[r],r))return t[r]}function u(t){return null!=t&&"function"!=typeof t&&"number"==typeof t.length}t.exports={assign:n,create:r,trim:i,bind:function(t,e){return function(){return e.apply(t,Array.prototype.slice.call(arguments,0))}},slice:s,each:a,map:function(t,e){var n=u(t)?[]:{};return c(t,function(t,r){return n[r]=e(t,r),!1}),n},pluck:c,isList:u,isFunction:function(t){return t&&"[object Function]"==={}.toString.call(t)},isObject:function(t){return t&&"[object Object]"==={}.toString.call(t)},Global:o}}).call(this,n(6))},function(t,e,n){"use strict";(function(t){var r,i=n(292),o=n(134),s=n(290),a=n(289),c=n(288);t&&t.ArrayBuffer&&(r=n(287));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),f="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=u||f;e.protocol=3;var h=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},p=i(h),d={type:"error",data:"parser error"},y=n(286);function v(t,e,n){for(var r=new Array(t.length),i=a(t.length,n),o=function(t,n,i){e(n,function(e,n){r[t]=n,i(e,r)})},s=0;s<t.length;s++)o(s,t[s],i)}e.encodePacket=function(n,r,i,o){"function"==typeof r&&(o=r,r=!1),"function"==typeof i&&(o=i,i=null);var s=void 0===n.data?void 0:n.data.buffer||n.data;if(t.ArrayBuffer&&s instanceof ArrayBuffer)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var i=t.data,o=new Uint8Array(i),s=new Uint8Array(1+i.byteLength);s[0]=h[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return r(s.buffer)}(n,r,o);if(y&&s instanceof t.Blob)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);if(l)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var i=new FileReader;return i.onload=function(){t.data=i.result,e.encodePacket(t,n,!0,r)},i.readAsArrayBuffer(t.data)}(t,n,r);var i=new Uint8Array(1);i[0]=h[t.type];var o=new y([i.buffer,t.data]);return r(o)}(n,r,o);if(s&&s.base64)return function(t,n){var r="b"+e.packets[t.type]+t.data.data;return n(r)}(n,o);var a=h[n.type];return void 0!==n.data&&(a+=i?c.encode(String(n.data),{strict:!1}):String(n.data)),o(""+a)},e.encodeBase64Packet=function(n,r){var i,o="b"+e.packets[n.type];if(y&&n.data instanceof t.Blob){var s=new FileReader;return s.onload=function(){var t=s.result.split(",")[1];r(o+t)},s.readAsDataURL(n.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(t){for(var a=new Uint8Array(n.data),c=new Array(a.length),u=0;u<a.length;u++)c[u]=a[u];i=String.fromCharCode.apply(null,c)}return o+=t.btoa(i),r(o)},e.decodePacket=function(t,n,r){if(void 0===t)return d;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),n);if(r&&!1===(t=function(t){try{t=c.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return d;var i=t.charAt(0);return Number(i)==i&&p[i]?t.length>1?{type:p[i],data:t.substring(1)}:{type:p[i]}:d}i=new Uint8Array(t)[0];var o=s(t,1);return y&&"blob"===n&&(o=new y([o])),{type:p[i],data:o}},e.decodeBase64Packet=function(t,e){var n=p[t.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:t.substr(1)}};var i=r.decode(t.substr(1));return"blob"===e&&y&&(i=new y([i])),{type:n,data:i}},e.encodePayload=function(t,n,r){"function"==typeof n&&(r=n,n=null);var i=o(t);if(n&&i)return y&&!l?e.encodePayloadAsBlob(t,r):e.encodePayloadAsArrayBuffer(t,r);if(!t.length)return r("0:");v(t,function(t,r){e.encodePacket(t,!!i&&n,!1,function(t){r(null,function(t){return t.length+":"+t}(t))})},function(t,e){return r(e.join(""))})},e.decodePayload=function(t,n,r){if("string"!=typeof t)return e.decodePayloadAsBinary(t,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===t)return r(d,0,1);for(var o,s,a="",c=0,u=t.length;c<u;c++){var f=t.charAt(c);if(":"===f){if(""===a||a!=(o=Number(a)))return r(d,0,1);if(a!=(s=t.substr(c+1,o)).length)return r(d,0,1);if(s.length){if(i=e.decodePacket(s,n,!1),d.type===i.type&&d.data===i.data)return r(d,0,1);if(!1===r(i,c+o,u))return}c+=o,a=""}else a+=f}return""!==a?r(d,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,n){if(!t.length)return n(new ArrayBuffer(0));v(t,function(t,n){e.encodePacket(t,!0,!0,function(t){return n(null,t)})},function(t,e){var r=e.reduce(function(t,e){var n;return t+(n="string"==typeof e?e.length:e.byteLength).toString().length+n+2},0),i=new Uint8Array(r),o=0;return e.forEach(function(t){var e="string"==typeof t,n=t;if(e){for(var r=new Uint8Array(t.length),s=0;s<t.length;s++)r[s]=t.charCodeAt(s);n=r.buffer}i[o++]=e?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)i[o++]=parseInt(a[s]);i[o++]=255;for(r=new Uint8Array(n),s=0;s<r.length;s++)i[o++]=r[s]}),n(i.buffer)})},e.encodePayloadAsBlob=function(t,n){v(t,function(t,n){e.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);t=r.buffer,e[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,y){var a=new y([e.buffer,s.buffer,t]);n(null,a)}})},function(t,e){return n(new y(e))})},e.decodePayloadAsBinary=function(t,n,r){"function"==typeof n&&(r=n,n=null);for(var i=t,o=[];i.byteLength>0;){for(var a=new Uint8Array(i),c=0===a[0],u="",f=1;255!==a[f];f++){if(u.length>310)return r(d,0,1);u+=a[f]}i=s(i,2+u.length),u=parseInt(u);var l=s(i,0,u);if(c)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(t){var h=new Uint8Array(l);l="";for(f=0;f<h.length;f++)l+=String.fromCharCode(h[f])}o.push(l),i=s(i,u)}var p=o.length;o.forEach(function(t,i){r(e.decodePacket(t,n,!0),i,p)})}}).call(this,n(6))},function(t,e,n){"use strict";function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,n){"use strict";var r=n(68),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=l;var o=n(60);o.inherits=n(52);var s=n(149),a=n(145);o.inherits(l,s);for(var c=i(a.prototype),u=0;u<c.length;u++){var f=c[u];l.prototype[f]||(l.prototype[f]=a.prototype[f])}function l(t){if(!(this instanceof l))return new l(t);s.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),l.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,n){"use strict";"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=1e3,o=60*i,s=60*o,a=24*s,c=365.25*a;function u(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var n,f=void 0===t?"undefined":r(t);if("string"===f&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*c;case"days":case"day":case"d":return n*a;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*o;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(t);if("number"===f&&!1===isNaN(t))return e.long?u(n=t,a,"day")||u(n,s,"hour")||u(n,o,"minute")||u(n,i,"second")||n+" ms":function(t){if(t>=a)return Math.round(t/a)+"d";if(t>=s)return Math.round(t/s)+"h";if(t>=o)return Math.round(t/o)+"m";if(t>=i)return Math.round(t/i)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";var r=n(4);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){"use strict";t.exports={}},function(t,e,n){"use strict";var r=n(0),i=n(31),o=n(3),s=n(113),a="["+s+"]",c=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),f=function(t,e,n){var i={},a=o(function(){return!!s[t]()||"​"!="​"[t]()}),c=i[t]=a?e(l):s[t];n&&(i[n]=c),r(r.P+r.F*a,"String",i)},l=f.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=f},function(t,e,n){"use strict";var r=n(8).f,i=n(22),o=n(5)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(12),o=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n._rps=n._buildRPS(t),n._options=t,n._id=n._rps.PEER,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"_buildRPS",value:function(t){throw new Error("A valid network must implement a _buildRPS method using options",t)}},{key:"getNeighbours",value:function(t){throw new Error("A valid network must implement a getNeighbours method with limit",t)}},{key:"id",get:function(){return this._id}},{key:"rps",get:function(){return this._rps}},{key:"inviewId",get:function(){throw new Error("A valid network must implement a inviewId getter")}},{key:"outviewId",get:function(){throw new Error("A valid network must implement a outviewId getter")}}]),e}();t.exports=o},function(t,e,n){"use strict";(function(t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===r(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"===(void 0===t?"undefined":n(t))},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===r(t)},e.isObject=function(t){return"object"===(void 0===t?"undefined":n(t))&&null!==t},e.isDate=function(t){return"[object Date]"===r(t)},e.isError=function(t){return"[object Error]"===r(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"===(void 0===t?"undefined":n(t))||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(67).Buffer)},function(t,e,n){"use strict";var r=n(67),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=s),o(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,n){"use strict";var r=n(24),i=n(5)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){"use strict";e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";var r=n(24);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){"use strict";t.exports=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(310),i=n(309),o=n(148);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(f(e),t=a(t,e<0?0:0|p(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function v(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,i);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,i){var o,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var f=-1;for(o=n;o<a;o++)if(u(t,o)===u(e,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===c)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var l=!0,h=0;h<c;h++)if(u(t,o+h)!==u(e,h)){l=!1;break}if(l)return o}return-1}function m(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function b(t,e,n,r){return z(U(e,t.length-n),t,n,r)}function _(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return _(t,e,n,r)}function C(t,e,n,r){return z(q(e),t,n,r)}function k(t,e,n,r){return z(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function E(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,c,u=t[i],f=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l<=n)switch(l){case 1:u<128&&(f=u);break;case 2:128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)>127&&(f=c);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(f=c)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),i+=l}return function(t){var e=t.length;if(e<=x)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=x));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return f(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return l(null,t)},c.allocUnsafeSlow=function(t){return l(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return O(this,e,n);case"latin1":case"binary":return A(this,e,n);case"base64":return S(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,i){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,s=n-e,a=Math.min(o,s),u=this.slice(r,i),f=t.slice(e,n),l=0;l<a;++l)if(u[l]!==f[l]){o=u[l],s=f[l];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return m(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function O(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function A(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function P(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=L(t[o]);return i}function j(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function T(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function R(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function I(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function F(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(t,e,n,r,o){return o||F(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function D(t,e,n,r,o){return o||F(t,0,n,8),i.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var i=e-t;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},c.prototype.readUInt8=function(t,e){return e||T(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||T(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||T(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return e||T(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||T(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||T(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||T(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||T(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||T(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||T(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):I(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):I(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return N(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return N(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return D(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return D(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=c.isBuffer(t)?t:U(new c(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function L(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function q(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(6))},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return e.nextTick(function(){t.apply(null,o)})}}}:t.exports=e}).call(this,n(15))},function(t,e,n){"use strict";var r,i,o,s=n(337),a="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function c(){o=!1}function u(t){if(t){if(t!==r){if(t.length!==a.length)throw new Error("Custom alphabet for shortid must be "+a.length+" unique characters. You submitted "+t.length+" characters: "+t);var e=t.split("").filter(function(t,e,n){return e!==n.lastIndexOf(t)});if(e.length)throw new Error("Custom alphabet for shortid must be "+a.length+" unique characters. These characters were not unique: "+e.join(", "));r=t,c()}}else r!==a&&(r=a,c())}function f(){return o||(o=function(){r||u(a);for(var t,e=r.split(""),n=[],i=s.nextValue();e.length>0;)i=s.nextValue(),t=Math.floor(i*e.length),n.push(e.splice(t,1)[0]);return n.join("")}())}t.exports={characters:function(t){return u(t),r},seed:function(t){s.seed(t),i!==t&&(c(),i=t)},lookup:function(t){return f()[t]},shuffled:f}},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(25),s=n(39);t.exports=function(t){r(r.S,t,{from:function(t){var e,n,r,a,c=arguments[1];return i(this),(e=void 0!==c)&&i(c),void 0==t?new this:(n=[],e?(r=0,a=o(c,arguments[2],2),s(t,!1,function(t){n.push(a(t,r++))})):s(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){r(r.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";t.exports=n(36)||!n(3)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(2)[t]})},function(t,e,n){"use strict";for(var r,i=n(2),o=n(18),s=n(46),a=s("typed_array"),c=s("view"),u=!(!i.ArrayBuffer||!i.DataView),f=u,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(r=i[h[l++]])?(o(r.prototype,a,!0),o(r.prototype,c,!0)):f=!1;t.exports={ABV:u,CONSTR:f,TYPED:a,VIEW:c}},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(17),s=n(38),a=n(37),c=n(39),u=n(40),f=n(4),l=n(3),h=n(79),p=n(58),d=n(112);t.exports=function(t,e,n,y,v,g){var m=r[t],b=m,_=v?"set":"add",w=b&&b.prototype,C={},k=function(t){var e=w[t];o(w,t,"delete"==t?function(t){return!(g&&!f(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!f(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!f(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof b&&(g||w.forEach&&!l(function(){(new b).entries().next()}))){var S=new b,E=S[_](g?{}:-0,1)!=S,x=l(function(){S.has(1)}),O=h(function(t){new b(t)}),A=!g&&l(function(){for(var t=new b,e=5;e--;)t[_](e,e);return!t.has(-0)});O||((b=e(function(e,n){u(e,b,t);var r=d(new m,e,b);return void 0!=n&&c(n,v,r[_],r),r})).prototype=w,w.constructor=b),(x||A)&&(k("delete"),k("has"),v&&k("get")),(A||E)&&k(_),g&&w.clear&&delete w.clear}else b=y.getConstructor(e,t,v,_),s(b.prototype,n),a.NEED=!0;return p(b,t),C[t]=b,i(i.G+i.W+i.F*(b!=m),C),g||y.setStrong(b,t,v),b}},function(t,e,n){"use strict";var r=n(2).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";var r=n(1),i=n(14),o=n(5)("species");t.exports=function(t,e){var n,s=r(t).constructor;return void 0===s||void 0==(n=r(s)[o])?e:i(n)}},function(t,e,n){"use strict";var r=n(18),i=n(17),o=n(3),s=n(31),a=n(5);t.exports=function(t,e,n){var c=a(t),u=n(s,c,""[t]),f=u[0],l=u[1];o(function(){var e={};return e[c]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,f),r(RegExp.prototype,c,2==e?function(t,e){return l.call(t,this,e)}:function(t){return l.call(t,this)}))}},function(t,e,n){"use strict";var r=n(1);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(5)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},t(o)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(4),i=n(24),o=n(5)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){"use strict";var r=n(24);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){"use strict";e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";var r=n(21),i=n(7),o=n(44);t.exports=function(t){return function(e,n,s){var a,c=r(e),u=i(c.length),f=o(s,u);if(t&&n!=n){for(;u>f;)if((a=c[f++])!=a)return!0}else for(;u>f;f++)if((t||f in c)&&c[f]===n)return t||f||0;return!t&&-1}}},function(t,e,n){"use strict";var r=n(26),i=n(2),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(36)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.p=e,this.s=n,this.c=r}return r(t,[{key:"compareTo",value:function(t){return this.s===Number.MAX_VALUE&&this.c===Number.MAX_VALUE?1:t.s===Number.MAX_VALUE&&t.s===Number.MAX_VALUE?-1:this.p<t.p?-1:this.p>t.p?1:this.s<t.s?-1:this.s>t.s?1:this.c<t.c?-1:this.c>t.c?1:0}}]),t}();t.exports=i},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=n(277)("n2n-overlay-wrtc"),s=n(275),a=n(12),c=n(11),u=n(27),f=n(259),l=n(258),h=n(257),p=n(256),d=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.options=c({pid:u(),peer:u(),retry:5},t),n.PID=n.options.pid,n.NI=n.options.inview||new s(c(c({},n.options),{peer:n.options.peer+"-I"})),n.NO=n.options.outview||new s(c(c({},n.options),{peer:n.options.peer+"-O"})),n.II=n.NI.register(n),n.IO=n.NO.register(n),n.PEER=n.II.peer+"|"+n.IO.peer,o("[%s] registered to ==> %s ==>",n.PID,n.PEER),n.i=new Map,n.o=new Map,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),i(e,[{key:"_pid",value:function(){return this.PID}},{key:"_received",value:function(t,e){e.type?"MConnectTo"===e.type||"MForwarded"===e.type||"MForwardTo"===e.type?this._bridge(t,e):"MResponse"===e.type||"MRequest"===e.type||"MDirect"===e.type?this._direct(t,e):this.emit("receive",t,e):this.emit("receive",t,e)}},{key:"_streamed",value:function(t,e){this.emit("stream",t,e)}},{key:"_connected",value:function(t,e){e?(this.o.has(t)||this.o.set(t,0),this.o.set(t,this.o.get(t)+1),this.emit("open",t)):(this.i.has(t)||this.i.set(t,0),this.i.set(t,this.i.get(t)+1))}},{key:"_disconnected",value:function(t){this.o.has(t)?(this.o.set(t,this.o.get(t)-1),this.o.get(t)<=0&&this.o.delete(t),this.emit("close",t)):this.i.has(t)&&(this.i.set(t,this.i.get(t)-1),this.i.get(t)<=0&&this.i.delete(t))}},{key:"_failed",value:function(t,e){e&&this.emit("fail",t)}},{key:"_bridge",value:function(t,e){var n=this;e.type&&"MConnectTo"===e.type?this.IO.connect(function(r){n.send(t,new f(e.from,e.to,r),n.options.retry).catch(function(t){})}):e.type&&"MForwardTo"===e.type?this.send(e.to,new l(e.from,e.to,e.message),this.options.retry).catch(function(t){}):e.type&&"MForwarded"===e.type&&"MRequest"===e.message.type?this.II.connect(function(r){n.send(t,new f(e.to,e.from,r),n.options.retry).catch(function(t){})},e.message):e.type&&"MForwarded"===e.type&&"MResponse"===e.message.type&&this.IO.connect(e.message)}},{key:"_direct",value:function(t,e){var n=this;"MDirect"===e.type&&this.IO.connect(function(e){n.send(t,e,n.options.retry).catch(function(t){})}),"MRequest"===e.type&&this.II.connect(function(e){n.send(t,e,n.options.retry).catch(function(t){})},e),"MResponse"===e.type&&this.IO.connect(e)}},{key:"send",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=void 0;if(this.i.has(t))i=this.II.send(t,e,r);else if(this.o.has(t))i=this.IO.send(t,e,r);else{var o=t.substr(0,t.length-2),s=o+"-I",a=o+"-O";i=this.o.has(s)?this.IO.send(s,e,r):this.i.has(a)?this.II.send(a,e,r):new Promise(function(i,o){!function s(a){n.IO.send(t,e,0).then(function(){return i()}).catch(function(c){return n.II.send(t,e,0).then(function(){return i()}).catch(function(t){a<r?setTimeout(function(){s(a+1)},1e3):o(t)})})}(0)})}return i}},{key:"connect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;"function"==typeof t&&null===e?this.IO.connect(function(e){return t(e)}):"function"==typeof t&&null!==e?(o("[%s] %s <π= ??? =π= %s",this.PID,this.getInviewId(),e.peer),this.II.connect(function(e){return t(e)},e)):null!==t&&"object"===(void 0===t?"undefined":r(t))&&null===e?this.IO.connect(t):(null===t||t!==this.IO.peer&&t!==this.II.peer||(t=null),null===e||e!==this.IO.peer&&e!==this.II.peer||(e=null),null!==t&&null!==e?(o("[%s] %s =π= %s =π> %s",this.PID,t,this.PEER,e),this.send(t,new h(t,e),this.options.retry).catch(function(t){})):null!==t?this.send(t,new p,this.options.retry).catch(function(t){}):null!==e&&this._direct(e,new p))}},{key:"disconnect",value:function(t){void 0===t?(this.II.disconnect(),this.IO.disconnect()):(this.i.has(t)&&this.II.disconnect(t),this.o.has(t)&&this.IO.disconnect(t))}},{key:"getInview",value:function(){return new Map(this.i)}},{key:"getInviewId",value:function(){return this.NI.PEER}},{key:"getOutview",value:function(){return new Map(this.o)}},{key:"getOutviewId",value:function(){return this.NO.PEER}}]),e}();t.exports=d},function(t,e,n){"use strict";var r=n(49),i=n(50);function o(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=o,i(o.prototype),o.prototype.onError=function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},o.prototype.onPacket=function(t){this.emit("packet",t)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,n){"use strict";(function(e){var r=n(294);t.exports=function(t){var n=t.xdomain,i=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!i&&o)return new XDomainRequest}catch(t){}if(!n)try{return new(e[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(this,n(6))},function(t,e,n){"use strict";var r=n(13)("socket.io-parser"),i=n(50),o=n(297),s=n(139),a=n(138);function c(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=c,e.Decoder=l;var u=e.ERROR+'"encode error"';function f(t){var n=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data){var i=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===i)return u;n+=i}return r("encoded %j as %s",t,n),n}function l(){this.reconstructor=null}function h(t){this.reconPack=t,this.buffers=[]}function p(t){return{type:e.ERROR,data:"parser error: "+t}}c.prototype.encode=function(t,n){(r("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)?function(t,e){o.removeBlobs(t,function(t){var n=o.deconstructPacket(t),r=f(n.packet),i=n.buffers;i.unshift(r),e(i)})}(t,n):n([f(t)])},i(l.prototype),l.prototype.add=function(t){var n;if("string"==typeof t)n=function(t){var n=0,i={type:Number(t.charAt(0))};if(null==e.types[i.type])return p("unknown packet type "+i.type);if(e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type){for(var o="";"-"!==t.charAt(++n)&&(o+=t.charAt(n),n!=t.length););if(o!=Number(o)||"-"!==t.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(o)}if("/"===t.charAt(n+1))for(i.nsp="";++n;){var a=t.charAt(n);if(","===a)break;if(i.nsp+=a,n===t.length)break}else i.nsp="/";var c=t.charAt(n+1);if(""!==c&&Number(c)==c){for(i.id="";++n;){var a=t.charAt(n);if(null==a||Number(a)!=a){--n;break}if(i.id+=t.charAt(n),n===t.length)break}i.id=Number(i.id)}if(t.charAt(++n)){var u=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(n)),f=!1!==u&&(i.type===e.ERROR||s(u));if(!f)return p("invalid payload");i.data=u}return r("decoded %s as %j",t,i),i}(t),e.BINARY_EVENT===n.type||e.BINARY_ACK===n.type?(this.reconstructor=new h(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",n))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,n){"use strict";(e=t.exports=n(149)).Stream=e,e.Readable=e,e.Writable=n(145),e.Duplex=n(51),e.Transform=n(143),e.PassThrough=n(302)},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(12),o=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r._source=t,r._protocol=n,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"send",value:function(t){throw new Error("A valid communication protocol should implement a send method, message:"+t.toString())}},{key:"_receive",value:function(t,e){throw new Error("A valid communication protocol should implement a _receiveMessage method; (id, message)=("+t.toString()+","+e.toString()+")")}}]),e}();t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(326),o=n(325),s=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r._unicast=new o(r._source.rps,{pid:r._protocol}),r._unicast.on(r._protocol,function(t,e){r._receive(t,e)}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"send",value:function(t,e){return this._unicast.emit(this._protocol,t,this._source.outviewId,e)}},{key:"sendMultiple",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1];return e.reduce(function(e,r){return e.then(function(){return t.send(r,n)})},Promise.resolve())}},{key:"_receive",value:function(t,e){this.emit("receive",t,e)}}]),e}();t.exports=s},function(t,e,n){"use strict";var r=n(331),i=n(152),o=n(244),s=n(142),a=n(127),c=n(125),u=n(59),f=n(237),l=n(236),h=n(214);t.exports={Foglet:r,protocol:o,Signaling:s,SimplePeerMoc:h,networks:{Spray:a,Cyclon:c},communication:i,abstract:{rps:u,overlay:f,tman:l}}},function(t,e,n){"use strict";var r=n(2),i=n(9),o=n(36),s=n(73),a=n(18),c=n(38),u=n(3),f=n(40),l=n(30),h=n(7),p=n(162),d=n(42).f,y=n(8).f,v=n(99),g=n(58),m="prototype",b="Wrong index!",_=r.ArrayBuffer,w=r.DataView,C=r.Math,k=r.RangeError,S=r.Infinity,E=_,x=C.abs,O=C.pow,A=C.floor,P=C.log,j=C.LN2,T=i?"_b":"buffer",M=i?"_l":"byteLength",R=i?"_o":"byteOffset";function I(t,e,n){var r,i,o,s=new Array(n),a=8*n-e-1,c=(1<<a)-1,u=c>>1,f=23===e?O(2,-24)-O(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for((t=x(t))!=t||t===S?(i=t!=t?1:0,r=c):(r=A(P(t)/j),t*(o=O(2,-r))<1&&(r--,o*=2),(t+=r+u>=1?f/o:f*O(2,1-u))*o>=2&&(r++,o/=2),r+u>=c?(i=0,r=c):r+u>=1?(i=(t*o-1)*O(2,e),r+=u):(i=t*O(2,u-1)*O(2,e),r=0));e>=8;s[l++]=255&i,i/=256,e-=8);for(r=r<<e|i,a+=e;a>0;s[l++]=255&r,r/=256,a-=8);return s[--l]|=128*h,s}function F(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,s=o>>1,a=i-7,c=n-1,u=t[c--],f=127&u;for(u>>=7;a>0;f=256*f+t[c],c--,a-=8);for(r=f&(1<<-a)-1,f>>=-a,a+=e;a>0;r=256*r+t[c],c--,a-=8);if(0===f)f=1-s;else{if(f===o)return r?NaN:u?-S:S;r+=O(2,e),f-=s}return(u?-1:1)*r*O(2,f-e)}function N(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function D(t){return[255&t]}function B(t){return[255&t,t>>8&255]}function L(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function U(t){return I(t,52,8)}function q(t){return I(t,23,4)}function z(t,e,n){y(t[m],e,{get:function(){return this[n]}})}function V(t,e,n,r){var i=p(+n);if(i+e>t[M])throw k(b);var o=t[T]._b,s=i+t[R],a=o.slice(s,s+e);return r?a:a.reverse()}function W(t,e,n,r,i,o){var s=p(+n);if(s+e>t[M])throw k(b);for(var a=t[T]._b,c=s+t[R],u=r(+i),f=0;f<e;f++)a[c+f]=u[o?f:e-f-1]}if(s.ABV){if(!u(function(){_(1)})||!u(function(){new _(-1)})||u(function(){return new _,new _(1.5),new _(NaN),"ArrayBuffer"!=_.name})){for(var J,H=(_=function(t){return f(this,_),new E(p(t))})[m]=E[m],$=d(E),G=0;$.length>G;)(J=$[G++])in _||a(_,J,E[J]);o||(H.constructor=_)}var Y=new w(new _(2)),Q=w[m].setInt8;Y.setInt8(0,2147483648),Y.setInt8(1,2147483649),!Y.getInt8(0)&&Y.getInt8(1)||c(w[m],{setInt8:function(t,e){Q.call(this,t,e<<24>>24)},setUint8:function(t,e){Q.call(this,t,e<<24>>24)}},!0)}else _=function(t){f(this,_,"ArrayBuffer");var e=p(t);this._b=v.call(new Array(e),0),this[M]=e},w=function(t,e,n){f(this,w,"DataView"),f(t,_,"DataView");var r=t[M],i=l(e);if(i<0||i>r)throw k("Wrong offset!");if(i+(n=void 0===n?r-i:h(n))>r)throw k("Wrong length!");this[T]=t,this[R]=i,this[M]=n},i&&(z(_,"byteLength","_l"),z(w,"buffer","_b"),z(w,"byteLength","_l"),z(w,"byteOffset","_o")),c(w[m],{getInt8:function(t){return V(this,1,t)[0]<<24>>24},getUint8:function(t){return V(this,1,t)[0]},getInt16:function(t){var e=V(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=V(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return N(V(this,4,t,arguments[1]))},getUint32:function(t){return N(V(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return F(V(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return F(V(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){W(this,1,t,D,e)},setUint8:function(t,e){W(this,1,t,D,e)},setInt16:function(t,e){W(this,2,t,B,e,arguments[2])},setUint16:function(t,e){W(this,2,t,B,e,arguments[2])},setInt32:function(t,e){W(this,4,t,L,e,arguments[2])},setUint32:function(t,e){W(this,4,t,L,e,arguments[2])},setFloat32:function(t,e){W(this,4,t,q,e,arguments[2])},setFloat64:function(t,e){W(this,8,t,U,e,arguments[2])}});g(_,"ArrayBuffer"),g(w,"DataView"),a(w[m],s.VIEW,!0),e.ArrayBuffer=_,e.DataView=w},function(t,e,n){"use strict";var r=n(14);t.exports.f=function(t){return new function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}(t)}},function(t,e,n){"use strict";var r=n(2),i=n(97).set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,c="process"==n(24)(s);t.exports=function(){var t,e,n,u=function(){var r,i;for(c&&(r=s.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(c)n=function(){s.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var f=a.resolve(void 0);n=function(){f.then(u)}}else n=function(){i.call(r,u)};else{var l=!0,h=document.createTextNode("");new o(u).observe(h,{characterData:!0}),n=function(){h.data=l=!l}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e,n){"use strict";var r,i,o,s=n(25),a=n(181),c=n(115),u=n(119),f=n(2),l=f.process,h=f.setImmediate,p=f.clearImmediate,d=f.MessageChannel,y=f.Dispatch,v=0,g={},m=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},b=function(t){m.call(t.data)};h&&p||(h=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++v]=function(){a("function"==typeof t?t:Function(t),e)},r(v),v},p=function(t){delete g[t]},"process"==n(24)(l)?r=function(t){l.nextTick(s(m,t,1))}:y&&y.now?r=function(t){y.now(s(m,t,1))}:d?(o=(i=new d).port2,i.port1.onmessage=b,r=s(o.postMessage,o,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(r=function(t){f.postMessage(t+"","*")},f.addEventListener("message",b,!1)):r="onreadystatechange"in u("script")?function(t){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),m.call(t)}}:function(t){setTimeout(s(m,t,1),0)}),t.exports={set:h,clear:p}},function(t,e,n){"use strict";var r=n(35),i=n(171),o=n(56),s=n(21);t.exports=n(107)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){"use strict";var r=n(10),i=n(44),o=n(7);t.exports=function(t){for(var e=r(this),n=o(e.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,n),c=s>2?arguments[2]:void 0,u=void 0===c?n:i(c,n);u>a;)e[a++]=t;return e}},function(t,e,n){"use strict";var r=n(450);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){"use strict";var r=n(62),i=n(5)("iterator"),o=n(56);t.exports=n(26).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){"use strict";var r=n(8),i=n(47);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){"use strict";var r=n(56),i=n(5)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){"use strict";var r=n(5)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){"use strict";var r=n(80),i=n(31);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){"use strict";var r=n(43),i=n(47),o=n(58),s={};n(18)(s,n(5)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(s,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){"use strict";var r=n(36),i=n(0),o=n(17),s=n(18),a=n(56),c=n(106),u=n(58),f=n(19),l=n(5)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,d,y,v,g){c(n,e,d);var m,b,_,w=function(t){if(!h&&t in E)return E[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},C=e+" Iterator",k="values"==y,S=!1,E=t.prototype,x=E[l]||E["@@iterator"]||y&&E[y],O=x||w(y),A=y?k?w("entries"):O:void 0,P="Array"==e&&E.entries||x;if(P&&(_=f(P.call(new t)))!==Object.prototype&&_.next&&(u(_,C,!0),r||"function"==typeof _[l]||s(_,l,p)),k&&x&&"values"!==x.name&&(S=!0,O=function(){return x.call(this)}),r&&!g||!h&&!S&&E[l]||s(E,l,O),a[e]=O,a[C]=p,y)if(m={values:k?O:w("values"),keys:v?O:w("keys"),entries:A},g)for(b in m)b in E||o(E,b,m[b]);else i(i.P+i.F*(h||S),e,m);return m}},function(t,e,n){"use strict";var r=n(30),i=n(31);t.exports=function(t){return function(e,n){var o,s,a=String(i(e)),c=r(n),u=a.length;return c<0||c>=u?t?"":void 0:(o=a.charCodeAt(c))<55296||o>56319||c+1===u||(s=a.charCodeAt(c+1))<56320||s>57343?t?a.charAt(c):o:t?a.slice(c,c+2):s-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,e,n){"use strict";t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e,n){"use strict";var r=n(30),i=n(31);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e,n){"use strict";var r=n(4),i=n(114).set;t.exports=function(t,e,n){var o,s=e.constructor;return s!==n&&"function"==typeof s&&(o=s.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},function(t,e,n){"use strict";t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){"use strict";var r=n(4),i=n(1),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(25)(Function.call,n(20).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){"use strict";var r=n(2).document;t.exports=r&&r.documentElement},function(t,e,n){"use strict";t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){"use strict";var r=n(84)("keys"),i=n(46);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e,n){"use strict";var r=n(2),i=n(26),o=n(36),s=n(187),a=n(8).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,n){"use strict";var r=n(4),i=n(2).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(85),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.t=e.shift(),this.e=null,0===e.length&&(this.e=n),this.subCounter=e.length>0?1:0,this.children=[],e.length>0&&this.children.push(new t(e,n))}return r(t,[{key:"compareTo",value:function(t){return this.t.compareTo(t.t)}},{key:"add",value:function(t){var e=this._binaryIndexOf(t);if(this._contains(t))if(0===t.children.length){if(null!==this.children[e].e)return!1;this.children[e].e=t.e,this.subCounter+=1}else this.children[e].add(t.child)&&(this.subCounter+=1);else this.children.splice(-e,0,t),this.subCounter+=1;return!0}},{key:"del",value:function(t){var e=this._getIndexes(t),n=this,r=0,i=!1;if(0===e.length)return!1;for(n.subCounter-=1;r<e.length&&!i;){var o=n.children[e[r]]._hasElement&&r===e.length-1;o||(n.children[e[r]].subCounter-=1),n.children[e[r]].subCounter<=0&&(!n.children[e[r]]._hasElement||o)&&(n.children.splice(e[r],1),i=!0),n=n.children[e[r]],++r}return i||(n.e=null),!0}},{key:"indexOf",value:function(t){var e=this._getIndexes(t),n=0,r=this,i=void 0;if(0===e.length)return-1;r._hasElement&&(n+=1);for(var o=0;o<e.length;++o){if(e[o]<r.children.length/2)for(i=0;i<e[o];)r.children[i]._hasElement&&(n+=1),n+=r.children[i].subCounter,++i;else{for(n+=r.subCounter,i=r.children.length-1;i>=e[o];)r.children[i]._hasElement&&(n-=1),n-=r.children[i].subCounter,--i;i+=1}r.children[i]._hasElement&&(n+=1),r=r.children[i]}return n-1}},{key:"get",value:function(e){return function n(r,i,o,s){var a,c=void 0,u=0,f=void 0,l=void 0;if(r===e&&s._hasElement)return o.e=s.e,i;for(s._hasElement&&(r+=1),(a=e-r<s.subCounter/2)?c=function(t,e){return t+e}:(r+=s.subCounter,c=function(t,e){return t-e}),a||(u=s.children.length-1);a&&r<=e||!a&&r>e;)s.children[u]._hasElement&&(r=c(r,1)),r=c(r,s.children[u].subCounter),u=c(u,1);return u=c(u,-1),a&&(s.children[u]._hasElement&&(r=c(r,-1)),r=c(r,-s.children[u].subCounter)),(f=[]).push(s.children[u].t),null===i?o=i=new t(f,null):(l=new t(f,null),o.add(l),o=l),n(r,i,o,s.children[u])}(0,null,null,this)}},{key:"_getIndexes",value:function(t){return function t(e,n,r){if(!n._contains(r))return[];var i=n._binaryIndexOf(r);return e.push(i),(0===r.children.length||0===n.children.length)&&e||t(e,n.children[i],r.child)}([],this,t)}},{key:"_binaryIndexOf",value:function(t){for(var e=0,n=this.children.length-1,r=void 0,i=void 0;e<=n;)if(r=Math.floor((e+n)/2),(i=this.children[r]).compareTo(t)<0)e=r+1;else{if(!(i.compareTo(t)>0))return r;n=r-1}return~n}},{key:"_contains",value:function(t){var e=this._binaryIndexOf(t);return this.children.length>0&&(e>0||0===e&&0===this.child.compareTo(t))}},{key:"child",get:function(){return this.children.length>0&&this.children[0]||null}},{key:"_hasElement",get:function(){return null!==this.e}},{key:"isLeaf",get:function(){return 0===this.children.length}}],[{key:"fromJSON",value:function(e){var n=void 0;return 0===e.children.length?n=new t([new i(e.t.p,e.t.s,e.t.c)],e.e):(n=new t([new i(e.t.p,e.t.s,e.t.c)])).children.push(t.fromJSON(e.children[0])),n}}]),t}();t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(122),o=n(85),s=n(120),a=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._d=n,this._s=r,this._c=i,this._base=e}return r(t,[{key:"fromNode",value:function(t){for(var e=1,n=t;!n.isLeaf;)++e,n=n.child;this._d=i.int2bigInt(0,this._base.getSumBit(e-1));for(var r=0;r<e;++r)this._s.push(t.t.s),this._c.push(t.t.c),i.addInt_(this._d,t.t.p),r!==e-1&&i.leftShift_(this._d,this._base.getBitBase(r+1)),t=t.child;return this}},{key:"toNode",value:function(t){for(var e=this._base.getSumBit(this._c.length-1),n=[],r=void 0,a=0;a<this._c.length;++a)r=i.dup(this._d),i.rightShift_(r,e-this._base.getSumBit(a)),n.push(new o(i.modInt(r,Math.pow(2,this._base.getBitBase(a))),this._s[a],this._c[a]));return new s(n,t)}},{key:"compareTo",value:function(t){for(var e=this._base.getSumBit(this._c.length-1),n=this._base.getSumBit(t._c.length-1),r=!0,o=0,s=0,a=void 0,c=void 0,u=void 0;r&&s<Math.min(this._c.length,t._c.length);)a=this._base.getSumBit(s),c=i.dup(this._d),i.rightShift_(c,e-a),u=i.dup(t._d),i.rightShift_(u,n-a),i.equals(c,u)?0!==(o=this._s[s]-t._s[s])?r=!1:0!==(o=this._c[s]-t._c[s])&&(r=!1):(o=i.greater(c,u)?1:-1,r=!1),++s;return 0===o&&(o=this._c.length-t._c.length),o}}]),t}();t.exports=a},function(t,e,n){"use strict";(function(t){var r,i,o,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};o=function(t,e,n){var r=function(){return Math.random()};var i=0,o=0,s=o+1,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-";for(i=0;1<<i+1>1<<i;i++);s=(o=(1<<(i>>=1))-1)+1;var c=at(1,1,1),u=new Array(0),f=u,l=u,h=u,p=u,d=u,y=u,v=u,g=u,m=u,b=u,_=u,C=u,k=u,S=u,E=u,x=u,O=u,A=u,P=u,j=u,T=u,M=u,R=u,I=u,F=u,N=u,D=u,B=u,L=u,U=u,q=u,z=u,V=u;function W(t){var e,n,r,i;for(n=new Array(t),e=0;e<t;e++)n[e]=0;for(n[0]=2,r=0;n[r]<t;){for(e=n[r]*n[r];e<t;e+=n[r])n[e]=1;for(n[++r]=n[r-1]+1;n[r]<t&&n[n[r]];n[r]++);}for(i=new Array(r),e=0;e<r;e++)i[e]=n[e];return i}function J(t,e){return b.length!=t.length&&(b=lt(t),_=lt(t),C=lt(t)),pt(C,e),H(t,C)}function H(t,e){var n,r,s,a;for(b.length!=t.length&&(b=lt(t),_=lt(t),C=lt(t)),ht(C,e),ht(_,t),ht(b,t),dt(_,-1),dt(b,-1),s=0,n=0;n<_.length;n++)for(r=1;r<o;r<<=1)t[n]&r?(a=s<_.length+i?s:0,n=_.length,r=o):s++;if(a&&yt(_,a),Tt(C,_,t),!ct(C,1)&&!ut(C,b)){for(r=1;r<=a-1&&!ut(C,b);){if(Pt(C,t),ct(C,1))return 0;r++}if(!ut(C,b))return 0}return 1}function $(t){var e,n,r;for(e=t.length-1;0==t[e]&&e>0;e--);for(n=0,r=t[e];r;r>>=1,n++);return n+=i*e}function G(t,e){var n=at(0,(t.length>e?t.length:e)*i,0);return ht(n,t),n}function Y(t,e){var n,r,i;for(3e4,n=at(0,t,0),0==P.length&&(P=W(3e4)),V.length!=n.length&&(V=lt(n));;){for(X(n,t,0),n[0]|=1,i=0,r=0;r<P.length&&P[r]<=3e4;r++)if(0==st(n,P[r])&&!ct(n,P[r])){i=1;break}for(r=0;r<e&&!i;r++){for(X(V,t,0);!rt(n,V);)X(V,t,0);H(n,V)||(i=1)}if(!i)return n}}function Q(t,e){var n,o,s,a,c,u,f,l,h;if(0==P.length&&(P=W(3e4)),0==j.length)for(j=new Array(512),s=0;s<512;s++)j[s]=Math.pow(2,s/511-1);if(M.length!=t.length&&(M=lt(t),R=lt(t),N=lt(t),B=lt(t),q=lt(t),lt(t),lt(t),U=lt(t),L=lt(t),T=lt(t),I=lt(t),F=lt(t),D=lt(t),z=lt(t)),e<=20){for(n=(1<<(e+2>>1))-1,pt(t,0),o=1;o;)for(o=0,t[0]=1|1<<e-1|Math.floor(r()*(1<<e)),s=1;s<P.length&&(P[s]&n)==P[s];s++)if(0==t[0]%P[s]){o=1;break}ot(t)}else{if(c=.1*e*e,e>40)for(a=1;e-e*a<=20;)a=j[Math.floor(512*r())];else a=.5;for(h=Math.floor(a*e)+1,Q(F,h),pt(M,0),M[Math.floor((e-2)/i)]|=1<<(e-2)%i,it(M,F,T,I),f=$(T);;){for(;X(R,f,0),!rt(T,R););for(dt(R,1),Et(R,T),ht(L,F),xt(L,R),mt(L,2),dt(L,1),ht(B,R),mt(B,2),u=0,s=0;s<P.length&&P[s]<c;s++)if(0==st(L,P[s])&&!ct(L,P[s])){u=1;break}if(u||J(L,2)||(u=1),!u){for(dt(L,-3),s=L.length-1;0==L[s]&&s>0;s--);for(l=0,w=L[s];w;w>>=1,l++);for(l+=i*s;X(D,l,0),!rt(L,D););if(dt(L,3),dt(D,2),ht(U,D),ht(N,L),dt(N,-1),Tt(U,N,L),dt(U,-1),ft(U)&&(ht(U,D),Tt(U,B,L),dt(U,-1),ht(z,L),ht(q,U),Z(q,L),ct(q,1)))return void ht(t,z)}}}}function X(t,e,n){var o,s;for(o=0;o<t.length;o++)t[o]=0;for(s=Math.floor((e-1)/i)+1,o=0;o<s;o++)t[o]=Math.floor(r()*(1<<i-1));t[s-1]&=(2<<(e-1)%i)-1,1==n&&(t[s-1]|=1<<(e-1)%i)}function Z(t,e){var n,r,i,o,s,a,c,f,l;for(g.length!=t.length&&(g=lt(t)),l=1;l;){for(l=0,n=1;n<e.length;n++)if(e[n]){l=1;break}if(!l)break;for(n=t.length;!t[n]&&n>=0;n--);for(r=t[n],i=e[n],o=1,s=0,a=0,c=1;i+a&&i+c;){if((f=Math.floor((r+o)/(i+a)))!=Math.floor((r+s)/(i+c)))break;u=o-f*a,o=a,a=u,u=s-f*c,s=c,c=u,u=r-f*i,r=i,i=u}s?(ht(g,t),_t(t,e,o,s),_t(e,g,c,a)):(Ot(t,e),ht(g,t),ht(t,e),ht(e,g))}if(0!=e[0])for(u=st(t,e[0]),pt(t,e[0]),e[0]=u;e[0];)t[0]%=e[0],u=t[0],t[0]=e[0],e[0]=u}function K(t,e){var n=1+2*Math.max(t.length,e.length);if(!(1&t[0]||1&e[0]))return pt(t,0),0;for(S.length!=n&&(S=new Array(n),k=new Array(n),E=new Array(n),x=new Array(n),O=new Array(n),A=new Array(n)),ht(S,t),ht(k,e),pt(E,1),pt(x,0),pt(O,0),pt(A,1);;){for(;!(1&S[0]);)vt(S),1&E[0]||1&x[0]?(Et(E,e),vt(E),St(x,t),vt(x)):(vt(E),vt(x));for(;!(1&k[0]);)vt(k),1&O[0]||1&A[0]?(Et(O,e),vt(O),St(A,t),vt(A)):(vt(O),vt(A));if(rt(k,S)?(St(k,S),St(O,E),St(A,x)):(St(S,k),St(E,O),St(x,A)),ct(S,0)){for(;et(O);)Et(O,e);return ht(t,O),ct(k,1)?1:(pt(t,0),0)}}}function tt(t,e){for(var n=1,r=0;;){if(1==t)return n;if(0==t)return 0;if(r-=n*Math.floor(e/t),1==(e%=t))return r;if(0==e)return 0;n-=r*Math.floor(t/e),t%=e}}function et(t){return t[t.length-1]>>i-1&1}function nt(t,e,n){var r,i=t.length,o=e.length,s=i+n<o?i+n:o;for(r=o-1-n;r<i&&r>=0;r++)if(t[r]>0)return 1;for(r=i-1+n;r<o;r++)if(e[r]>0)return 0;for(r=s-1;r>=n;r--){if(t[r-n]>e[r])return 1;if(t[r-n]<e[r])return 0}return 0}function rt(t,e){var n,r=t.length<e.length?t.length:e.length;for(n=t.length;n<e.length;n++)if(e[n])return 0;for(n=e.length;n<t.length;n++)if(t[n])return 1;for(n=r-1;n>=0;n--){if(t[n]>e[n])return 1;if(t[n]<e[n])return 0}return 0}function it(t,e,n,r){var a,c,u,f,l,h,p,d;for(ht(r,t),c=e.length;0==e[c-1];c--);for(d=e[c-1],p=0;d;p++)d>>=1;for(gt(e,p=i-p),gt(r,p),a=r.length;0==r[a-1]&&a>c;a--);for(pt(n,0);!nt(e,r,a-c);)kt(r,e,a-c),n[a-c]++;for(u=a-1;u>=c;u--){for(r[u]==e[c-1]?n[u-c]=o:n[u-c]=Math.floor((r[u]*s+r[u-1])/e[c-1]);h=(l=(c>1?e[c-2]:0)*n[u-c])>>i,l&=o,h=(f=h+n[u-c]*e[c-1])>>i,f&=o,h==r[u]?f==r[u-1]?l>(u>1?r[u-2]:0):f>r[u-1]:h>r[u];)n[u-c]--;wt(r,e,-n[u-c],u-c),et(r)&&(Ct(r,e,u-c),n[u-c]--)}yt(e,p),yt(r,p)}function ot(t){var e,n,r,a;for(n=t.length,r=0,e=0;e<n;e++)a=0,(r+=t[e])<0&&(r+=(a=-(r>>i))*s),t[e]=r&o,r=(r>>i)-a}function st(t,e){var n,r=0;for(n=t.length-1;n>=0;n--)r=(r*s+t[n])%e;return r}function at(t,e,n){var r;r=n>(r=Math.ceil(e/i)+1)?n:r;var o=new Array(r);return pt(o,t),o}function ct(t,e){var n;if(t[0]!=e)return 0;for(n=1;n<t.length;n++)if(t[n])return 0;return 1}function ut(t,e){var n,r=t.length<e.length?t.length:e.length;for(n=0;n<r;n++)if(t[n]!=e[n])return 0;if(t.length>e.length){for(;n<t.length;n++)if(t[n])return 0}else for(;n<e.length;n++)if(e[n])return 0;return 1}function ft(t){var e;for(e=0;e<t.length;e++)if(t[e])return 0;return 1}function lt(t){var e=new Array(t.length);return ht(e,t),e}function ht(t,e){var n,r=t.length<e.length?t.length:e.length;for(n=0;n<r;n++)t[n]=e[n];for(n=r;n<t.length;n++)t[n]=0}function pt(t,e){var n,r;for(r=e,n=0;n<t.length;n++)t[n]=r&o,r>>=i}function dt(t,e){var n,r,a,c;for(t[0]+=e,r=t.length,a=0,n=0;n<r;n++)if(c=0,(a+=t[n])<0&&(a+=(c=-(a>>i))*s),t[n]=a&o,!(a=(a>>i)-c))return}function yt(t,e){var n,r=Math.floor(e/i);if(r){for(n=0;n<t.length-r;n++)t[n]=t[n+r];for(;n<t.length;n++)t[n]=0;e%=i}for(n=0;n<t.length-1;n++)t[n]=o&(t[n+1]<<i-e|t[n]>>e);t[n]>>=e}function vt(t){var e;for(e=0;e<t.length-1;e++)t[e]=o&(t[e+1]<<i-1|t[e]>>1);t[e]=t[e]>>1|t[e]&s>>1}function gt(t,e){var n,r=Math.floor(e/i);if(r){for(n=t.length;n>=r;n--)t[n]=t[n-r];for(;n>=0;n--)t[n]=0;e%=i}if(e){for(n=t.length-1;n>0;n--)t[n]=o&(t[n]<<e|t[n-1]>>i-e);t[n]=o&t[n]<<e}}function mt(t,e){var n,r,a,c;if(e)for(r=t.length,a=0,n=0;n<r;n++)c=0,(a+=t[n]*e)<0&&(a+=(c=-(a>>i))*s),t[n]=a&o,a=(a>>i)-c}function bt(t,e){var n,r,i=0;for(n=t.length-1;n>=0;n--)r=i*s+t[n],t[n]=Math.floor(r/e),i=r%e;return i}function _t(t,e,n,r){var s,a,c,u;for(c=t.length<e.length?t.length:e.length,u=t.length,a=0,s=0;s<c;s++)a+=n*t[s]+r*e[s],t[s]=a&o,a>>=i;for(s=c;s<u;s++)a+=n*t[s],t[s]=a&o,a>>=i}function wt(t,e,n,r){var s,a,c,u;for(c=t.length<r+e.length?t.length:r+e.length,u=t.length,a=0,s=r;s<c;s++)a+=t[s]+n*e[s-r],t[s]=a&o,a>>=i;for(s=c;a&&s<u;s++)a+=t[s],t[s]=a&o,a>>=i}function Ct(t,e,n){var r,s,a,c;for(a=t.length<n+e.length?t.length:n+e.length,c=t.length,s=0,r=n;r<a;r++)s+=t[r]+e[r-n],t[r]=s&o,s>>=i;for(r=a;s&&r<c;r++)s+=t[r],t[r]=s&o,s>>=i}function kt(t,e,n){var r,s,a,c;for(a=t.length<n+e.length?t.length:n+e.length,c=t.length,s=0,r=n;r<a;r++)s+=t[r]-e[r-n],t[r]=s&o,s>>=i;for(r=a;s&&r<c;r++)s+=t[r],t[r]=s&o,s>>=i}function St(t,e){var n,r,s;for(s=t.length<e.length?t.length:e.length,r=0,n=0;n<s;n++)r+=t[n]-e[n],t[n]=r&o,r>>=i;for(n=s;r&&n<t.length;n++)r+=t[n],t[n]=r&o,r>>=i}function Et(t,e){var n,r,s;for(s=t.length<e.length?t.length:e.length,r=0,n=0;n<s;n++)r+=t[n]+e[n],t[n]=r&o,r>>=i;for(n=s;r&&n<t.length;n++)r+=t[n],t[n]=r&o,r>>=i}function xt(t,e){var n;for(f.length!=2*t.length&&(f=new Array(2*t.length)),pt(f,0),n=0;n<e.length;n++)e[n]&&wt(f,t,e[n],n);ht(t,f)}function Ot(t,e){p.length!=t.length?p=lt(t):ht(p,t),d.length!=t.length&&(d=lt(t)),it(p,e,d,t)}function At(t,e,n){var r;for(l.length!=2*t.length&&(l=new Array(2*t.length)),pt(l,0),r=0;r<e.length;r++)e[r]&&wt(l,t,e[r],r);Ot(l,n),ht(t,l)}function Pt(t,e){var n,r,s,a,c;for(a=t.length;a>0&&!t[a-1];a--);for(c=a>e.length?2*a:2*e.length,l.length!=c&&(l=new Array(c)),pt(l,0),n=0;n<a;n++){for(s=l[2*n]+t[n]*t[n],l[2*n]=s&o,s>>=i,r=n+1;r<a;r++)s=l[n+r]+2*t[n]*t[r]+s,l[n+r]=s&o,s>>=i;l[n+a]=s}Ot(l,e),ht(t,l)}function jt(t,e){var n,r;for(n=t.length;n>0&&!t[n-1];n--);return ht(r=new Array(n+e),t),r}function Tt(t,e,n){var r,o,a,u;if(v.length!=n.length&&(v=lt(n)),0!=(1&n[0])){for(pt(v,0),a=n.length;a>0&&!n[a-1];a--);for(u=s-tt(st(n,s),s),v[a]=1,At(t,v,n),h.length!=t.length?h=lt(t):ht(h,t),r=e.length-1;r>0&!e[r];r--);if(0!=e[r]){for(o=1<<i-1;o&&!(e[r]&o);o>>=1);for(;;){if(!(o>>=1)){if(--r<0)return void Mt(t,c,n,u);o=1<<i-1}Mt(t,t,n,u),o&e[r]&&Mt(t,h,n,u)}}else pt(t,1)}else for(ht(v,t),pt(t,1);!ct(e,0);)1&e[0]&&At(t,v,n),bt(e,2),Pt(v,n)}function Mt(t,e,n,r){var s,a,c,u,f,l,h=n.length,p=e.length;for(m.length!=h&&(m=new Array(h)),pt(m,0);h>0&&0==n[h-1];h--);for(;p>0&&0==e[p-1];p--);for(l=m.length-1,s=0;s<h;s++){for(c=(f=m[0]+t[s]*e[0])+(u=(f&o)*r&o)*n[0]>>i,f=t[s],a=1;a<p-4;)c+=m[a]+u*n[a]+f*e[a],m[a-1]=c&o,c>>=i,c+=m[++a]+u*n[a]+f*e[a],m[a-1]=c&o,c>>=i,c+=m[++a]+u*n[a]+f*e[a],m[a-1]=c&o,c>>=i,c+=m[++a]+u*n[a]+f*e[a],m[a-1]=c&o,c>>=i,c+=m[++a]+u*n[a]+f*e[a],m[a-1]=c&o,c>>=i,a++;for(;a<p;)c+=m[a]+u*n[a]+f*e[a],m[a-1]=c&o,c>>=i,a++;for(;a<h-4;)c+=m[a]+u*n[a],m[a-1]=c&o,c>>=i,c+=m[++a]+u*n[a],m[a-1]=c&o,c>>=i,c+=m[++a]+u*n[a],m[a-1]=c&o,c>>=i,c+=m[++a]+u*n[a],m[a-1]=c&o,c>>=i,c+=m[++a]+u*n[a],m[a-1]=c&o,c>>=i,a++;for(;a<h;)c+=m[a]+u*n[a],m[a-1]=c&o,c>>=i,a++;for(;a<l;)c+=m[a],m[a-1]=c&o,c>>=i,a++;m[a-1]=c&o}rt(n,m)||St(m,n),ht(t,m)}n.exports={add:function(t,e){var n=G(t,t.length>e.length?t.length+1:e.length+1);return Et(n,e),jt(n,1)},addInt:function(t,e){var n=G(t,t.length+1);return dt(n,e),jt(n,1)},bigInt2str:function(t,e){var n,r,i,o,s="";if("string"==typeof e?(i=e.length,o=e):(i=e,o=a),y.length!=t.length?y=lt(t):ht(y,t),-1==i){for(n=t.length-1;n>0;n--)s+=t[n]+",";s+=t[0]}else for(;!ft(y);)r=bt(y,i),s=o.substring(r,r+1)+s;return 0==s.length&&(s=o[0]),s},bitSize:$,dup:lt,equals:ut,equalsInt:ct,expand:G,findPrimes:W,GCD:function(t,e){var n;return Z(n=lt(t),lt(e)),n},greater:rt,greaterShift:nt,int2bigInt:at,inverseMod:function(t,e){var n=G(t,e.length);return K(n,e)?jt(n,1):null},inverseModInt:tt,isZero:ft,millerRabin:H,millerRabinInt:J,mod:function(t,e){var n=lt(t);return Ot(n,e),jt(n,1)},modInt:st,mult:function(t,e){var n=G(t,t.length+e.length);return xt(n,e),jt(n,1)},multMod:function(t,e,n){var r=G(t,n.length);return At(r,e,n),jt(r,1)},negative:et,powMod:function(t,e,n){var r=G(t,n.length);return Tt(r,jt(e,2),jt(n,2)),jt(r,1)},randBigInt:function(t,e){var n;return X(n=at(0,0,Math.floor((t-1)/i)+2),t,e),n},randTruePrime:function(t){var e=at(0,t,0);return Q(e,t),jt(e,1)},randProbPrime:function(t){return Y(t,t>=600?2:t>=550?4:t>=500?5:t>=400?6:t>=350?7:t>=300?9:t>=250?12:t>=200?15:t>=150?18:t>=100?27:40)},str2bigInt:function(t,e,n){var r,i,o,s,c,u,f;"string"==typeof e?(o=e.length,s=e):(o=e,s=a);var l=t.length;if(-1==o){for(c=new Array(0);;){for(u=new Array(c.length+1),i=0;i<c.length;i++)u[i+1]=c[i];if(u[0]=parseInt(t,10),c=u,(r=t.indexOf(",",0))<1)break;if(0==(t=t.substring(r+1)).length)break}return c.length<n?(ht(u=new Array(n),c),u):c}for(c=at(0,o*l,0),i=0;i<l;i++)r=s.indexOf(t.substring(i,i+1),0),o<=36&&r>=36&&(r-=26),r>=o||r<0||(mt(c,o),dt(c,r));for(l=c.length;l>0&&!c[l-1];l--);for(l=n>l+1?n:l+1,u=new Array(l),f=l<c.length?l:c.length,i=0;i<f;i++)u[i]=c[i];for(;i<l;i++)u[i]=0;return u},sub:function(t,e){var n=G(t,t.length>e.length?t.length+1:e.length+1);return St(n,e),jt(n,1)},trim:jt,addInt_:dt,add_:Et,copy_:ht,copyInt_:pt,GCD_:Z,inverseMod_:K,mod_:Ot,mult_:xt,multMod_:At,powMod_:Tt,randBigInt_:X,randTruePrime_:Q,sub_:St,addShift_:Ct,carry_:ot,divide_:it,divInt_:bt,eGCD_:function(t,e,n,r,i){var o=0,s=Math.max(t.length,e.length);for(S.length!=s&&(S=new Array(s),E=new Array(s),x=new Array(s),O=new Array(s),A=new Array(s));!(1&t[0]||1&e[0]);)vt(t),vt(e),o++;for(ht(S,t),ht(n,e),pt(E,1),pt(x,0),pt(O,0),pt(A,1);;){for(;!(1&S[0]);)vt(S),1&E[0]||1&x[0]?(Et(E,e),vt(E),St(x,t),vt(x)):(vt(E),vt(x));for(;!(1&n[0]);)vt(n),1&O[0]||1&A[0]?(Et(O,e),vt(O),St(A,t),vt(A)):(vt(O),vt(A));if(rt(n,S)?(St(n,S),St(O,E),St(A,x)):(St(S,n),St(E,O),St(x,A)),ct(S,0)){for(;et(O);)Et(O,e),St(A,t);return mt(A,-1),ht(r,O),ht(i,A),void gt(n,o)}}},halve_:vt,leftShift_:gt,linComb_:_t,linCombShift_:wt,mont_:Mt,multInt_:mt,rightShift_:yt,squareMod_:Pt,subShift_:kt}},"object"===s(e)?o(n(209),0,t):void 0===(i="function"==typeof(r=o)?r.call(e,n,e,t):r)||(t.exports=i)}).call(this,n(54)(t))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(124);function o(t){return function(e){var n=void 0;return t.reduce(function(t,e){return void 0===(n=e(t))||null===n?t:n},e)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._serviceName=e,this._camelCasedName=i.camelCase(this._serviceName),this._capitalizedCamelCase=i.capitalize(this._camelCasedName)}return r(t,[{key:"buildService",value:function(t){throw new Error("A valid Builder must implement a valid buildService method")}},{key:"buildHandler",value:function(t,e){t.prototype[this.handlerName]=e}},{key:"buildBeforeHooks",value:function(t,e){e.send.length>0&&(t.prototype[this.beforeSendName]=o(e.send)),e.receive.length>0&&(t.prototype[this.beforeReceiveName]=o(e.receive))}},{key:"buildAfterHooks",value:function(t,e){e.send.length>0&&(t.prototype[this.afterSendName]=o(e.send)),e.receive.length>0&&(t.prototype[this.afterReceiveName]=o(e.receive))}},{key:"methodName",get:function(){return this._camelCasedName}},{key:"handlerName",get:function(){return"_"+this._camelCasedName}},{key:"beforeSendName",get:function(){return"_beforeSend"+this._capitalizedCamelCase}},{key:"beforeReceiveName",get:function(){return"_beforeReceive"+this._capitalizedCamelCase}},{key:"afterSendName",get:function(){return"_afterSend"+this._capitalizedCamelCase}},{key:"afterReceiveName",get:function(){return"_afterReceive"+this._capitalizedCamelCase}}]),t}();t.exports=s},function(t,e,n){"use strict";var r=function(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")},i=function(t){return t[0].toUpperCase()+t.slice(1)};t.exports={camelCase:r,capitalize:i,methodName:function(t){return r(t)},handlerName:function(t){return"_"+r(t)},beforeSendName:function(t){return"_beforeSend"+i(r(t))},beforeReceiveName:function(t){return"_beforeReceive"+i(r(t))},afterSendName:function(t){return"_afterSend"+i(r(t))},afterReceiveName:function(t){return"_afterReceive"+i(r(t))}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(59),o=n(247),s=n(11),a=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s({webrtc:{trickle:!0,iceServers:[]},origins:"*"},t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"_buildRPS",value:function(t){var e=s({config:t.webrtc},t);return new o(e)}},{key:"getNeighbours",value:function(t){return this._rps.getPeers(t)}},{key:"inviewId",get:function(){return this._rps.getInviewId()}},{key:"outviewId",get:function(){return this._rps.getOutviewId()}}]),e}();t.exports=a},function(t,e,n){"use strict";(function(r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(274)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(15))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(59),o=n(280),s=n(11),a=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s({webrtc:{trickle:!0,iceServers:[]},origins:"*"},t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"_buildRPS",value:function(t){var e=s({config:t.webrtc},t);return new o(e)}},{key:"getNeighbours",value:function(t){return this._rps.getPeers(t)}},{key:"inviewId",get:function(){return this._rps.getInviewId()}},{key:"outviewId",get:function(){return this._rps.getOutviewId()}}]),e}();t.exports=a},function(t,e,n){"use strict";var r=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return e.apply(t,n.concat(r.call(arguments)))}}},function(t,e,n){"use strict";t.exports=function(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(89),o=n(50),s=n(282),a=n(129),c=n(128),u=n(13)("socket.io-client:socket"),f=n(66),l=n(134);t.exports=d;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=o.prototype.emit;function d(t,e,n){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[a(t,"open",c(this,"onopen")),a(t,"packet",c(this,"onpacket")),a(t,"close",c(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},d.prototype.send=function(){var t=s(arguments);return t.unshift("message"),this.emit.apply(this,t),this},d.prototype.emit=function(t){if(h.hasOwnProperty(t))return p.apply(this,arguments),this;var e=s(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:l(e))?i.BINARY_EVENT:i.EVENT,data:e,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},d.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},d.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"===r(this.query)?f.encode(this.query):this.query;u("sending connect packet with query %s",t),this.packet({type:i.CONNECT,query:t})}else this.packet({type:i.CONNECT})},d.prototype.onclose=function(t){u("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},d.prototype.onpacket=function(t){var e=t.nsp===this.nsp,n=t.type===i.ERROR&&"/"===t.nsp;if(e||n)switch(t.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(t);break;case i.ACK:case i.BINARY_ACK:this.onack(t);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",t.data)}},d.prototype.onevent=function(t){var e=t.data||[];u("emitting event %j",e),null!=t.id&&(u("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?p.apply(this,e):this.receiveBuffer.push(e)},d.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var r=s(arguments);u("sending ack %j",r),e.packet({type:l(r)?i.BINARY_ACK:i.ACK,id:t,data:r})}}},d.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(u("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):u("bad ack %s",t.id)},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)p.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},d.prototype.compress=function(t){return this.flags.compress=t,this},d.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e,n){"use strict";var r=[].indexOf;t.exports=function(t,e){if(r)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},function(t,e,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,s={},a=0,c=0;function u(t){var e="";do{e=i[t%o]+e,t=Math.floor(t/o)}while(t>0);return e}function f(){var t=u(+new Date);return t!==r?(a=0,r=t):t+"."+u(a++)}for(;c<o;c++)s[i[c]]=c;f.encode=u,f.decode=function(t){var e=0;for(c=0;c<t.length;c++)e=e*o+s[t.charAt(c)];return e},t.exports=f},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){"use strict";(function(e){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(291),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);t.exports=function t(n){if(!n||"object"!==(void 0===n?"undefined":r(n)))return!1;if(i(n)){for(var o=0,c=n.length;o<c;o++)if(t(n[o]))return!0;return!1}if("function"==typeof e&&e.isBuffer&&e.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||s&&n instanceof Blob||a&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return t(n.toJSON(),!0);for(var u in n)if(Object.prototype.hasOwnProperty.call(n,u)&&t(n[u]))return!0;return!1}}).call(this,n(67).Buffer)},function(t,e,n){"use strict";var r=n(87),i=n(66),o=n(49),s=n(65),a=n(132),c=n(13)("engine.io-client:polling");t.exports=f;var u=null!=new(n(88))({xdomain:!1}).responseType;function f(t){var e=t&&t.forceBase64;u&&!e||(this.supportsBinary=!1),r.call(this,t)}s(f,r),f.prototype.name="polling",f.prototype.doOpen=function(){this.poll()},f.prototype.pause=function(t){var e=this;function n(){c("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){c("pre-pause polling complete"),--r||n()})),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",function(){c("pre-pause writing complete"),--r||n()}))}else n()},f.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},f.prototype.onData=function(t){var e=this;c("polling got data %s",t);o.decodePayload(t,this.socket.binaryType,function(t,n,r){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},f.prototype.doClose=function(){var t=this;function e(){c("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),e()):(c("transport not open - deferring close"),this.once("open",e))},f.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")};o.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,n)})},f.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(n=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t}},function(t,e,n){"use strict";(function(t){var r=n(88),i=n(293),o=n(285),s=n(284);e.polling=function(e){var n=!1,s=!1,a=!1!==e.jsonp;if(t.location){var c="https:"===location.protocol,u=location.port;u||(u=c?443:80),n=e.hostname!==location.hostname||u!==e.port,s=e.secure!==c}if(e.xdomain=n,e.xscheme=s,"open"in new r(e)&&!e.forceJSONP)return new i(e);if(!a)throw new Error("JSONP disabled");return new o(e)},e.websocket=s}).call(this,n(6))},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(296),o=n(130),s=n(50),a=n(89),c=n(129),u=n(128),f=n(13)("socket.io-client:manager"),l=n(131),h=n(281),p=Object.prototype.hasOwnProperty;function d(t,e){if(!(this instanceof d))return new d(t,e);t&&"object"===(void 0===t?"undefined":r(t))&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||a;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}t.exports=d,d.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},d.prototype.updateSocketIds=function(){for(var t in this.nsps)p.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},d.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},s(d.prototype),d.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},d.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},d.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(t,e){if(f("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;f("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=c(n,"open",function(){r.onopen(),t&&t()}),s=c(n,"error",function(e){if(f("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;f("connect attempt will timeout after %d",a);var u=setTimeout(function(){f("connect attempt timed out after %d",a),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(o),this.subs.push(s),this},d.prototype.onopen=function(){f("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(c(t,"data",u(this,"ondata"))),this.subs.push(c(t,"ping",u(this,"onping"))),this.subs.push(c(t,"pong",u(this,"onpong"))),this.subs.push(c(t,"error",u(this,"onerror"))),this.subs.push(c(t,"close",u(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",u(this,"ondecoded")))},d.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},d.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},d.prototype.ondata=function(t){this.decoder.add(t)},d.prototype.ondecoded=function(t){this.emit("packet",t)},d.prototype.onerror=function(t){f("error",t),this.emitAll("error",t)},d.prototype.socket=function(t,e){var n=this.nsps[t];if(!n){n=new o(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",i),n.on("connect",function(){n.id=r.generateId(t)}),this.autoConnect&&i()}function i(){~l(r.connecting,n)||r.connecting.push(n)}return n},d.prototype.destroy=function(t){var e=l(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},d.prototype.packet=function(t){f("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(n){for(var r=0;r<n.length;r++)e.engine.write(n[r],t.options);e.encoding=!1,e.processPacketQueue()}))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},d.prototype.cleanup=function(){f("cleanup");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){f("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(t){f("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)f("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();f("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(f("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(f("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(f("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},d.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,n){"use strict";(function(e){t.exports=function(t){return n&&e.Buffer.isBuffer(t)||r&&(t instanceof e.ArrayBuffer||i(t))};var n="function"==typeof e.Buffer&&"function"==typeof e.Buffer.isBuffer,r="function"==typeof e.ArrayBuffer,i=r&&"function"==typeof e.ArrayBuffer.isView?e.ArrayBuffer.isView:function(t){return t.buffer instanceof e.ArrayBuffer}}).call(this,n(6))},function(t,e,n){"use strict";var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,n){"use strict";var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,n=t.indexOf("["),o=t.indexOf("]");-1!=n&&-1!=o&&(t=t.substring(0,n)+t.substring(n,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=r.exec(t||""),a={},c=14;c--;)a[i[c]]=s[c]||"";return-1!=n&&-1!=o&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(298),o=n(89),s=n(137),a=n(13)("socket.io-client");t.exports=e=u;var c=e.managers={};function u(t,e){"object"===(void 0===t?"undefined":r(t))&&(e=t,t=void 0),e=e||{};var n,o=i(t),u=o.source,f=o.id,l=o.path,h=c[f]&&l in c[f].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||h?(a("ignoring socket cache for %s",u),n=s(u,e)):(c[f]||(a("new io instance for %s",u),c[f]=s(u,e)),n=c[f]),o.query&&!e.query&&(e.query=o.query),n.socket(o.path,e)}e.protocol=o.protocol,e.connect=u,e.Manager=n(137),e.Socket=n(130)},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(12),o=n(141),s=n(13)("foglet-core:signaling"),a=n(11),c=n(27),u=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(!(t&&n&&n.address&&n.room))throw s(n),new SyntaxError("Not enough parameters, need a source an address and a room.");return r.options=a({address:"http://localhost:3000/",origins:"*",room:c(),timeout:2e4,io:o,reconnectionAttempts:10},n),s("Signaling options: ",r.options),r._network=t,r._id=r._network.id,r._source=t.rps,r._socket=r.options.io(r.options.address,{autoConnect:!1,origins:r.options.origins,reconnectionAttempts:r.options.reconnectionAttempts,timeout:r.options.timeout}),r._socket.on("connect_timeout",function(t){r.unsignaling(),r._manageTimeout(t)}),r._socket.on("connect_error",function(t){r.unsignaling(),r._manageConnectionError(t)}),r._socket.on("error",function(t){r.unsignaling(),r._manageError(t)}),r._socket.on("disconnect",function(t){r._manageDisconnection(t)}),r._socket.on("new_spray",function(t){s("Receive a new offer: ",t),r._source.connect(function(t){s("Emit the accepted offer: ",t),r._socket.emit("accept",{id:r._id,offer:t,room:r.options.room})},t)}),r._socket.on("accept_spray",function(t){s("Receive an accepted offer: ",t),r._source.connect(t)}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"connection",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.timeout;return null===e&&null===this._socket?Promise.reject(new Error("There is no available connection to the server. Try to use the function signaling() before.")):new Promise(function(r,i){var o=setTimeout(function(){i(new Error("connection timed out."))},n),a=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];clearTimeout(o),r({connected:!0,alone:t})},c=function(t){"connected"===t?a():(clearTimeout(o),i(t))};try{e?t._source.join(t.direct(t._network.rps,e.rps)).then(function(){a()}).catch(c):(s("Connecting to the room "+t.options.room+"..."),t._socket.emit("joinRoom",{id:t._id,room:t.options.room}),t._socket.on("joinedRoom",function(e){e.connected?a(!0):(t._source.join(t._signalingInit()).then(function(){t._socket.emit("connected",{id:t._id,room:t.options.room})}).catch(c),t._socket.once("connected",function(){s("Peer connected."),a()})),s("Connected to the room: "+t.options.room)}))}catch(t){i(t)}})}},{key:"signaling",value:function(){s("Connection to the signaling server..."),this._socket.open()}},{key:"unsignaling",value:function(){s("Disconnection from the signaling server..."),this._socket.emit("disconnect"),this._socket.removeAllListeners("connected"),this._socket.removeAllListeners("joinedRoom"),this._socket.close()}},{key:"direct",value:function(t,e){return function(n){e.connect(function(e){t.connect(e)},n)}}},{key:"_signalingInit",value:function(){var t=this;console.log(this._id);var e=this;return function(n){s("Emit a new offer."),t._socket.emit("new",{id:e._id,tid:c(),offer:n,room:t.options.room})}}},{key:"_manageTimeout",value:function(t){s(t)}},{key:"_manageError",value:function(t){s(t)}},{key:"_manageDisconnection",value:function(t){s(t)}},{key:"_manageConnectionError",value:function(t){s(t)}}]),e}();t.exports=u},function(t,e,n){"use strict";t.exports=o;var r=n(51),i=n(60);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"==typeof this._flush?this._flush(function(e,n){a(t,e,n)}):a(this,null,null)}function a(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(52),i.inherits(o,r),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},function(t,e,n){"use strict";var r=n(61).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=c,this.end=u,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=f,this.end=l,e=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function c(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function f(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function l(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function h(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);if(i>=0)return i>0&&(t.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=s(e[r]))>=0)return i>0&&(t.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=s(e[r]))>=0)return i>0&&(2===i?i=0:t.lastNeed=i-3),i;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";(function(e,r,i){var o=n(68);function s(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;t.entry=null;for(;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=m;var a,c=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:o.nextTick;m.WritableState=g;var u=n(60);u.inherits=n(52);var f={deprecate:n(303)},l=n(147),h=n(61).Buffer,p=i.Uint8Array||function(){};var d,y=n(146);function v(){}function g(t,e){a=a||n(51),t=t||{};var r=e instanceof a;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,u=t.writableHighWaterMark,f=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(u||0===u)?u:f,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===t.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?(o.nextTick(i,r),o.nextTick(S,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),S(t,e))}(t,n,r,e,i);else{var s=C(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||w(t,n),r?c(_,t,n,s,i):_(t,n,s,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function m(t){if(a=a||n(51),!(d.call(m,this)||this instanceof a))return new m(t);this._writableState=new g(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),l.call(this)}function b(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function _(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),S(t,e)}function w(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var a=0,c=!0;n;)i[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;i.allBuffers=c,b(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new s(e),e.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,f=n.encoding,l=n.callback;if(b(t,e,!1,e.objectMode?1:u.length,u,f,l),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function C(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function k(t,e){t._final(function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),S(t,e)})}function S(t,e){var n=C(e);return n&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(k,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}u.inherits(m,l),g.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(g.prototype,"buffer",{get:f.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(t){return!!d.call(this,t)||this===m&&(t&&t._writableState instanceof g)}})):d=function(t){return t instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(t,e,n){var r,i=this._writableState,s=!1,a=!i.objectMode&&(r=t,h.isBuffer(r)||r instanceof p);return a&&!h.isBuffer(t)&&(t=function(t){return h.from(t)}(t)),"function"==typeof e&&(n=e,e=null),a?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof n&&(n=v),i.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),o.nextTick(e,n)}(this,n):(a||function(t,e,n,r){var i=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),o.nextTick(r,s),i=!1),i}(this,i,t,n))&&(i.pendingcb++,s=function(t,e,n,r,i,o){if(!n){var s=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=h.from(e,n));return e}(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;c||(e.needDrain=!0);if(e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else b(t,e,!1,a,r,i,o);return c}(this,i,a,t,e,n)),s},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},m.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,S(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),m.prototype.destroy=y.destroy,m.prototype._undestroy=y.undestroy,m.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(15),n(305).setImmediate,n(6))},function(t,e,n){"use strict";var r=n(68);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";t.exports=n(12).EventEmitter},function(t,e,n){"use strict";var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,n){"use strict";(function(e,r){var i=n(68);t.exports=b;var o,s=n(148);b.ReadableState=m;n(12).EventEmitter;var a=function(t,e){return t.listeners(e).length},c=n(147),u=n(61).Buffer,f=e.Uint8Array||function(){};var l=n(60);l.inherits=n(52);var h=n(308),p=void 0;p=h&&h.debuglog?h.debuglog("stream"):function(){};var d,y=n(307),v=n(146);l.inherits(b,c);var g=["error","close","destroy","pause","resume"];function m(t,e){o=o||n(51),t=t||{};var r=e instanceof o;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,s=t.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=n(144).StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function b(t){if(o=o||n(51),!(this instanceof b))return new b(t);this._readableState=new m(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),c.call(this)}function _(t,e,n,r,i){var o,s=t._readableState;null===e?(s.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,S(t)}(t,s)):(i||(o=function(t,e){var n;r=e,u.isBuffer(r)||r instanceof f||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(s,e)),o?t.emit("error",o):s.objectMode||e&&e.length>0?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===u.prototype||(e=function(t){return u.from(t)}(e)),r?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):w(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?w(t,s,e,!1):x(t,s)):w(t,s,e,!1))):r||(s.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(s)}function w(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&S(t)),x(t,e)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),b.prototype.destroy=v.destroy,b.prototype._undestroy=v.undestroy,b.prototype._destroy=function(t,e){this.push(null),e(t)},b.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=u.from(t,e),e=""),n=!0),_(this,t,e,!1,n)},b.prototype.unshift=function(t){return _(this,t,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return d||(d=n(144).StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t,this};var C=8388608;function k(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=C?t=C:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function S(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(E,t):E(t))}function E(t){p("emit readable"),t.emit("readable"),j(t)}function x(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(O,t,e))}function O(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(p("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function A(t){p("readable nexttick read 0"),t.read(0)}function P(t,e){e.reading||(p("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),j(t),e.flowing&&!e.reading&&t.read(0)}function j(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&null!==t.read(););}function T(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),0===(t-=s)){s===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=u.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,s),0===(t-=s)){s===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++i}return e.length-=i,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function M(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(R,e,t))}function R(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function I(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}b.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return p("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?M(this):S(this),null;if(0===(t=k(t,e))&&e.ended)return 0===e.length&&M(this),null;var r,i=e.needReadable;return p("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&p("length less than watermark",i=!0),e.ended||e.reading?p("reading or ended",i=!1):i&&(p("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=k(n,e))),null===(r=t>0?T(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&M(this)),null!==r&&this.emit("data",r),r},b.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,e);var c=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr?f:b;function u(e,r){p("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,p("cleanup"),t.removeListener("close",g),t.removeListener("finish",m),t.removeListener("drain",l),t.removeListener("error",v),t.removeListener("unpipe",u),n.removeListener("end",f),n.removeListener("end",b),n.removeListener("data",y),h=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||l())}function f(){p("onend"),t.end()}o.endEmitted?i.nextTick(c):n.once("end",c),t.on("unpipe",u);var l=function(t){return function(){var e=t._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,j(t))}}(n);t.on("drain",l);var h=!1;var d=!1;function y(e){p("ondata"),d=!1,!1!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==I(o.pipes,t))&&!h&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function v(e){p("onerror",e),b(),t.removeListener("error",v),0===a(t,"error")&&t.emit("error",e)}function g(){t.removeListener("finish",m),b()}function m(){p("onfinish"),t.removeListener("close",g),b()}function b(){p("unpipe"),n.unpipe(t)}return n.on("data",y),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?s(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",v),t.once("close",g),t.once("finish",m),t.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),t},b.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=I(e.pipes,t);return-1===s?this:(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},b.prototype.on=function(t,e){var n=c.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&S(this):i.nextTick(A,this))}return n},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var t=this._readableState;return t.flowing||(p("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(P,t,e))}(this,t)),this},b.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",function(){if(p("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){(p("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&void 0!==i)&&((n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause())))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<g.length;o++)t.on(g[o],this.emit.bind(this,g[o]));return this._read=function(e){p("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=T}).call(this,n(6),n(15))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(319),o=n(317),s=n(316),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.local=new o(e),this.vector=new i(o.comparator),this.vector.insert(this.local)}return r(t,[{key:"clone",value:function(){for(var e=new t(this.local.e),n=0;n<this.vector.arr.length;++n){e.vector.arr[n]=new o(this.vector.arr[n].e),e.vector.arr[n].v=this.vector.arr[n].v;for(var r=0;r<this.vector.arr[n].x.length;++r)e.vector.arr[n].x.push(this.vector.arr[n].x[r]);e.vector.arr[n].e===this.local.e&&(e.local=e.vector.arr[n])}return e}},{key:"increment",value:function(){return this.local.increment(),new s(this.local.e,this.local.v)}},{key:"incrementFrom",value:function(t){var e=this.vector.indexOf(t.e);e<0?(this.vector.insert(new o(t.e)),this.vector.arr[this.vector.indexOf(t.e)].incrementFrom(t.c)):this.vector.arr[e].incrementFrom(t.c)}},{key:"isReady",value:function(t){if(void 0===t||null===t)return!0;var e=this.vector.indexOf(t.e);return e>=0&&t.c<=this.vector.arr[e].v&&this.vector.arr[e].x.indexOf(t.c)<0}},{key:"isLower",value:function(t){return void 0!==t&&null!==t&&this.isReady(t)}},{key:"merge",value:function(t){for(var e=0;e<t.vector.arr.length;++e){var n=t.vector.arr[e],r=this.vector.indexOf(n);if(r<0){var i=new o(n.e);i.v=n.v;for(var s=0;s<n.x.length;++s)i.x.push(n.x[s]);this.vector.insert(i)}else{for(var a=this.vector.arr[r],c=0;c<a.x.length;)a.x[c]<n.v&&n.x.indexOf(a.x[c])<0?a.x.splice(c,1):++c;for(c=0;c<n.x.length;)n.x[c]>a.v&&a.x.indexOf(n.x[c])<0&&a.x.push(n.x[c]),++c;a.v=Math.max(a.v,n.v)}}}}],[{key:"fromJSON",value:function(e){for(var n=new t(e.local.e),r=0;r<e.vector.arr.length;++r){n.vector.arr[r]=new o(e.vector.arr[r].e),n.vector.arr[r].v=e.vector.arr[r].v;for(var i=0;i<e.vector.arr[r].x.length;++i)n.vector.arr[r].x.push(e.vector.arr[r].x[i]);e.vector.arr[r].e===e.local.e&&(n.local=n.vector.arr[r])}return n}}]),t}();t.exports=a},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var o=n(320),s=n(150),a=n(315),c=n(27),u=n(314),f=n(13)("foglet-core:broadcast");function l(t){return"e="+t.id.e+"&c="+t.id.c}var h=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return t&&n?(r.options={id:t._options.peer,delta:3e4},r._causality=new s(r.options.id),r._buffer=[],r._bufferAntiEntropy=a.MAntiEntropyResponse("init"),r):i(r,new Error("Not enough parameters","fbroadcast.js"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),r(e,[{key:"_sendAll",value:function(t){var e=this,n=this._source.getNeighbours(1/0);n.length>0&&n.forEach(function(n){return e._unicast.send(n,t).catch(function(t){return f("Error: It seems there is not a receiver",t)})})}},{key:"send",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=e||this._causality.increment(),i=a.BroadcastMessage(this._protocol,r,n,t);return this._causality.incrementFrom(r),this._sendAll(i),r}},{key:"startAntiEntropy",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.delta;this._intervalAntiEntropy=setInterval(function(){t._source.getNeighbours().forEach(function(e){return t._unicast.send(e,a.MAntiEntropyRequest(t._causality))})},e),this.on("antiEntropy",function(e,n,r){return t._defaultBehaviorAntiEntropy(e,n,r)})}},{key:"_defaultBehaviorAntiEntropy",value:function(t,e,n){f("(Warning) You should modify this, AntiEntropy default behavior: ",t,e,n)}},{key:"clearAntiEntropy",value:function(){this._intervalAntiEntropy&&clearInterval(this._intervalAntiEntropy)}},{key:"sendAntiEntropyResponse",value:function(t,e,n){for(var r=c(),i=this._unicast.send(t,a.MAntiEntropyResponse(r,e,n.length)),o=0;i&&o<n.length;)i=this._unicast.send(t,a.MAntiEntropyResponse(r,null,n.length,n[o])),++o}},{key:"_receive",value:function(t,e){switch("issuer"in e||(e.issuer=t),e.type){case"MAntiEntropyRequest":f(t,e),this.emit("antiEntropy",t,e.causality,this._causality.clone());break;case"MAntiEntropyResponse":if(this._bufferAntiEntropy.id!==e.id&&(this._bufferAntiEntropy=e),e.element&&this._bufferAntiEntropy.elements.push(e.element),e.causality&&(this._bufferAntiEntropy.causality=e.causality),this._bufferAntiEntropy.elements.length===this._bufferAntiEntropy.nbElements){for(var n=0;n<this._bufferAntiEntropy.elements.length;++n){var r=this._bufferAntiEntropy.elements[n];this._shouldStopPropagation(r)||(this._causality.incrementFrom(r.id),this.emit("receive",e.issuer,r.payload))}this._causality.merge(this._bufferAntiEntropy.causality)}break;default:if(!this._shouldStopPropagation(e)){var i=u(this._buffer,e,l);this._buffer.splice(i,0,e),this._reviewBuffer(),this._sendAll(e)}}}},{key:"_shouldStopPropagation",value:function(t){return this._causality.isLower(t.id)||this._findInBuffer(l(t))>=0}},{key:"_findInBuffer",value:function(t){for(var e=0,n=this._buffer.length-1,r=void 0,i=void 0;e<=n;)if(r=(e+n)/2|0,(i=l(this._buffer[r]))<t)e=r+1;else{if(!(i>t))return r;n=r-1}return-1}},{key:"_reviewBuffer",value:function(){for(var t=void 0,e=!1,n=this._buffer.length-1;n>=0;--n)t=this._buffer[n],this._causality.isLower(t.id)?this._buffer.splice(n,1):this._causality.isReady(t.isReady)&&(e=!0,this._causality.incrementFrom(t.id),this._buffer.splice(n,1),this.emit("receive",t.issuer,t.payload));e&&this._reviewBuffer()}}]),e}();t.exports=h},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(92),o=n(151),s=n(312),a=n(311),c=n(300),u=n(299),f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.network=e,this.unicast=new i(this.network,n),this.broadcast=new o(this.network,n),this.media=new u(this.network,n),this._unicastStreams=new i(this.network,n+"-streams"),this._broadcastStreams=new o(this.network,n+"-streams"),this._activeStreams=new Map,this._middlewares=new s}return r(t,[{key:"use",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._middlewares.register(t,e)}},{key:"sendUnicastMediaStream",value:function(t,e){return console.log("[Warning] experimental function. Allows you to send a stream to a neighbor. But will be closed when a shuffle arrives."),this.media.sendUnicast(t,e)}},{key:"sendBroadcastMediaStream",value:function(t,e){return console.log("[Warning] experimental function. Allows you to send a stream to all the network."),this.media.sendBroadcast(t,e)}},{key:"onMediaStream",value:function(t){this.media.on("receive",t)}},{key:"sendUnicast",value:function(t,e){return this.unicast.send(t,this._middlewares.in(e))}},{key:"streamUnicast",value:function(t){var e=this;return new a(function(n){n.payload=e._middlewares.in(n.payload),e._unicastStreams.send(t,n)})}},{key:"sendMulticast",value:function(t,e){return this.unicast.sendMultiple(t,this._middlewares.in(e))}},{key:"sendBroadcast",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return this.broadcast.send(this._middlewares.in(t),e,n)}},{key:"streamBroadcast",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return new a(function(e,n,r){return e.payload=t._middlewares.in(e.payload),t._broadcastStreams.send(e,n,r)},e)}},{key:"onUnicast",value:function(t){var e=this;this.unicast.on("receive",function(n,r){t(n,e._middlewares.out(r))})}},{key:"onStreamUnicast",value:function(t){var e=this;this._unicastStreams.on("receive",function(n,r){return e._handleStreamMessage(n,r,t)})}},{key:"onOnceUnicast",value:function(t){var e=this;this.unicast.once("receive",function(n,r){t(n,e._middlewares.out(r))})}},{key:"onBroadcast",value:function(t){var e=this;this.broadcast.on("receive",function(n,r){return t(n,e._middlewares.out(r))})}},{key:"onStreamBroadcast",value:function(t){var e=this;this._broadcastStreams.on("receive",function(n,r){return e._handleStreamMessage(n,r,t)})}},{key:"onOnceBroadcast",value:function(t){var e=this;this.broadcast.once("receive",function(n,r){return t(n,e._middlewares.out(r))})}},{key:"removeAllUnicastCallback",value:function(){this.unicast.removeAllListeners("receive")}},{key:"removeAllBroacastCallback",value:function(){this.broadcast.removeAllListeners("receive")}},{key:"_handleStreamMessage",value:function(t,e,n){switch(this._activeStreams.has(e.id)||(this._activeStreams.set(e.id,new c),n(t,this._activeStreams.get(e.id))),e.type){case"chunk":this._activeStreams.get(e.id).push(e.payload);break;case"trailers":if(!this._activeStreams.has(e.id))throw new Error("Cannot add trailers to an unkown stream with id = "+e.id);this._activeStreams.get(e.id)._trailers=e.payload;break;case"end":this._closeStream(e.id);break;case"error":if(!this._activeStreams.has(e.id))throw new Error("Cannot transmit an error to an unkown stream with id = "+e.id);this._activeStreams.get(e.id).emit("error",e.payload),this._closeStream(e.id);break;default:throw new Error("Unknown StreamMessage type found in incoming stream message: "+e.type)}}},{key:"_closeStream",value:function(t){if(!this._activeStreams.has(t))throw new Error("Cannot close an unkown stream with id = "+t);this._activeStreams.get(t).push(null),this._activeStreams.delete(t)}}]),t}();t.exports=f},function(t,e,n){"use strict";var r=n(336);t.exports=function(t,e){for(var n,i=0,o="";!n;)o+=t(e>>4*i&15|r()),n=e<Math.pow(16,i+1),i++;return o}},function(t,e,n){"use strict";t.exports=n(338)},function(t,e,n){"use strict";t.exports=Math.scale||function(t,e,n,r,i){return 0===arguments.length||t!=t||e!=e||n!=n||r!=r||i!=i?NaN:t===1/0||t===-1/0?t:(t-e)*(i-r)/(n-e)+r}},function(t,e,n){"use strict";var r=n(39);t.exports=function(t,e){var n=[];return r(t,!1,n.push,n,e),n}},function(t,e,n){"use strict";var r=n(62),i=n(156);t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,e,n){"use strict";var r=n(45),i=n(21),o=n(63).f;t.exports=function(t){return function(e){for(var n,s=i(e),a=r(s),c=a.length,u=0,f=[];c>u;)o.call(s,n=a[u++])&&f.push(t?[n,s[n]]:s[n]);return f}}},function(t,e,n){"use strict";var r=n(7),i=n(111),o=n(31);t.exports=function(t,e,n,s){var a=String(o(t)),c=a.length,u=void 0===n?" ":String(n),f=r(e);if(f<=c||""==u)return a;var l=f-c,h=i.call(u,Math.ceil(l/u.length));return h.length>l&&(h=h.slice(0,l)),s?h+a:a+h}},function(t,e,n){"use strict";var r=n(81),i=n(4),o=n(7),s=n(25),a=n(5)("isConcatSpreadable");t.exports=function t(e,n,c,u,f,l,h,p){for(var d,y,v=f,g=0,m=!!h&&s(h,p,3);g<u;){if(g in c){if(d=m?m(c[g],g,n):c[g],y=!1,i(d)&&(y=void 0!==(y=d[a])?!!y:r(d)),y&&l>0)v=t(e,n,d,o(d.length),v,l-1)-1;else{if(v>=9007199254740991)throw TypeError();e[v]=d}v++}g++}return v}},function(t,e,n){"use strict";var r=n(42),i=n(82),o=n(1),s=n(2).Reflect;t.exports=s&&s.ownKeys||function(t){var e=r.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";var r=n(30),i=n(7);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){"use strict";var r=n(38),i=n(37).getWeak,o=n(1),s=n(4),a=n(40),c=n(39),u=n(28),f=n(22),l=n(55),h=u(5),p=u(6),d=0,y=function(t){return t._l||(t._l=new v)},v=function(){this.a=[]},g=function(t,e){return h(t.a,function(t){return t[0]===e})};v.prototype={get:function(t){var e=g(this,t);if(e)return e[1]},has:function(t){return!!g(this,t)},set:function(t,e){var n=g(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var u=t(function(t,r){a(t,u,e,"_i"),t._t=e,t._i=d++,t._l=void 0,void 0!=r&&c(r,n,t[o],t)});return r(u.prototype,{delete:function(t){if(!s(t))return!1;var n=i(t);return!0===n?y(l(this,e)).delete(t):n&&f(n,this._i)&&delete n[this._i]},has:function(t){if(!s(t))return!1;var n=i(t);return!0===n?y(l(this,e)).has(t):n&&f(n,this._i)}}),u},def:function(t,e,n){var r=i(o(e),!0);return!0===r?y(t).set(e,n):r[t._i]=n,t},ufstore:y}},function(t,e,n){"use strict";var r,i=n(28)(0),o=n(17),s=n(37),a=n(183),c=n(163),u=n(4),f=n(3),l=n(55),h=s.getWeak,p=Object.isExtensible,d=c.ufstore,y={},v=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},g={get:function(t){if(u(t)){var e=h(t);return!0===e?d(l(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return c.def(l(this,"WeakMap"),t,e)}},m=t.exports=n(74)("WeakMap",v,g,c,!0,!0);f(function(){return 7!=(new m).set((Object.freeze||Object)(y),7).get(y)})&&(a((r=c.getConstructor(v,"WeakMap")).prototype,g),s.NEED=!0,i(["delete","has","get","set"],function(t){var e=m.prototype,n=e[t];o(e,t,function(e,i){if(u(e)&&!p(e)){this._f||(this._f=new r);var o=this._f[t](e,i);return"set"==t?this:o}return n.call(this,e,i)})}))},function(t,e,n){"use strict";var r=n(166),i=n(55);t.exports=n(74)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},function(t,e,n){"use strict";var r=n(8).f,i=n(43),o=n(38),s=n(25),a=n(40),c=n(39),u=n(107),f=n(171),l=n(41),h=n(9),p=n(37).fastKey,d=n(55),y=h?"_s":"size",v=function(t,e){var n,r=p(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,u){var f=t(function(t,r){a(t,f,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[y]=0,void 0!=r&&c(r,n,t[u],t)});return o(f.prototype,{clear:function(){for(var t=d(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[y]=0},delete:function(t){var n=d(this,e),r=v(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[y]--}return!!r},forEach:function(t){d(this,e);for(var n,r=s(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!v(d(this,e),t)}}),h&&r(f.prototype,"size",{get:function(){return d(this,e)[y]}}),f},def:function(t,e,n){var r,i,o=v(t,e);return o?o.v=n:(t._l=o={i:i=p(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[y]++,"F"!==i&&(t._i[i]=o)),t},getEntry:v,setStrong:function(t,e,n){u(t,e,function(t,n){this._t=d(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?f(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,f(1))},n?"entries":"values",!n,!0),l(e)}}},function(t,e,n){"use strict";var r=n(166),i=n(55);t.exports=n(74)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){"use strict";var r=n(1),i=n(4),o=n(95);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){"use strict";n(9)&&"g"!=/./g.flags&&n(8).f(RegExp.prototype,"flags",{configurable:!0,get:n(78)})},function(t,e,n){"use strict";t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r=n(10),i=n(44),o=n(7);t.exports=[].copyWithin||function(t,e){var n=r(this),s=o(n.length),a=i(t,s),c=i(e,s),u=arguments.length>2?arguments[2]:void 0,f=Math.min((void 0===u?s:i(u,s))-c,s-a),l=1;for(c<a&&a<c+f&&(l=-1,c+=f-1,a+=f-1);f-- >0;)c in n?n[a]=n[c]:delete n[a],a+=l,c+=l;return n}},function(t,e,n){"use strict";var r=n(14),i=n(10),o=n(64),s=n(7);t.exports=function(t,e,n,a,c){r(e);var u=i(t),f=o(u),l=s(u.length),h=c?l-1:0,p=c?-1:1;if(n<2)for(;;){if(h in f){a=f[h],h+=p;break}if(h+=p,c?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;c?h>=0:l>h;h+=p)h in f&&(a=e(a,f[h],h,u));return a}},function(t,e,n){"use strict";var r=n(1);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){"use strict";var r=n(110),i=Math.pow,o=i(2,-52),s=i(2,-23),a=i(2,127)*(2-s),c=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),u=r(t);return i<c?u*(i/c/s+1/o-1/o)*c*s:(n=(e=(1+s/o)*i)-(e-i))>a||n!=n?u*(1/0):u*n}},function(t,e,n){"use strict";t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){"use strict";var r=n(4),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e,n){"use strict";var r=n(24);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},function(t,e,n){"use strict";var r=n(2).parseFloat,i=n(57).trim;t.exports=1/r(n(113)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},function(t,e,n){"use strict";var r=n(2).parseInt,i=n(57).trim,o=n(113),s=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(s.test(n)?16:10))}:r},function(t,e,n){"use strict";t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){"use strict";var r=n(14),i=n(4),o=n(181),s=[].slice,a={};t.exports=Function.bind||function(t){var e=r(this),n=s.call(arguments,1),c=function r(){var i=n.concat(s.call(arguments));return this instanceof r?function(t,e,n){if(!(e in a)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";a[e]=Function("F,a","return new F("+r.join(",")+")")}return a[e](t,n)}(e,i.length,i):o(e,i,t)};return i(e.prototype)&&(c.prototype=e.prototype),c}},function(t,e,n){"use strict";var r=n(45),i=n(82),o=n(63),s=n(10),a=n(64),c=Object.assign;t.exports=!c||n(3)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=c({},t)[n]||Object.keys(c({},e)).join("")!=r})?function(t,e){for(var n=s(t),c=arguments.length,u=1,f=i.f,l=o.f;c>u;)for(var h,p=a(arguments[u++]),d=f?r(p).concat(f(p)):r(p),y=d.length,v=0;y>v;)l.call(p,h=d[v++])&&(n[h]=p[h]);return n}:c},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(21),o=n(42).f,s={}.toString,a="object"==("undefined"==typeof window?"undefined":r(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==s.call(t)?function(t){try{return o(t)}catch(t){return a.slice()}}(t):o(i(t))}},function(t,e,n){"use strict";var r=n(8),i=n(1),o=n(45);t.exports=n(9)?Object.defineProperties:function(t,e){i(t);for(var n,s=o(e),a=s.length,c=0;a>c;)r.f(t,n=s[c++],e[n]);return t}},function(t,e,n){"use strict";var r=n(22),i=n(21),o=n(83)(!1),s=n(117)("IE_PROTO");t.exports=function(t,e){var n,a=i(t),c=0,u=[];for(n in a)n!=s&&r(a,n)&&u.push(n);for(;e.length>c;)r(a,n=e[c++])&&(~o(u,n)||u.push(n));return u}},function(t,e,n){"use strict";e.f=n(5)},function(t,e,n){"use strict";t.exports=!n(9)&&!n(3)(function(){return 7!=Object.defineProperty(n(119)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Marker=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=s(n(205)),o=s(n(202));function s(t){return t&&t.__esModule?t:{default:t}}e.Marker=function(){function t(e,n,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),null==n)n={lifeTime:-1,range:{},cursor:!1,isItME:!1};this.options=n,this.origin=e,this.lifeTime=n.lifeTime,this.time=(new Date).getTime(),this.colorRGB=this.constructor.getColor(this.origin,"rgb"),this.colorRGBLight=this.constructor.getColor(this.origin,"rgba"),this.animal=this.constructor.getPseudoname(this.origin,null),this.pseudoName=this.constructor.getPseudoname(this.origin),this.avatarAdd=!1,this.cursor=n.cursor,this._editor=r,r&&(this._editorContainerID=r._editorContainerID),-1!=this.lifeTime&&(n.isItME?this.addAvatar():this.cursor&&this.addCursor(n.range))}return r(t,[{key:"update",value:function(t,e){this.time=(new Date).getTime();var n=$("#"+this._editorContainerID),r=$("#"+this._editorContainerID+" #"+this.origin);!r.length&&n.length&&this.addAvatar(),this.avatarAdd&&(r.attr("data-toggle","tooltip"),r.attr("title",this.pseudoName)),1==this.cursor&&1==e?this._editor.viewEditor.getModule("cursors").moveCursor(this.origin,t):1==e&&(this.cursor=e,this.addCursor(t))}},{key:"checkIfOutdated",value:function(){var t=(new Date).getTime();this.time;return t-this.time>=this.lifeTime&&(this.cursor&&(this._editor.viewEditor.getModule("cursors").removeCursor(this.origin),this.cursor=!1),this.removeAvatar(),!0)}},{key:"addAvatar",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#users";jQuery("#"+this._editorContainerID+" "+e).append(this.getAvatar());var n=$("#"+this._editorContainerID+" #"+this.origin);n.attr("data-toggle","tooltip"),n.attr("title",this.pseudoName),this.avatarAdd=!0,this.options.isItME||(this.timer=setInterval(function(){return t.checkIfOutdated()},1e3))}},{key:"getAvatar",value:function(){return'<div id="'+this.origin+'"style="background-color:'+this.colorRGB+';"><img class="imageuser" src="./icons/'+this.animal+'.png" alt="'+this.pseudoName+'"></div>'}},{key:"removeAvatar",value:function(){$("#"+this._editorContainerID+" #"+this.origin).remove(),this.avatarAdd=!1,clearInterval(this.timer)}},{key:"setPseudo",value:function(t){this.pseudoName=t;var e=$("#"+this._editorContainerID+" #"+this.origin);e.length&&e.attr("title",this.pseudoName)}},{key:"addCursor",value:function(t){this.cursor=!0,this._editor.viewEditor.getModule("cursors").setCursor(this.origin,t,this.pseudoName,this.colorRGB)}}],[{key:"capitalize",value:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},{key:"getColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgb",n=(0,o.default)(t)%206,r=7*n%206,i=11*n%206,s=Math.floor(n+50)+", "+Math.floor(r+50)+", "+Math.floor(i+50);return"rgb"===e?"rgb("+s+")":"rgba"===e?"rgba("+s+")":s}},{key:"getPseudoname",value:function(t){return"Anonymous"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Anonymous")?"Anonymous "+this.capitalize(i.default.words[(0,o.default)(t)%i.default.words.length]):i.default.words[(0,o.default)(t)%i.default.words.length]}},{key:"getAvatar",value:function(t){return'<div id="'+t+'"style="background-color:'+this.getColor(t,"rgb")+';"><img class="imageuser" src="./icons/'+this.getPseudoname(t,null)+'.png" alt="'+this.getPseudoname(t)+'"></div>'}}]),t}()},function(t,e,n){"use strict";(function(r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(206)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(15))},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};"object"!==("undefined"==typeof JSON?"undefined":_typeof(JSON))&&(JSON={}),function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(t){return t<10?"0"+t:t}function this_value(){return this.valueOf()}function quote(t){return rx_escapable.lastIndex=0,rx_escapable.test(t)?'"'+t.replace(rx_escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,i,o,s,a=gap,c=e[t];switch(c&&"object"===(void 0===c?"undefined":_typeof(c))&&"function"==typeof c.toJSON&&(c=c.toJSON(t)),"function"==typeof rep&&(c=rep.call(e,t,c)),void 0===c?"undefined":_typeof(c)){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(o=c.length,n=0;n<o;n+=1)s[n]=str(n,c)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,i}if(rep&&"object"===(void 0===rep?"undefined":_typeof(rep)))for(o=rep.length,n=0;n<o;n+=1)"string"==typeof rep[n]&&(i=str(r=rep[n],c))&&s.push(quote(r)+(gap?": ":":")+i);else for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(i=str(r,c))&&s.push(quote(r)+(gap?": ":":")+i);return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!==(void 0===e?"undefined":_typeof(e))||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(t,e){var n,r,i=t[e];if(i&&"object"===(void 0===i?"undefined":_typeof(i)))for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(void 0!==(r=walk(i,n))?i[n]=r:delete i[n]);return reviver.call(t,e,i)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},function(t,e,n){"use strict";t.exports=function(){return n(191),{}}},function(t,e,n){"use strict";t.exports={name:"memoryStorage",read:function(t){return r[t]},write:function(t,e){r[t]=e},each:function(t){for(var e in r)r.hasOwnProperty(e)&&t(r[e],e)},remove:function(t){delete r[t]},clearAll:function(t){r={}}};var r={}},function(t,e,n){"use strict";var r=n(48).Global;function i(){return r.sessionStorage}function o(t){return i().getItem(t)}t.exports={name:"sessionStorage",read:o,write:function(t,e){return i().setItem(t,e)},each:function(t){for(var e=i().length-1;e>=0;e--){var n=i().key(e);t(o(n),n)}},remove:function(t){return i().removeItem(t)},clearAll:function(){return i().clear()}}},function(t,e,n){"use strict";var r=n(48),i=r.Global,o=r.trim;t.exports={name:"cookieStorage",read:function(t){if(!t||!u(t))return null;var e="(?:^|.*;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(s.cookie.replace(new RegExp(e),"$1"))},write:function(t,e){if(!t)return;s.cookie=escape(t)+"="+escape(e)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},each:a,remove:c,clearAll:function(){a(function(t,e){c(e)})}};var s=i.document;function a(t){for(var e=s.cookie.split(/; ?/g),n=e.length-1;n>=0;n--)if(o(e[n])){var r=e[n].split("="),i=unescape(r[0]);t(unescape(r[1]),i)}}function c(t){t&&u(t)&&(s.cookie=escape(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function u(t){return new RegExp("(?:^|;\\s*)"+escape(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(s.cookie)}},function(t,e,n){"use strict";var r=n(48).Global;t.exports={name:"oldIE-userDataStorage",write:function(t,e){if(a)return;var n=u(t);s(function(t){t.setAttribute(n,e),t.save(i)})},read:function(t){if(a)return;var e=u(t),n=null;return s(function(t){n=t.getAttribute(e)}),n},each:function(t){s(function(e){for(var n=e.XMLDocument.documentElement.attributes,r=n.length-1;r>=0;r--){var i=n[r];t(e.getAttribute(i.name),i.name)}})},remove:function(t){var e=u(t);s(function(t){t.removeAttribute(e),t.save(i)})},clearAll:function(){s(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(i);for(var n=e.length-1;n>=0;n--)t.removeAttribute(e[n].name);t.save(i)})}};var i="storejs",o=r.document,s=function(){if(!o||!o.documentElement||!o.documentElement.addBehavior)return null;var t,e,n;try{(e=new ActiveXObject("htmlfile")).open(),e.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),e.close(),t=e.w.frames[0].document,n=t.createElement("div")}catch(e){n=o.createElement("div"),t=o.body}return function(e){var r=[].slice.call(arguments,0);r.unshift(n),t.appendChild(n),n.addBehavior("#default#userData"),n.load(i),e.apply(this,r),t.removeChild(n)}}(),a=(r.navigator?r.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);var c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function u(t){return t.replace(/^\d/,"___$&").replace(c,"___")}},function(t,e,n){"use strict";var r=n(48).Global;t.exports={name:"oldFF-globalStorage",read:function(t){return i[t]},write:function(t,e){i[t]=e},each:o,remove:function(t){return i.removeItem(t)},clearAll:function(){o(function(t,e){delete i[t]})}};var i=r.globalStorage;function o(t){for(var e=i.length-1;e>=0;e--){var n=i.key(e);t(i[n],n)}}},function(t,e,n){"use strict";var r=n(48).Global;function i(){return r.localStorage}function o(t){return i().getItem(t)}t.exports={name:"localStorage",read:o,write:function(t,e){return i().setItem(t,e)},each:function(t){for(var e=i().length-1;e>=0;e--){var n=i().key(e);t(o(n),n)}},remove:function(t){return i().removeItem(t)},clearAll:function(){return i().clear()}}},function(t,e,n){"use strict";t.exports=[n(198),n(197),n(196),n(195),n(194),n(193)]},function(t,e,n){"use strict";var r=n(48),i=r.slice,o=r.pluck,s=r.each,a=r.bind,c=r.create,u=r.isList,f=r.isFunction,l=r.isObject;t.exports={createStore:p};var h={version:"2.0.12",enabled:!1,get:function(t,e){var n=this.storage.read(this._namespacePrefix+t);return this._deserialize(n,e)},set:function(t,e){return void 0===e?this.remove(t):(this.storage.write(this._namespacePrefix+t,this._serialize(e)),e)},remove:function(t){this.storage.remove(this._namespacePrefix+t)},each:function(t){var e=this;this.storage.each(function(n,r){t.call(e,e._deserialize(n),(r||"").replace(e._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(t){return this._namespacePrefix=="__storejs_"+t+"_"},createStore:function(){return p.apply(this,arguments)},addPlugin:function(t){this._addPlugin(t)},namespace:function(t){return p(this.storage,this.plugins,t)}};function p(t,e,n){n||(n=""),t&&!u(t)&&(t=[t]),e&&!u(e)&&(e=[e]);var r=n?"__storejs_"+n+"_":"",p=n?new RegExp("^"+r):null;if(!/^[a-zA-Z0-9_\-]*$/.test(n))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var d=c({_namespacePrefix:r,_namespaceRegexp:p,_testStorage:function(t){try{var e="__storejs__test__";t.write(e,e);var n=t.read(e)===e;return t.remove(e),n}catch(t){return!1}},_assignPluginFnProp:function(t,e){var n=this[e];this[e]=function(){var e=i(arguments,0),r=this;var o=[function(){if(n)return s(arguments,function(t,n){e[n]=t}),n.apply(r,e)}].concat(e);return t.apply(r,o)}},_serialize:function(t){return JSON.stringify(t)},_deserialize:function(t,e){if(!t)return e;var n="";try{n=JSON.parse(t)}catch(e){n=t}return void 0!==n?n:e},_addStorage:function(t){this.enabled||this._testStorage(t)&&(this.storage=t,this.enabled=!0)},_addPlugin:function(t){var e=this;if(u(t))s(t,function(t){e._addPlugin(t)});else if(!o(this.plugins,function(e){return t===e})){if(this.plugins.push(t),!f(t))throw new Error("Plugins must be function values that return objects");var n=t.call(this);if(!l(n))throw new Error("Plugins must return an object of function properties");s(n,function(n,r){if(!f(n))throw new Error("Bad plugin property: "+r+" from plugin "+t.name+". Plugins should only return functions.");e._assignPluginFnProp(n,r)})}},addStorage:function(t){!function(){var t="undefined"==typeof console?null:console;t&&(t.warn?t.warn:t.log).apply(t,arguments)}("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(t)}},h,{plugins:[]});return d.raw={},s(d,function(t,e){f(t)&&(d.raw[e]=a(d,t))}),s(t,function(t){d._addStorage(t)}),s(e,function(t){d._addPlugin(t)}),d}},function(t,e,n){"use strict";var r=n(200),i=n(199),o=[n(192)];t.exports=r.createStore(i,o)},function(t,e,n){"use strict";t.exports=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0}},function(t,e,n){"use strict";
/*!
	unique-random
	Generate random numbers that are consecutively unique
	https://github.com/sindresorhus/unique-random
	by Sindre Sorhus
	MIT License
*/
/*!
	unique-random
	Generate random numbers that are consecutively unique
	https://github.com/sindresorhus/unique-random
	by Sindre Sorhus
	MIT License
*/
!function(){function e(t,e){var n;return function r(){var i=Math.floor(Math.random()*(e-t+1)+t);return n=i===n&&t!==e?r():i}}void 0!==t&&t.exports?t.exports=e:window.uniqueRandom=e}()},function(t){t.exports=["Alligator","Anteater","Armadillo","Auroch","Axolotl","Badger","Bat","Beaver","Buffalo","Camel","Capybara","Chameleon","Cheetah","Chinchilla","Chipmunk","Chupacabra","Cormorant","Coyote","Crow","Dingo","Dinosaur","Dolphin","Duck","Elephant","Ferret","Fox","Frog","Giraffe","Gopher","Grizzly","Hedgehog","Hippo","Hyena","Ibex","Ifrit","Iguana","Jackal","Kangaroo","Koala","Kraken","Lemur","Leopard","Liger","Llama","Manatee","Mink","Monkey","Moose","Narwhal","Nyan Cat","Orangutan","Otter","Panda","Penguin","Platypus","Pumpkin","Python","Quagga","Rabbit","Raccoon","Rhino","Sheep","Shrew","Skunk","Squirrel","Tiger","Turtle","Walrus","Wolf","Wolverine","Wombat"]},function(t,e,n){"use strict";var r=n(204),i=n(203)(0,r.length-1);t.exports=function(){return r[i()]},t.exports.words=r},function(t,e,n){"use strict";var r;function i(t){function n(){if(n.enabled){var t=n,i=+new Date,o=i-(r||i);t.diff=o,t.prev=r,t.curr=i,r=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(t,o),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s),(n.log||e.log||console.log.bind(console)).apply(t,s)}}return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),"function"==typeof e.init&&e.init(n),n}(e=t.exports=i.debug=i.default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(53),e.names=[],e.skips=[],e.formatters={}},function(t,e,n){"use strict";
/*!
 * \brief object that represents the result of an insert operation
 * \param insert the result of the local insert operation
 * \param origin the origin of the insertion
 */
function r(t,e){this.type="MInsertOperation",this.insert=t,this.origin=e}Object.defineProperty(e,"__esModule",{value:!0}),e.MInsertOperation=r,e.MAEInsertOperation=function(t,e){this.type="MAEInsertOperation",this.payload=new r(t,e),this.id={e:e},this.isReady=null},e.MRemoveOperation=
/*!
 * \brief object that represents the result of a delete operation
 * \param remove the result of the local delete operation
 * \param origin the origin of the removal
 */
function(t,e){this.type="MRemoveOperation",this.remove=t,this.origin=e},e.MCaretMovedOperation=
/*!
 * \brief object that represents the result of a caretMoved Operation
 * \param range the selection range
 * \param origin the origin of the selection
 */
function(t,e){this.type="MCaretMovedOperation",this.range=t,this.origin=e},e.MBroadcast=
/*!
 * \brief message containing data to broadcast
 * \param name the name of the protocol, default 'causal'
 * \param id the identifier of the broadcast message
 * \param isReady the identifier(s) that must exist to deliver this message
 * \param payload the broadcasted data
 */
function(t,e,n,r){this.protocol=t,this.id=e,this.isReady=n,this.payload=r},e.MAntiEntropyRequest=
/*!
 * \brief message that request an AntiEntropy 
 * \param causality the causality structure
 */
function(t){this.type="MAntiEntropyRequest",this.causality=t},e.MAntiEntropyResponse=
/*!
 * \brief message responding to the AntiEntropy request
 * \param id the identifier of the response message
 * \param causality the causality structure
 * \param nbElements the number of element to send
 * \param element each element to send 
 */
function(t,e,n,r){this.type="MAntiEntropyResponse",this.id=t,this.causality=e,this.nbElements=n,this.element=r,this.elements=[]}},function(t,e,n){"use strict";t.exports=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=e,this.size=n}},function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=209},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(122),o=n(121),s=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._base=e,this._boundary=n}return r(t,[{key:"bPlus",value:function(t,e,n,r,o,s){for(var a=t,c=e,u=Math.min(this._boundary,r),f=i.int2bigInt(0,this._base.getSumBit(n)),l=void 0,h=0;h<=n;++h)l=t&&t.t.p||0,i.addInt_(f,l),h!==n&&i.leftShift_(f,this._base.getBitBase(h+1)),t=t&&!t.isLeaf&&t.child||null;return i.addInt_(f,Math.floor(Math.random()*u+1)),this._getSC(f,a,c,n,o,s)}},{key:"bMinus",value:function(t,e,n,r,o,s){for(var a=t,c=e,u=Math.min(this._boundary,r),f=i.int2bigInt(0,this._base.getSumBit(n)),l=!1,h=!0,p=void 0,d=void 0,y=0;y<=n;++y)p=t&&t.t.p||0,d=e&&e.t.p||0,h&&p!==d&&(h=!1,l=p>d),l&&(d=Math.pow(2,this._base.getBitBase(y))-1),i.addInt_(f,d),y!==n&&i.leftShift_(f,this._base.getBitBase(y+1)),e=e&&!e.isLeaf&&e.child||null,t=t&&!t.isLeaf&&t.child||null;return l?i.addInt_(f,-Math.floor(Math.random()*u)):i.addInt_(f,-Math.floor(Math.random()*u)-1),this._getSC(f,a,c,n,o,s)}},{key:"_getSC",value:function(t,e,n,r,s,a){for(var c=[],u=[],f=0,l=this._base.getSumBit(r),h=void 0,p=void 0;f<=r;)h=i.dup(t),i.rightShift_(h,l-this._base.getSumBit(f)),p=i.modInt(h,Math.pow(2,this._base.getBitBase(f))),c[f]=s,u[f]=a,n&&n.t.p===p&&(c[f]=n.t.s,u[f]=n.t.c),e&&e.t.p===p&&(c[f]=e.t.s,u[f]=e.t.c),n=n&&!n.isLeaf&&n.child||null,e=e&&!e.isLeaf&&e.child||null,++f;return new o(this._base,t,c,u)}}]),t}();t.exports=s},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._b=e}return r(t,[{key:"getBitBase",value:function(t){return this._b+t}},{key:"getSumBit",value:function(t){var e=this.getBitBase(t),n=this._b-1;return e*(e+1)/2-n*(n+1)/2}},{key:"getInterval",value:function(t,e,n){for(var r=0,i=0,o=!1,s=!0,a=0,c=0;i<=t;)a=e&&e.t.p||0,c=n&&n.t.p||0,s&&a!==c&&(s=!1,o=a>c),o&&(c=Math.pow(2,this.getBitBase(i))-1),r+=s||o||i!==t?c-a:c-a-1,i!==t&&(r*=Math.pow(2,this.getBitBase(i+1))),e=e&&e.child||null,n=n&&n.child||null,++i;return r}}]),t}();t.exports=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(11),o=n(211),s=n(210),a=n(121),c=n(85),u=n(120),f=n(208),l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.options=i({boundary:10,base:15},n),this._s=e,this._c=0,this._hash=function(t){return t%2},this._base=new o(this.options.base),this._strategy=new s(this._base,this.options.boundary),this.root=new u,this.root.add(new u([new c(0,0,0)],"")),this.root.add(new u([new c(Math.pow(2,this._base.getBitBase(0))-1,Number.MAX_VALUE,Number.MAX_VALUE)],""))}return r(t,[{key:"get",value:function(t){if(t<0||t>=this.length)throw new f(t,this.length);for(var e=this.root.get(t+1);!e.isLeaf;)e=e.child;return e.e}},{key:"_get",value:function(t){if(t<0||t>=this.length+2)throw new f(t,this.length+2);return this.root.get(t)}},{key:"insert",value:function(t,e){var n=this._get(e),r=this._get(e+1);this._c+=1;var i={elem:t,id:this.alloc(n,r)};return this.applyInsert(i),i}},{key:"remove",value:function(t){var e=this._get(t+1),n=new a(this._base).fromNode(e);return this.applyRemove(e),n}},{key:"alloc",value:function(t,e){for(var n=0,r=0;n<=0;)n=this._base.getInterval(r,t,e),++r;return r-=1,0===this._hash(r)?this._strategy.bPlus(t,e,r,n,this._s,this._c):this._strategy.bMinus(t,e,r,n,this._s,this._c)}},{key:"applyInsert",value:function(t){var e,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=void 0;return i=(n=t.id)&&n._d&&n._s&&n._c&&new a(this._base,n._d,n._s,n._c).toNode(t.elem),i=n&&n.t&&n.children&&u.fromJSON(n)||i,e=this.root.add(i),r?e:e?this.root.indexOf(i):-1}},{key:"applyRemove",value:function(t){var e,n=void 0;return n=t&&t._d&&t._s&&t._c&&new a(this._base,t._d,t._s,t._c).toNode(null),n=t&&t.t&&t.children&&u.fromJSON(t)||n,-1!==(e=this.root.indexOf(n))&&this.root.del(n),e}},{key:"fromJSON",value:function(t){var e=this;this._s=t._s,this._c=t._c,this.options=t.options,this._base=new o(this.options.base),this._boundary=new s(this._base,this.options.boundary);for(var n=function t(n,r){var i=new c(n.t.p,n.t.s,n.t.c);r.push(i),null!==n.e&&e.root.add(new u(r.slice(),n.e));for(var o=0;o<n.children.length;++o)t(n.children[o],r);r.pop()},r=0;r<t.root.children.length;++r)n(t.root.children[r],[]);return this}},{key:"length",get:function(){var t=this.root.subCounter-2;return t=this.root._hasElement&&t+1||t}}]),t}();t.exports=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(12),o=c(n(150)),s=c(n(212)),a=(n(93),n(207));function c(t){return t&&t.__esModule?t:{default:t}}var u=n(190)("crate:crate-core"),f=function(t){function e(t,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.options=n,a.setLastChangesTime(),a._timer=setInterval(function(){return a.checkIfOutdated()},1e3),a._changesTimeOut=n.changesTimeOut||1e4,a._communication=r,a.No_antientropy=i,a.broadcast=a._communication.broadcast,a.No_antientropy.onBroadcast(function(t,e){switch(e.type){case"MCaretMovedOperation":a.remoteCaretMoved(e.range,e.origin);break;case"Mping":a.ping(e.origin,e.pseudo)}}),a._lastSentId=null,a._communication.onBroadcast(function(t,e){switch(e.type){case"MRemoveOperation":a.remoteRemove(e.remove,e.origin);break;case"MInsertOperation":a.remoteInsert(e.insert,e.origin);break;case"MTitleChanged":a.changeTitle(e.title)}}),a._communication.broadcast.startAntiEntropy(2e3),a._communication.broadcast.on("antiEntropy",function(t,e,n){e=new o.default(null).constructor.fromJSON(e);for(var r=[],i=0;i<n.vector.arr.length;++i){var s=n.vector.arr[i],c=e.vector.indexOf(n.vector.arr[i]),f=1;c>=0&&(f=e.vector.arr[c].v+1);for(var l=f;l<=s.v;++l)s.x.indexOf(l)<0&&r.push({_e:s.e,_c:l});if(c>=0)for(l=0;l<e.vector.arr[c].x.length;++l){var h=e.vector.arr[c].x[l];s.x.indexOf(h)<0&&h<=s.v&&r.push({_e:s.e,_c:h})}}var p=a.getElements(r);0!=p.length&&(u("Receive AntiEntropy And there are differences",t,e,n,p),a._communication.broadcast.sendAntiEntropyResponse(t,n,p),a.emit("sendChangeTitle"))}),a.id=t,a.sequence=new s.default(a.options.editingSessionID),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.EventEmitter),r(e,[{key:"checkIfOutdated",value:function(){var t=(new Date).getTime();this._lastChanges;return t-this._lastChanges>=this._changesTimeOut&&(clearInterval(this._timer),this.emit("outdated"),!0)}
/*!
         * \brief create the core from an existing object
         * \param object the object to initialize the core model of crate containing a 
         * sequence and causality tracking metadata
         */},{key:"init",value:function(t){this.broadcast._causality=this.broadcast._causality.constructor.fromJSON(t.causality);var e=this.broadcast._causality.local;this.No_antientropy.broadcast._causality.local.e=e.e,this.sequence.fromJSON(t.sequence),this.sequence._s=e.e,this.sequence._c=e.v}},{key:"insert",
/*!
         * \brief local insertion of a character inside the sequence structure. It
         * broadcasts the operation to the rest of the network.
         * \param character the character to insert in the sequence
         * \param index the index in the sequence to insert
         * \return the identifier freshly allocated
         */
value:function(t,e){var n=this.sequence.insert(t,e),r=new a.MInsertOperation(n,this.id);try{JSON.parse(JSON.stringify(r))}catch(t){console.error("The object cannot be convert to json ",t,r)}return this._lastSentId=this._communication.sendBroadcast(new a.MInsertOperation(n,this.id),null,this._lastSentId),this.setLastChangesTime(),n}},{key:"remove",
/*!
         * \brief local deletion of a character from the sequence structure. It 
         * broadcasts the operation to the rest of the network.
         * \param index the index of the element to remove
         * \return the identifier freshly removed
         */
value:function(t){var e=this.sequence.remove(t);return this.sequence._c+=1,this._communication.sendBroadcast(new a.MRemoveOperation(e,this.id)),this.setLastChangesTime(),e}},{key:"remoteInsert",
/*!
         * \brief insertion of an element from a remote site. It emits 'remoteInsert' 
         * with the index of the element to insert, -1 if already existing.
         * \param ei the result of the remote insert operation
         * \param origin the origin id of the insert operation
         */
value:function(t,e){var n=this.sequence.applyInsert(t,!1);u("remoteInsert",t," sequence Index ",n),n>=0&&e&&(this.emit("remoteInsert",t.elem,n),this.setLastChangesTime(),t.antientropy||this.emit("remoteCaretMoved",{index:n,length:0},e))}},{key:"remoteRemove",
/*!
         * \brief removal of an element from a remote site.  It emits 'remoteRemove'
         * with the index of the element to remove, -1 if does not exist
         * \param id the result of the remote insert operation
         * \param origin the origin id of the removal
         */
value:function(t,e){var n=this.sequence.applyRemove(t);this.emit("remoteRemove",n),n>=0&&e&&this.emit("remoteCaretMoved",{index:n-1,length:0},e),this.setLastChangesTime()}},{key:"setLastChangesTime",value:function(){var t=(new Date).getTime();this._lastChanges=t}},{key:"remoteCaretMoved",value:function(t,e){this.emit("remoteCaretMoved",t,e)}},{key:"caretMoved",value:function(t){return this.No_antientropy.sendBroadcast(new a.MCaretMovedOperation(t,this.id)),t}},{key:"ping",value:function(t,e){this.emit("ping",t,e)}},{key:"sendPing",value:function(t){return this.No_antientropy.sendBroadcast({type:"Mping",origin:this.id,pseudo:"Anonymous"}),origin}},{key:"changeTitle",value:function(t){this.emit("changeTitle",t)}},{key:"sendChangeTitle",value:function(t){console.log("sendChangeTitle core title ",t),this._communication.sendBroadcast({type:"MTitleChanged",title:t})}},{key:"getElements",
/*!
         * \brief search a set of elements in our sequence and return them
         * \param toSearch the array of elements {_e, _c} to search
         * \returns an array of nodes
         */
value:function(t){for(var e,n,r,i=[],o=this.sequence.length,s=0;t.length>0&&o<=this.sequence.length&&o>0;){for(r=n=this.sequence._get(o);r.children.length>0;)r=r.children[0];for(s=0,e=!1;s<t.length&&!e;)r.t.s===t[s]._e&&r.t.c===t[s]._c?(e=!0,i.push(new a.MAEInsertOperation({elem:r.e,id:n,antientropy:!0},r.t.s.split("-")[0])),t.splice(s,1)):++s;--o}return i.reverse()}}]),e}();
/*!
 * \brief link together all components of the model of the CRATE editor
 * \param id the unique site identifier
 * \param options the webrtc specific options 
 */e.default=f},function(t,e,n){"use strict";(function(e){var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(12),s=n(11),a=n(27),c=n(13)("spa"),u=function(){return{id:a(),initiator:!1,channelConfig:{},channelName:a(),config:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},constraints:{},offerConstraints:{},answerConstraints:{},reconnectTimer:!1,sdpTransform:function(t){return t},stream:!1,streams:[],trickle:!0,wrtc:{},objectMode:!1}},f=new(function(){function t(){i(this,t),this._statistics={message:0},this.manager=new Map,this._options={latency:function(t){setTimeout(t,0)}},c("manager initialized")}return r(t,[{key:"newPeer",value:function(t){c("new peer added. Size:",this.manager.size),this.manager.set(t.id,t)}},{key:"connect",value:function(t,e){c("peer connected from/to: ",t,e),this.manager.get(e)._connectWith(t),this.manager.get(t)._connectWith(e)}},{key:"destroy",value:function(t,e){c("peer disconnected from/to: ",t,e),this.manager.get(t)&&(this.manager.get(t)._close(),this.manager.delete(t)),this.manager.get(e)&&(this.manager.get(e)._close(),this.manager.delete(e))}},{key:"send",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._send(t,e,n,r)}},{key:"_send",value:function(t,e,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{if(!this.manager.has(t)||!this.manager.has(e))throw new Error("need a from and to peer.");this.manager.get(e).emit("data",n),this._statistics.message++}catch(t){throw new Error("cannot send the message. perhaps your destination is not reachable.",t)}}},{key:"stats",get:function(){return this._statistics}}]),t}());t.exports=function(t){function n(t){i(this,n);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return r._manager=f,r._options=s(u(),t),r.id=r._options.id,r.WEBRTC_SUPPORT=!0,r._isNegotiating=!1,r.connected=!1,r.disconnected=!1,r.connectedWith=void 0,r.messageBuffer=[],c("peer initiated:",r.id,r._options.initiator),r._options.initiator&&e.nextTick(function(){r._init()}),r._manager.newPeer(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,o),r(n,[{key:"send",value:function(t){this.connectedWith?(this.messageBuffer.length>0&&this._reviewMessageBuffer(),this.connectedWith?this._send(this.connectedWith,t):this.messageBuffer.push(t)):this.messageBuffer.push(t)}},{key:"destroy",value:function(){this._manager.destroy(this.id,this.connectedWith)}},{key:"signal",value:function(t){"init"===t.type?(this._isNegotiating=!0,c("offer-init received:",t),this.emit("signal",this._createAccept(t))):"accept"===t.type&&(c("offer-accept received:",t),this._connect(t))}},{key:"_error",value:function(t){c(t),this.emit("error",t)}},{key:"_close",value:function(){c("[%s] is closed.",this.id),this.emit("close")}},{key:"_init",value:function(){this._isNegotiating=!0;var t=this._createOffer();this.emit("signal",t)}},{key:"_createOffer",value:function(){return{offerId:a(),type:"init",offer:{initiator:this.id}}}},{key:"_createAccept",value:function(t){var e=this._createOffer();return e.type="accept",e.offerId=t.offerId,e.offer.initiator=t.offer.initiator,e.offer.acceptor=this.id,e}},{key:"_reviewMessageBuffer",value:function(){for(c("Review the buffer: ",this.messageBuffer.length);this.connectedWith&&0!==this.messageBuffer.length;)this._send(this.messageBuffer.pop())}},{key:"_send",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connectedWith,e=arguments[1];if(!t)throw new Error("It must have a destination.");this._manager.send(this.id,t,e)}},{key:"_connect",value:function(t){if(!t.offer.acceptor)throw new Error("It must have an acceptor");this._manager.connect(t.offer.initiator,t.offer.acceptor)}},{key:"_connectWith",value:function(t){this.connected=!0,this._isNegotiating=!1,this.connectedWith=t,this.emit("connect")}}],[{key:"manager",get:function(){return f}}]),n}()}).call(this,n(15))},function(t,e,n){"use strict";t.exports=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.message=n}},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.message=n,this.reason=r}},function(t,e,n){"use strict";t.exports=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MRequestDescriptor"}},function(t,e,n){"use strict";t.exports=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peer=e,this.descriptor=n,this.type="MGiveDescriptor"}},function(t,e,n){"use strict";t.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peers=e,this.type="MRequire"}},function(t,e,n){"use strict";t.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sample=e,this.type="MSuggestBack"}},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peer=e,this.descriptor=n,this.sample=r,this.type="MSuggest"}},function(t,e,n){"use strict";t.exports=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peer=e,this.descriptor=n,this.type="MJoin"}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}var o=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.timeout=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i(Map)),r(e,[{key:"add",value:function(t,e){var n=this;this.set(t,e),setTimeout(function(){n.has(t)&&n.delete(t)},this.timeout)}}]),e}();t.exports=o},function(t,e,n){"use strict";t.exports=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.peer=n}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peer=e,this.ages=[0],this.descriptor=n}return r(t,[{key:"update",value:function(t){this.descriptor=t}},{key:"increment",value:function(){this.ages=this.ages.map(function(t){return t+1})}},{key:"add",value:function(){this.ages.unshift(0)}},{key:"removeOldest",value:function(){return this.ages.pop(),0===this.ages.length}},{key:"removeYoungest",value:function(){return this.ages.shift(),0===this.ages.length}},{key:"oldest",get:function(){return this.ages[this.ages.length-1]}},{key:"count",get:function(){return this.ages.length}}]),t}();t.exports=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}var o=n(225),s=n(224),a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i(Map)),r(e,[{key:"increment",value:function(){this.forEach(function(t,e){t.increment()})}},{key:"addNeighbor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.has(t)?this.get(t).add():this.set(t,new o(t,e))}},{key:"updateNeighbor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.has(t))throw new s("updateNeighbor",t);this.get(t).update(e)}},{key:"removeOldest",value:function(t){if(!this.has(t))throw new s("removeNeighbor",t);this.get(t).removeOldest()&&this.delete(t)}},{key:"removeAllNeighbor",value:function(t){if(this.has(t)){var e=this.get(t).count;return this.delete(t),e}throw new s("removeNeighbor",t)}},{key:"getDescriptor",value:function(t){if(this.has(t))return this.get(t).descriptor;throw new s("getDescriptor",t)}},{key:"oldest",get:function(){if(this.size<=0)throw new s("getOldest");var t=null,e=0;return this.forEach(function(n,r){e<=n.oldest&&(t=n.peer,e=n.oldest)}),t}},{key:"leastFrequent",get:function(){if(this.size<=0)throw new s("getLeastFrequent");var t=[],e=1/0;return this.forEach(function(n,r){n.count<e&&(t=[],e=n.count),n.count===e&&t.push(r)}),t[Math.floor(Math.random()*t.length)]}}]),e}();t.exports=a},function(t,e,n){"use strict";(function(t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=9007199254740991,o="[object Arguments]",s="[object Function]",a="[object GeneratorFunction]",c="[object Map]",u="[object Set]",f=/^\[object .+?Constructor\]$/,l="object"==(void 0===t?"undefined":r(t))&&t&&t.Object===Object&&t,h="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,p=l||h||Function("return this")(),d="object"==r(e)&&e&&!e.nodeType&&e,y=d&&"object"==r(n)&&n&&!n.nodeType&&n,v=y&&y.exports===d;var g,m,b,_=Function.prototype,w=Object.prototype,C=p["__core-js_shared__"],k=(g=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",S=_.toString,E=w.hasOwnProperty,x=w.toString,O=RegExp("^"+S.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=v?p.Buffer:void 0,P=w.propertyIsEnumerable,j=A?A.isBuffer:void 0,T=(m=Object.keys,b=Object,function(t){return m(b(t))}),M=W(p,"DataView"),R=W(p,"Map"),I=W(p,"Promise"),F=W(p,"Set"),N=W(p,"WeakMap"),D=!P.call({valueOf:1},"valueOf"),B=H(M),L=H(R),U=H(I),q=H(F),z=H(N);function V(t){return!(!Z(t)||k&&k in t)&&(X(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?O:f).test(H(t))}function W(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return V(n)?n:void 0}var J=function(t){return x.call(t)};function H(t){if(null!=t){try{return S.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function $(t){return function(t){return function(t){return!!t&&"object"==(void 0===t?"undefined":r(t))}(t)&&Y(t)}(t)&&E.call(t,"callee")&&(!P.call(t,"callee")||x.call(t)==o)}(M&&"[object DataView]"!=J(new M(new ArrayBuffer(1)))||R&&J(new R)!=c||I&&"[object Promise]"!=J(I.resolve())||F&&J(new F)!=u||N&&"[object WeakMap]"!=J(new N))&&(J=function(t){var e=x.call(t),n="[object Object]"==e?t.constructor:void 0,r=n?H(n):void 0;if(r)switch(r){case B:return"[object DataView]";case L:return c;case U:return"[object Promise]";case q:return u;case z:return"[object WeakMap]"}return e});var G=Array.isArray;function Y(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}(t.length)&&!X(t)}var Q=j||function(){return!1};function X(t){var e=Z(t)?x.call(t):"";return e==s||e==a}function Z(t){var e=void 0===t?"undefined":r(t);return!!t&&("object"==e||"function"==e)}n.exports=function(t){if(Y(t)&&(G(t)||"string"==typeof t||"function"==typeof t.splice||Q(t)||$(t)))return!t.length;var e=J(t);if(e==c||e==u)return!t.size;if(D||function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||w)}(t))return!T(t).length;for(var n in t)if(E.call(t,n))return!1;return!0}}).call(this,n(6),n(54)(t))},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pid=e,this.event=n,this.args=r,this.type="MUnicast"}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=1e3,o=60*i,s=60*o,a=24*s,c=365.25*a;function u(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var n,f=void 0===t?"undefined":r(t);if("string"===f&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*c;case"days":case"day":case"d":return n*a;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*o;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(t);if("number"===f&&!1===isNaN(t))return e.long?u(n=t,a,"day")||u(n,s,"hour")||u(n,o,"minute")||u(n,i,"second")||n+" ms":function(t){if(t>=a)return Math.round(t/a)+"d";if(t>=s)return Math.round(t/s)+"h";if(t>=o)return Math.round(t/o)+"m";if(t>=i)return Math.round(t/i)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";var r;function i(t){function n(){if(n.enabled){var t=n,i=+new Date,o=i-(r||i);t.diff=o,t.prev=r,t.curr=i,r=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(t,o),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s),(n.log||e.log||console.log.bind(console)).apply(t,s)}}return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),"function"==typeof e.init&&e.init(n),n}(e=t.exports=i.debug=i.default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(229),e.names=[],e.skips=[],e.formatters={}},function(t,e,n){"use strict";(function(r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(230)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(15))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(231)("unicast-definition"),o=n(12),s=n(11),a=n(228),c=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));r.options=s({retry:0,pid:"default-unicast"},n),r.psp=t;var o=t._receive;return t._receive=function(e,n){try{o.call(t,e,n)}catch(t){if(!n.type||"MUnicast"!==n.type||n.pid!==r.options.pid)throw t;r._emit.apply(r,[n.event].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(n.args)))}},r._emit=r.emit,r.emit=function(e,n){for(var i=arguments.length,o=Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];return t.send(n,new a(r.options.pid,e,o),r.options.retry)},i("just initialized on top of %s@%s.",r.psp.PID,r.psp.PEER),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),r(e,[{key:"destroy",value:function(){this.removeAllListener(),this.emit=this._emit}}]),e}();t.exports=c},function(t,e,n){"use strict";function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,o=i-(n||i);t.diff=o,t.prev=n,t.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(t,o),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s),(r.log||e.log||console.log.bind(console)).apply(t,s)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var o=e.instances[n];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(53),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,n){"use strict";(function(r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(233)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(15))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(234)("tman-wrtc"),o=n(86),s=n(232),a=n(11),c=n(227),u=n(226),f=n(223),l=n(222),h=n(221),p=n(220),d=n(219),y=n(218),v=n(217),g=n(216),m=n(215),b=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a({pid:"tman-wrtc",delta:6e4,timeout:12e4,descriptorTimeout:1e4,retry:5,inview:n&&n.NI,outview:n&&n.NO,descriptor:{x:Math.random()},ranking:function(t){return function(e,n){var r=n.descriptor.x-t.descriptor.x,i=e.descriptor.x-t.descriptor.x;return Math.abs(i)-Math.abs(r)}}},t)));return i("[%s] Initalized with ==> %s ==>",r.PID,r.PEER),r.partialView=new u,r.cache=new f(r.options.timeout),r.state="disconnected",r.periodic=null,r.on("receive",function(t,e){return r._receive(t,e)}),r.on("open",function(t){r._open(t),r._updateState()}),r.on("close",function(t){r._close(t),r._updateState()}),r.on("fail",function(t){r._onArcDown(t),r._updateState()}),r.parent=n||null,r.parent&&(r.unicast=new s(r.parent,{pid:"tman-wrtc-unicast",retry:r.options.retry}),r.parent.on("open",function(t){return!r.cache.has(t)&&r.unicast.emit("requestDescriptor",t,r.getOutviewId()).catch(function(t){console.error(t)})}),r.unicast.on("requestDescriptor",function(t){return r.unicast.emit("giveDescriptor",t,r.getInviewId(),r.options.descriptor).catch(function(t){console.error(t)})}),r.unicast.on("giveDescriptor",function(t,e){r.cache.has(t)||(i("[%s] get %s's descriptor from %s.",r.PID,t,r.parent.PID),r.cache.add(t,e))})),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),r(e,[{key:"join",value:function(t){var e=this;this.parent&&this.parent.join(t);var n=new Promise(function(t,n){"disconnected"!==e.state&&n(new m("join","Already connected."));var r=setTimeout(function(){n(new m("join","Timeout exceeded."))},e.options.timeout);e.once("open",function(i){e.send(i,new l(e.getInviewId(),e.options.descriptor),e.options.retry).then(function(){clearTimeout(r),e._start(),t(i)}).catch(function(){n(new m("join","Could not notify contact."))})})});return this.connect(t),n}},{key:"_onJoin",value:function(t,e){if(this.partialView.size>0){i("[%s] %s ===> join %s; %s neigbhors ===> %s",this.PID,t,this.PEER,this.partialView.size,t);var n=[];this.partialView.forEach(function(t){n.push({peer:t.peer,descriptor:t.descriptor})}),n.push({peer:this.getInviewId(),descriptor:this.options.descriptor}),this.send(t,new p(n),this.options.retry).catch(function(t){console.error(t)})}else i("[%s] %s ===> join %s ===> %s",this.PID,t,this.PEER,t),this.cache.add(e.peer,e.descriptor),this.connect(null,t),this.send(t,new p([{peer:this.getInviewId(),descriptor:this.options.descriptor}]),this.options.retry).catch(function(t){console.error(t)}),this._start()}},{key:"_onArcDown",value:function(t){}},{key:"_onPeerDown",value:function(t){this.partialView.removeAllNeighbor(t)}},{key:"_sampleSize",value:function(t){return Math.min(t.length,2)}},{key:"_partialViewSize",value:function(){return 4}},{key:"_getSample",value:function(t){var e=this,n=[];this.partialView.forEach(function(t,e){t.ages.forEach(function(r){!c(t.descriptor)&&n.push(e)})}),this.parent&&this.parent.partialView.forEach(function(t,r){e.cache.has(r)&&n.indexOf(r)<0&&n.push(r)}),n=n.map(function(n){var r={descriptor:e.options.descriptor};return n===t.peer?r.peer=e.getInviewId():(r.descriptor=e.cache.has(n)&&e.cache.get(n)||e.partialView.getDescriptor(n),r.peer=n),r});var r=this._sampleSize(n);return n.sort(this.options.ranking(t)),n.slice(0,r)}},{key:"_exchange",value:function(){var t=this;if(!(this.partialView.size<=0&&this.parent&&this.parent.partialView.size<=0)){this.partialView.increment();var e=void 0,n=void 0,r=!0;if(this.partialView.size>0)e=this.partialView.oldest,n=this._getSample(this.partialView.get(e));else if(this.parent&&this.parent.partialView.size>0){var o=this.parent.getPeers(),s=!1;for(r=!1;!s&&o.length>0;){var a=Math.floor(Math.random()*o.length);this.cache.has(o[a])?(s=!0,e=o[a],n=this._getSample({peer:e,descriptor:this.cache.get(e)})):o.splice(a,1)}}e&&this.send(e,new h(this.getInviewId(),this.options.descriptor,n)).then(function(){i("[%s] %s ==> suggest %s ==> %s",t.PID,t.PEER,n.length,e)}).catch(function(n){i("[%s] %s =X> suggest =X> %s",t.PID,t.PEER,e),r&&t._onPeerDown(e)})}}},{key:"_onExchange",value:function(t,e){var n=this,r=this._getSample(e);this.send(t,new p(r),this.options.retry).then(function(){i("[%s] %s ==> suggest back %s ==> %s",n.PID,n.PEER,r.length,t)}).catch(function(t){}),this._onExchangeBack(t,e)}},{key:"_onExchangeBack",value:function(t,e){var n=this,r=[];this.partialView.forEach(function(t,e){return r.push(t)}),e.sample.forEach(function(t){return r.indexOf(t)<0&&r.push(t)}),r.sort(this.options.ranking(this.options));var o=[];r.slice(0,this._partialViewSize()).forEach(function(t){n.partialView.has(t.peer)||(o.push(t.peer),n.cache.add(t.peer,t.descriptor))}),o.length>0&&(i("[%s] %s wants to keep %s peers.",this.PID,this.PEER,o.length),this.send(t,new d(o),this.options.retry).catch(function(e){i("[%s] %s =X> request descriptors %s =X> %s",n.PID,n.PEER,o.length,t)}));var s=r.slice(this._partialViewSize(),r.length);s.length>0&&this.partialView.size>this._partialViewSize()&&s.forEach(function(t){n.partialView.has(t.peer)&&n.disconnect(t.peer)})}},{key:"_onRequire",value:function(t,e){var n=this;i("[%s] %s requested to be bridged with %s peers",this.PID,t,e.peers.length),e.peers.forEach(function(e){n.connect(t,e)})}},{key:"_receive",value:function(t,e){if(e.type&&"MSuggest"===e.type)this._onExchange(t,e);else if(e.type&&"MSuggestBack"===e.type)this._onExchangeBack(t,e);else if(e.type&&"MRequire"===e.type)this._onRequire(t,e);else if(e.type&&"MJoin"===e.type)this._onJoin(t,e);else if(e.type&&"MGiveDescriptor"===e.type)this.emit(this.PID+"-"+t,e);else{if(!e.type||"MRequestDescriptor"!==e.type)throw new g("_receive",e,"unhandled");this._onRequestDescriptor(t,e)}}},{key:"_start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.delta;this.periodic=setInterval(function(){return t._exchange()},e)}},{key:"_stop",value:function(){this.periodic&&clearInterval(this.periodic)}},{key:"_requestDescriptor",value:function(t){var e=this;return new Promise(function(n,r){var i=null;e.send(t,new v,e.options.retry).then(function(){i=setTimeout(function(){e.removeAllListeners(e.PID+"-"+t),r(new Error("timeout"))},e.options.descriptorTimeout)}).catch(function(t){r(t)}),e.once(e.PID+"-"+t,function(t){clearTimeout(i),e.cache.add(t.peer,t.descriptor),n()})})}},{key:"_onRequestDescriptor",value:function(t,e){var n=this;this.send(t,new y(this.getInviewId(),this.options.descriptor),this.options.retry).catch(function(e){return i("[%s] %s =X> give descriptor =X> %s",n.PID,n.PEER,t)})}},{key:"_open",value:function(t){var e=this;i("[%s] %s ===> %s",this.PID,this.PEER,t),this.partialView.has(t)?this.disconnect(t):this.cache.has(t)?this._keep(t):this._requestDescriptor(t).then(function(){e.partialView.has(t)?e.disconnect(t):e._keep(t)}).catch(function(n){e.disconnect(t)})}},{key:"_keep",value:function(t){var e=this,n=[];this.partialView.forEach(function(t,e){return n.push(t)}),n.push({peer:t,descriptor:this.cache.get(t)}),n.sort(this.options.ranking(this.options));n.slice(0,this._partialViewSize());n.splice(0,this._partialViewSize()),(0===n.length||n.indexOf(t)<0)&&this.partialView.addNeighbor(t,this.cache.get(t)),n.forEach(function(t){return e.disconnect(t.peer)})}},{key:"_close",value:function(t){i("[%s] %s =†=> %s",this.PID,this.PEER,t),this.partialView.has(t)&&this.partialView.removeOldest(t)}},{key:"_updateState",value:function(){var t=this.state;this.i.size>0&&this.o.size>0&&"connected"!==t?this.state="connected":this.i.size>0&&this.o.size<=0||this.o.size>0&&this.i.size<=0&&"partially connected"!==t?this.state="partially connected":this.i.size<=0&&this.o.size<=0&&"disconnected"!==t&&(this.state="disconnected"),t!==this.state&&this.emit("statechange",this.state)}},{key:"getPeers",value:function(t){var e=[];if(void 0===t)this.partialView.forEach(function(t,n){return e.push(n)});else{var n=[];for(this.partialView.forEach(function(t,e){return n.push(e)});e.length<t&&n.length>0;){var r=Math.floor(Math.random()*n.length);e.push(n[r]),n.splice(r,1)}var o=[];for(this.i.forEach(function(t,e){return o.push(e)});e.length<t&&o.length>0;){var s=Math.floor(Math.random()*o.length);e.push(o[s]),o.splice(s,1)}}return i("[%s] %s provides %s peers",this.PID,this.PEER,e.length),e}}]),e}();t.exports=b},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(59),o=n(235),s=n(11),a=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n.manager=t;var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n));return r._manager=t,r._rps.parent.once("open",function(){console.log("SON connected"),r._rps._start()}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"_buildRPS",value:function(t){this.options=s({config:t.webrtc},t);var e=s({descriptor:this._startDescriptor(),descriptorTimeout:this._descriptorTimeout(),ranking:this._rankingFunction()},this.options);return new o(e,t.manager._rps._network._rps)}},{key:"_startDescriptor",value:function(){throw new Error("A valid TMan based overlay must implement a _descriptor method to generate a base descriptor")}},{key:"_descriptorTimeout",value:function(){throw new Error("A valid TMan based overlay must implement a _descriptorTimeout method to give the timeout on descriptors")}},{key:"_rankPeers",value:function(t,e,n,r,i){throw new Error("A valid TMan based overlay must implement a _rankPeers method to rank two peersvariable: "+t.toString()+e.toString()+n.toString()+r.toString()+i.toString())}},{key:"_rankingFunction",value:function(){var t=this;return function(e){return function(n,r){return t._rankPeers(e,n.descriptor,r.descriptor,n,r)}}}},{key:"getNeighbours",value:function(t){return this.rps.getPeers(t)}},{key:"inviewId",get:function(){return this.rps.getInviewId()}},{key:"outviewId",get:function(){return this.rps.getOutviewId()}},{key:"descriptor",get:function(){return this._rps.options.descriptor},set:function(t){this._rps.options.descriptor=t}}]),e}();t.exports=a},function(t,e,n){"use strict";var r=n(59),i=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));if(!t.manager)throw new SyntaxError("Need the manager to access to other networks.");return n.manager=t.manager,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),e}();t.exports=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._callback=e}return r(t,[{key:"apply",value:function(t){t.prototype._init=this._callback}}]),t}();t.exports=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(123),o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"buildService",value:function(t){var e=this.methodName,n=this.beforeSendName,r=this.afterSendName;t.prototype[e]=function(t){n in this&&(t=this[n](t));var i={protocol:this._name,method:e,payload:t};this._sendBroadcast(i),r in this&&this[r](t)}}}]),e}();t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(123),o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"buildService",value:function(t){var e=this.methodName,n=this.beforeSendName,r=this.afterSendName;t.prototype[e]=function(t,i){var o=this;return n in o&&(i=o[n](i)),new Promise(function(n,s){var a={protocol:o._name,method:e,payload:i};o._sendUnicast(t,a,n,s),r in o&&o[r](i)})}}}]),e}();t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=n(240),s=n(239),a=function(t){function e(){return i(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Error),e}(),c=function(){function t(e){i(this,t),this._serviceName=e,this._builder=null,this._handler=null,this._beforeHooks={send:[],receive:[]},this._afterHooks={send:[],receive:[]}}return r(t,[{key:"apply",value:function(t){if(!this._validate())throw new a("");this._builder.buildService(t),this._builder.buildHandler(t,this._handler),this._builder.buildBeforeHooks(t,this._beforeHooks),this._builder.buildAfterHooks(t,this._afterHooks)}},{key:"_validate",value:function(){return null!==this._type&&null!==this._handler}},{key:"is",get:function(){var t=this;return{unicast:function(){t._builder=new o(t._serviceName)},broadcast:function(){t._builder=new s(t._serviceName)}}}},{key:"on",get:function(){var t=this;return{receive:function(e){t._handler=e}}}},{key:"before",get:function(){var t=this;return{send:function(e){return t._beforeHooks.send.push(e)},receive:function(e){return t._beforeHooks.receive.push(e)}}}},{key:"after",get:function(){var t=this;return{send:function(e){return t._afterHooks.send.push(e)},receive:function(e){return t._afterHooks.receive.push(e)}}}}]),t}();t.exports=c},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(27),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._waitingAnswers=new Map}return r(t,[{key:"stamp",value:function(t,e,n){var r=i();return this._waitingAnswers.set(r,{resolve:e,reject:n}),Object.assign({answerID:r},t)}},{key:"resolve",value:function(t,e){this._waitingAnswers.has(t)&&(this._waitingAnswers.get(t).resolve(e),this._waitingAnswers.delete(t))}},{key:"reject",value:function(t,e){this._waitingAnswers.has(t)&&(this._waitingAnswers.get(t).reject(e),this._waitingAnswers.delete(t))}}]),t}();t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(242),o=n(124),s=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._foglet=n,this._answerQueue=new i,this._initHandlers(),"_init"in this){for(var r=arguments.length,o=Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];this._init.apply(this,o)}}return r(t,[{key:"_sendUnicast",value:function(t,e,n,r){this._foglet.sendUnicast(t,this._answerQueue.stamp(e,n,r))}},{key:"_sendBroadcast",value:function(t){this._foglet.sendBroadcast(t)}},{key:"_answerReply",value:function(t,e){this._answerQueue.resolve(e.answerID,e.value)}},{key:"_answerReject",value:function(t,e){this._answerQueue.reject(e.answerID,e.value)}},{key:"_initHandlers",value:function(){var t=this;this._foglet.onUnicast(function(e,n){return t._handleUnicast(e,n)}),this._foglet.onBroadcast(function(e,n){return t._handleBroadcast(e,n)})}},{key:"_handleUnicast",value:function(t,e){var n=this,r=o.handlerName(e.method);if(this._name===e.protocol&&r in this){var i=o.beforeReceiveName(e.method);if(i in this&&(e.payload=this[i](e.payload)),"answerReply"!==e.method||"answerReject"!==e.method){this[r](t,e.payload,function(r){n._sendUnicast(t,{protocol:n._name,method:"answerReply",payload:{answerID:e.answerID,value:r}})},function(r){n._sendUnicast(t,{protocol:n._name,method:"answerReject",payload:{answerID:e.answerID,value:r}})})}else this[r](t,e.payload);var s=o.afterReceiveName(e.method);s in this&&this[s](e.payload)}}},{key:"_handleBroadcast",value:function(t,e){var n=o.handlerName(e.method);if(this._name===e.protocol&&n in this){var r=o.beforeReceiveName(e.method);r in this&&(e.payload=this[r](e.payload)),this[n](t,e.payload);var i=o.afterReceiveName(e.method);i in this&&this[i](e.payload)}}}]),t}();t.exports=s},function(t,e,n){"use strict";var r=n(243),i=n(241),o=n(238);t.exports=function(t){return function(e){for(var n=arguments.length,s=Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];var c=void 0,u=function(e){function n(e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(r=n.__proto__||Object.getPrototypeOf(n)).call.apply(r,[this,t,e].concat(o)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,r),n}();return e.map(function(t){return t.trim()}).filter(function(t){return t.length>0}).forEach(function(t,e){"init"===t||"constructor"===t?c=new o(s[e]):(c=new i(t),s[e](c)),c.apply(u)}),u}}},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var EventEmitter=__webpack_require__(12),lmerge=__webpack_require__(11),io=__webpack_require__(141),SshControl=function(_EventEmitter){function SshControl(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,SshControl);var _this=_possibleConstructorReturn(this,(SshControl.__proto__||Object.getPrototypeOf(SshControl)).call(this));return _this.options=lmerge({foglet:void 0,address:"http://localhost:4000/",verbose:!0,origins:"*"},options),_this.signaling=io.connect(_this.options.address,{origins:options.origins}),_this.signaling.emit("join",{id:_this.options.foglet.id}),_this.signaling.on("remoteCommand",function(command){var parsed=void 0;_this.log("remoteCommand",command);try{parsed=eval("("+command+")"),_this.log(parsed),_this.deserialize(parsed.command)(_this.options.foglet)}catch(t){_this.log(t)}}),_this}return _inherits(SshControl,_EventEmitter),_createClass(SshControl,[{key:"deserialize",value:function deserialize(message){return eval("("+message+")")}},{key:"log",value:function(t,e){this.options.verbose&&void 0!==t&&void 0!==e&&this.emit("logs",t,e)}}]),SshControl}(EventEmitter);module.exports=SshControl},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}var o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i(Map)),r(e,[{key:"increment",value:function(){var t=this;this.forEach(function(e,n){t.set(n,e.map(function(t){return t+1}))})}},{key:"add",value:function(t){!this.has(t)&&this.set(t,[]),this.get(t).unshift(0)}},{key:"removeYoungest",value:function(t){if(!this.has(t))throw new Error("removeYoungest, peer not found"+t);this.get(t).shift(),0===this.get(t).length&&this.delete(t)}},{key:"removeOldest",value:function(t){if(!this.has(t))throw new Error("removeOldest, peer not found:"+t);this.get(t).pop(),0===this.get(t).length&&this.delete(t)}},{key:"removeAll",value:function(t){if(!this.has(t))throw new Error("removeAll, peer not found: "+t);var e=this.get(t).length;return this.delete(t),e}},{key:"oldest",get:function(){if(this.size<=0)throw new Error("oldest peer not found");var t=null,e=0;return this.forEach(function(n,r){e<=n[n.length-1]&&(t=r,e=n[n.length-1])}),t}},{key:"leastFrequent",get:function(){var t=[],e=1/0;return this.forEach(function(n,r){n.length<e&&(t=[],e=n.length),n.length===e&&t.push(r)}),t[Math.floor(Math.random()*t.length)]}}]),e}();t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(86),o=n(11),s=n(27),a=n(246),c=n(13)("cyclon");t.exports=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n={pid:"cyclon",peer:s(),maxPeers:5,timeoutnetwork:2e4,timeoutconnection:2e4,retry:5,delta:3e4,timeout:3e4},r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,o(n,t)));return r._partialView=new a,r._periodic=void 0,r.on("receive",function(t,e){return r._receive(t,e)}),r.on("open",function(t){r._open(t)}),r.on("close",function(t){r._close(t)}),r.on("fail",function(t){r._onArcDown(t)}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"join",value:function(t){var e=this;return new Promise(function(n,r){var i=setTimeout(function(){r(new Error("conenction timed out"))},e.options.timeoutconnection);e.once("open",function(t){e.send(t,{type:"MJoin"},e.options.retry).then(function(){clearTimeout(i),e._start(),n(t)}).catch(function(){r(new Error("failed to send a MJoin message after establishing the connection. Please report."))})}),e.connect(t)})}},{key:"_open",value:function(t){c("[%s] %s ===> %s",this.PID,this.PEER,t),this._partialView.has(t)||this._partialView.add(t),this._partialView.size>this.options.maxPeers&&this.disconnect(t)}},{key:"_close",value:function(t){c("[%s] %s =†=> %s",this.PID,this.PEER,t),this._partialView.has(t)&&this._partialView.delete(t)}},{key:"_onJoin",value:function(t){var e=this;this._partialView.size>0?(c("[%s] %s ===> join %s ===> %s neighbors",this.PID,t,this.PEER,this._partialView.size),this._partialView.forEach(function(n,r){e.connect(t,r)})):(c("[%s] %s ===> join %s ===> %s",this.PID,t,this.PEER,t),this.connect(null,t))}},{key:"_onLeave",value:function(t){c("%s: just left the game!",t)}},{key:"_start",value:function(){var t=this;c("[%s] starting periodic shuffling with period=%f",this.PEER,this.options.delta),this._periodic=setInterval(function(){t.exchange()},this.options.delta)}},{key:"_stop",value:function(){clearInterval(this._periodic)}},{key:"_receive",value:function(t,e){if(e.type&&"MExchange"===e.type)this._onExchange(t,e);else if(e.type&&"MExchangeBack"===e.type)this.emit("MExchangeBack-"+e.id,t,e);else if(e.type&&"MJoin"===e.type)this._onJoin(t);else if(e.type&&"MLeave"===e.type)this._onLeave(t);else{if(!e.type||"MBridge"!==e.type)throw new Error("_receive, message unhandled");this._onBridge(e.from,e.to)}}},{key:"_exchange",value:function(){return this.exchange()}},{key:"exchange",value:function(){var t=this;return this.emit("begin-shuffle"),new Promise(function(e,n){0===t._partialView.size&&e(),t._partialView.increment();var r=t._partialView.oldest,i=t._getSample(t.options.maxPeers);t._partialView.removeOldest(r),t._partialView.add(r),i.map(function(e){e.id===r&&(e.id=t.getInviewId(),e.age=0)}),c("[%s] Starting to exchange with %s with a sample of size: %f",t.PEER,r,i.length);var o=s();t.send(r,{type:"MExchange",id:o,from:t.getInviewId(),sample:i},t.options.retry).then(function(){var n=setTimeout(function(){t.removeAllListeners("MExchangeBack-"+o),e()},t.options.timeoutnetwork);t.once("MExchangeBack-"+o,function(o,s){clearTimeout(n);for(var a=s.sample.filter(function(e){return!t._partialView.has(e.id)&&e.id!==r&&e.id!==o}),u=0;u<a.length;u++){var f=a[u];if(t._partialView.size>=t.options.maxPeers){var l=Math.floor(Math.random()*i.length),h=i[l].id;i.splice(l,1),c("[%s] replacing entry %s by %s",t.PEER,h,f.id),t.disconnect(h),t._partialView.removeAll(h)}t.send(o,{type:"MBridge",from:t.getInviewId(),to:f.id},t.options.retry).then(function(){}).catch(function(t){})}e()})}).catch(function(n){console.log("%s Error when sending the sample to %s",t.PEER,r),e()})}).then(function(){return t.emit("end-shuffle"),Promise.resolve()}).catch(function(e){return t.emit("end-shuffle"),Promise.reject(e)})}},{key:"_onExchange",value:function(t,e){var n=this,r=e.sample.slice(0),i=String(e.from),o=this._getSample(this.options.maxPeers);c("[%s] Answer to a an exchange demande with %s with a sample of size: %f",this.PEER,i,o.length),e.type="MExchangeBack",e.sample=o,e.from=this.getInviewId(),this.send(t,e,this.options.retry);for(var s=r.filter(function(t){return!n._partialView.has(t.id)}),a=0;a<s.length;a++){var u=s[a];if(this._partialView.size>=this.options.maxPeers){var f=Math.floor(Math.random()*o.length),l=o[f].id;o.splice(f,1),c("[%s] replacing entry %s by %s",this.PEER,l,u.id),this.disconnect(l),this._partialView.removeAll(l)}this.send(t,{type:"MBridge",from:this.getInviewId(),to:u.id},this.options.retry).then(function(){}).catch(function(t){})}}},{key:"_getSample",value:function(t){var e=[],n=[];this._partialView.forEach(function(t,e){n.push({id:e,age:t[0]})});for(var r=Math.min(n.length,t);e.length<r;){var i=Math.floor(Math.random()*n.length);e.push(n[i]),n.splice(i,1)}return e}},{key:"getPeers",value:function(t){var e=[];if(void 0===t)this._partialView.forEach(function(t,n){e.push(n)});else{var n=[];for(this._partialView.forEach(function(t,e){return n.push(e)});e.length<t&&n.length>0;){var r=Math.floor(Math.random()*n.length);e.push(n[r]),n.splice(r,1)}var i=[];for(this.i.forEach(function(t,e){return i.push(e)});e.length<t&&i.length>0;){var o=Math.floor(Math.random()*i.length);e.push(i[o]),i.splice(o,1)}}return e}},{key:"_onBridge",value:function(t,e){t!==e&&this.connect(t,e)}},{key:"_onArcDown",value:function(t){c("[%s] ONARCDOWN ==> %s =X> %s",this.PID,this.PEER,t||"unknown")}},{key:"partialView",get:function(){return this._partialView}}]),e}()},function(t,e,n){"use strict";t.exports=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.message=n}},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.message=n,this.reason=r}},function(t,e,n){"use strict";t.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.message="Partial view is used as it was not empty, yet it is."}},function(t,e,n){"use strict";t.exports=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MLeave"}},function(t,e,n){"use strict";t.exports=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MJoin"}},function(t,e,n){"use strict";t.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.inview=e,this.type="MExchange"}},function(t,e,n){"use strict";t.exports=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.peer=n}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}var o=n(254),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i(Map)),r(e,[{key:"increment",value:function(){var t=this;this.forEach(function(e,n){t.set(n,e.map(function(t){return t+1}))})}},{key:"add",value:function(t){!this.has(t)&&this.set(t,new Array),this.get(t).unshift(0)}},{key:"removeYoungest",value:function(t){if(!this.has(t))throw new o("removeYoungest",t);this.get(t).shift(),0===this.get(t).length&&this.delete(t)}},{key:"removeOldest",value:function(t){if(!this.has(t))throw new o("removeOldest",t);this.get(t).pop(),0===this.get(t).length&&this.delete(t)}},{key:"removeAll",value:function(t){if(!this.has(t))throw new o("removeAll",t);var e=this.get(t).length;return this.delete(t),e}},{key:"oldest",get:function(){if(this.size<=0)throw new o("oldest");var t=null,e=0;return this.forEach(function(n,r){e<=n[n.length-1]&&(t=r,e=n[n.length-1])}),t}},{key:"leastFrequent",get:function(){var t=[],e=1/0;return this.forEach(function(n,r){n.length<e&&(t=[],e=n.length),n.length===e&&t.push(r)}),t[Math.floor(Math.random()*t.length)]}}]),e}();t.exports=s},function(t,e,n){"use strict";t.exports=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MDirect"}},function(t,e,n){"use strict";t.exports=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.from=e,this.to=n,this.type="MConnectTo"}},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.from=e,this.to=n,this.message=r,this.type="MForwarded"}},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.from=e,this.to=n,this.message=r,this.type="MForwardTo"}},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.entry=n,this.message=r}},function(t,e,n){"use strict";t.exports=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pid=e,this.message="The idenfifier of the registering protocol already exists."}},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peer=e,this.pid=n,this.payload=r,this.type="MSend"}},function(t,e,n){"use strict";t.exports=function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"init";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tid=e,this.peer=n,this.pid=r,this.offer=i,this.type="MRequest",this.offerType=o}},function(t,e,n){"use strict";t.exports=function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"init";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tid=e,this.peer=n,this.pid=r,this.offer=i,this.type="MResponse",this.offerType=o}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peer=e,this.connect=n,this.disconnect=r,this.send=i}return r(t,[{key:"connect",value:function(t,e){this.connect(t,e)}},{key:"disconnect",value:function(t){return this.disconnect(t)}},{key:"send",value:function(t,e,n){return this.send(t,e)}}]),t}();t.exports=i},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peer=e,this.socket=n,this.timeout=r}},function(t,e,n){"use strict";t.exports=function t(e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tid=e,this.peer=n,this.pid=r,this.socket=i,this.successful=!1,this.alreadyExists=!1,this.timeout=o}},function(t,e,n){"use strict";t.exports=function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.source=e,this.peer=n,this.protocolId=r,this.message=i}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.peer=e,this.socket=r,this.protocols=new Map,this.increment(n)}return r(t,[{key:"increment",value:function(t){this.protocols.has(t)||this.protocols.set(t,0),this.protocols.set(t,this.protocols.get(t)+1)}},{key:"decrement",value:function(t){var e=!1;return this.protocols.has(t)&&(this.protocols.set(t,this.protocols.get(t)-1),this.protocols.get(t)<=0&&this.protocols.delete(t),e=!0),e}},{key:"sum",value:function(){var t=0;return this.protocols.forEach(function(e,n){t+=e}),t}}]),t}();t.exports=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(269),o=n(268),s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=new Map}return r(t,[{key:"insert",value:function(t,e,n){if(null===n&&!this.store.has(t))throw new o("arcStore",t,e,"Try to add an arc to a peer that does not exists");if(this.store.has(t))this.store.get(t).increment(e);else{var r=new i(t,e,n);this.store.set(t,r)}}},{key:"remove",value:function(t,e){var n=null;if(!this.store.has(t))throw new o("arcStore",t,e,"Try to remove an arc to a peer that does not exists");if(!this.store.get(t).decrement(e))throw new o("arcStore",t,e,"Try to remove an arc from a protocol that does not have this arc");return this.store.get(t).sum()<=0&&(n=this.store.get(t),this.store.delete(t)),n}},{key:"removeAll",value:function(t){var e=this,n=[];return this.store.forEach(function(r,i){if(r.protocols.has(t))for(var o=r.protocols.get(t),s={peer:r.peer,socket:null,occ:o},a=0;a<o;++a){var c=e.remove(i,t);null!==c&&(s.socket=c.socket,n.push(s))}}),n}},{key:"removePeer",value:function(t){var e=void 0;return this.store.has(t)?(e=this.store.get(t).protocols,this.store.delete(t)):e=new Map,e}},{key:"contains",value:function(t){return this.store.has(t)}},{key:"get",value:function(t){var e=null;return this.contains(t)&&(e=this.store.get(t)),e}}]),t}();t.exports=s},function(t,e,n){"use strict";(function(e,r){var i=n(61).Buffer,o=e.crypto||e.msCrypto;o&&o.getRandomValues?t.exports=function(t,n){if(t>65536)throw new Error("requested too many random bytes");var s=new e.Uint8Array(t);t>0&&o.getRandomValues(s);var a=i.from(s.buffer);if("function"==typeof n)return r.nextTick(function(){n(null,a)});return a}:t.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,n(6),n(15))},function(t,e,n){"use strict";t.exports=function(){if("undefined"==typeof window)return null;var t={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return t.RTCPeerConnection?t:null}},function(t,e,n){"use strict";(function(e){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=u;var i=n(126)("simple-peer"),o=n(272),s=n(52),a=n(271),c=n(90);function u(t){var e=this;if(!(e instanceof u))return new u(t);if(e._id=a(4).toString("hex").slice(0,7),e._debug("new peer %o",t),t=Object.assign({allowHalfOpen:!1},t),c.Duplex.call(e,t),e.channelName=t.initiator?t.channelName||a(20).toString("hex"):null,e._isChromium="undefined"!=typeof window&&!!window.webkitRTCPeerConnection,e.initiator=t.initiator||!1,e.channelConfig=t.channelConfig||u.channelConfig,e.config=t.config||u.config,e.constraints=e._transformConstraints(t.constraints||u.constraints),e.offerConstraints=e._transformConstraints(t.offerConstraints||{}),e.answerConstraints=e._transformConstraints(t.answerConstraints||{}),e.sdpTransform=t.sdpTransform||function(t){return t},e.streams=t.streams||(t.stream?[t.stream]:[]),e.trickle=void 0===t.trickle||t.trickle,e.destroyed=!1,e.connected=!1,e.remoteAddress=void 0,e.remoteFamily=void 0,e.remotePort=void 0,e.localAddress=void 0,e.localPort=void 0,e._wrtc=t.wrtc&&"object"===r(t.wrtc)?t.wrtc:o(),!e._wrtc)throw"undefined"==typeof window?f("No WebRTC support: Specify `opts.wrtc` option in this environment","ERR_WEBRTC_SUPPORT"):f("No WebRTC support: Not a supported browser","ERR_WEBRTC_SUPPORT");e._pcReady=!1,e._channelReady=!1,e._iceComplete=!1,e._channel=null,e._pendingCandidates=[],e._isNegotiating=!1,e._batchedNegotiation=!1,e._queuedNegotiation=!1,e._sendersAwaitingStable=[],e._senderMap=new WeakMap,e._remoteTracks=[],e._remoteStreams=[],e._chunk=null,e._cb=null,e._interval=null,e._pc=new e._wrtc.RTCPeerConnection(e.config,e.constraints),e._isReactNativeWebrtc="number"==typeof e._pc._peerConnectionId,e._pc.oniceconnectionstatechange=function(){e._onIceStateChange()},e._pc.onicegatheringstatechange=function(){e._onIceStateChange()},e._pc.onsignalingstatechange=function(){e._onSignalingStateChange()},e._pc.onicecandidate=function(t){e._onIceCandidate(t)},e.initiator?e._setupData({channel:e._pc.createDataChannel(e.channelName,e.channelConfig)}):e._pc.ondatachannel=function(t){e._setupData(t)},"addTrack"in e._pc&&(e.streams&&e.streams.forEach(function(t){e.addStream(t)}),e._pc.ontrack=function(t){e._onTrack(t)}),e.initiator&&e._needsNegotiation(),e._onFinishBound=function(){e._onFinish()},e.once("finish",e._onFinishBound)}function f(t,e){var n=new Error(t);return n.code=e,n}function l(){}s(u,c.Duplex),u.WEBRTC_SUPPORT=!!o(),u.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},u.constraints={},u.channelConfig={},Object.defineProperty(u.prototype,"bufferSize",{get:function(){return this._channel&&this._channel.bufferedAmount||0}}),u.prototype.address=function(){return{port:this.localPort,family:"IPv4",address:this.localAddress}},u.prototype.signal=function(t){var e=this;if(e.destroyed)throw f("cannot signal after peer is destroyed","ERR_SIGNALING");if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t={}}e._debug("signal()"),t.renegotiate&&(e._debug("got request to renegotiate"),e._needsNegotiation()),t.candidate&&(e._pc.remoteDescription&&e._pc.remoteDescription.type?e._addIceCandidate(t.candidate):e._pendingCandidates.push(t.candidate)),t.sdp&&e._pc.setRemoteDescription(new e._wrtc.RTCSessionDescription(t),function(){e.destroyed||(e._pendingCandidates.forEach(function(t){e._addIceCandidate(t)}),e._pendingCandidates=[],"offer"===e._pc.remoteDescription.type&&e._createAnswer())},function(t){e.destroy(f(t,"ERR_SET_REMOTE_DESCRIPTION"))}),t.sdp||t.candidate||t.renegotiate||e.destroy(f("signal() called with invalid signal data","ERR_SIGNALING"))},u.prototype._addIceCandidate=function(t){var e=this;try{e._pc.addIceCandidate(new e._wrtc.RTCIceCandidate(t),l,function(t){e.destroy(f(t,"ERR_ADD_ICE_CANDIDATE"))})}catch(t){e.destroy(f("error adding candidate: "+t.message,"ERR_ADD_ICE_CANDIDATE"))}},u.prototype.send=function(t){this._channel.send(t)},u.prototype.addStream=function(t){var e=this;e._debug("addStream()"),t.getTracks().forEach(function(n){e.addTrack(n,t)})},u.prototype.addTrack=function(t,e){this._debug("addTrack()");var n=this._pc.addTrack(t,e),r=this._senderMap.get(t)||new WeakMap;r.set(e,n),this._senderMap.set(t,r),this._needsNegotiation()},u.prototype.removeTrack=function(t,e){this._debug("removeSender()");var n=this._senderMap.get(t),r=n?n.get(e):null;r||this.destroy(new Error("Cannot remove track that was never added."));try{this._pc.removeTrack(r)}catch(t){"NS_ERROR_UNEXPECTED"===t.name?this._sendersAwaitingStable.push(r):this.destroy(t)}},u.prototype.removeStream=function(t){var e=this;e._debug("removeSenders()"),t.getTracks().forEach(function(n){e.removeTrack(n,t)})},u.prototype._needsNegotiation=function(){var t=this;t._debug("_needsNegotiation"),t._batchedNegotiation||(t._batchedNegotiation=!0,setTimeout(function(){t._batchedNegotiation=!1,t._debug("starting batched negotiation"),t.negotiate()},0))},u.prototype.negotiate=function(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),this._createOffer()):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0},u.prototype.destroy=function(t){this._destroy(t,function(){})},u.prototype._destroy=function(t,e){if(!this.destroyed){if(this._debug("destroy (error: %s)",t&&(t.message||t)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.destroyed=!0,this.connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(t){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(t){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,"addTrack"in this._pc&&(this._pc.ontrack=null),this._pc.ondatachannel=null}this._pc=null,this._channel=null,t&&this.emit("error",t),this.emit("close"),e()}},u.prototype._setupData=function(t){var e=this;if(!t.channel)return e.destroy(f("Data channel event is missing `channel` property","ERR_DATA_CHANNEL"));e._channel=t.channel,e._channel.binaryType="arraybuffer","number"==typeof e._channel.bufferedAmountLowThreshold&&(e._channel.bufferedAmountLowThreshold=65536),e.channelName=e._channel.label,e._channel.onmessage=function(t){e._onChannelMessage(t)},e._channel.onbufferedamountlow=function(){e._onChannelBufferedAmountLow()},e._channel.onopen=function(){e._onChannelOpen()},e._channel.onclose=function(){e._onChannelClose()},e._channel.onerror=function(t){e.destroy(f(t,"ERR_DATA_CHANNEL"))}},u.prototype._read=function(){},u.prototype._write=function(t,e,n){if(this.destroyed)return n(f("cannot write after peer is destroyed","ERR_DATA_CHANNEL"));if(this.connected){try{this.send(t)}catch(t){return this.destroy(f(t,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>65536?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=t,this._cb=n},u.prototype._onFinish=function(){var t=this;function e(){setTimeout(function(){t.destroy()},1e3)}t.destroyed||(t.connected?e():t.once("connect",e))},u.prototype._createOffer=function(){var t=this;t.destroyed||t._pc.createOffer(function(e){function n(){var n=t._pc.localDescription||e;t._debug("signal"),t.emit("signal",{type:n.type,sdp:n.sdp})}t.destroyed||(e.sdp=t.sdpTransform(e.sdp),t._pc.setLocalDescription(e,function(){if(t._debug("createOffer success"),t.destroyed)return;t.trickle||t._iceComplete?n():t.once("_iceComplete",n)},function(e){t.destroy(f(e,"ERR_SET_LOCAL_DESCRIPTION"))}))},function(e){t.destroy(f(e,"ERR_CREATE_OFFER"))},t.offerConstraints)},u.prototype._createAnswer=function(){var t=this;t.destroyed||t._pc.createAnswer(function(e){function n(){var n=t._pc.localDescription||e;t._debug("signal"),t.emit("signal",{type:n.type,sdp:n.sdp})}t.destroyed||(e.sdp=t.sdpTransform(e.sdp),t._pc.setLocalDescription(e,function(){if(t.destroyed)return;t.trickle||t._iceComplete?n():t.once("_iceComplete",n)},function(e){t.destroy(f(e,"ERR_SET_LOCAL_DESCRIPTION"))}))},function(e){t.destroy(f(e,"ERR_CREATE_ANSWER"))},t.answerConstraints)},u.prototype._onIceStateChange=function(){if(!this.destroyed){var t=this._pc.iceConnectionState,e=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",t,e),this.emit("iceStateChange",t,e),"connected"!==t&&"completed"!==t||(this._pcReady=!0,this._maybeReady()),"failed"===t&&this.destroy(f("Ice connection failed.","ERR_ICE_CONNECTION_FAILURE")),"closed"===t&&this.destroy(new Error("Ice connection closed."))}},u.prototype.getStats=function(t){var e=this;0===e._pc.getStats.length?e._pc.getStats().then(function(e){var n=[];e.forEach(function(t){n.push(t)}),t(null,n)},function(e){t(e)}):e._isReactNativeWebrtc?e._pc.getStats(null,function(e){var n=[];e.forEach(function(t){n.push(t)}),t(null,n)},function(e){t(e)}):e._pc.getStats.length>0?e._pc.getStats(function(n){if(!e.destroyed){var r=[];n.result().forEach(function(t){var e={};t.names().forEach(function(n){e[n]=t.stat(n)}),e.id=t.id,e.type=t.type,e.timestamp=t.timestamp,r.push(e)}),t(null,r)}},function(e){t(e)}):t(null,[])},u.prototype._maybeReady=function(){var t=this;t._debug("maybeReady pc %s channel %s",t._pcReady,t._channelReady),!t.connected&&!t._connecting&&t._pcReady&&t._channelReady&&(t._connecting=!0,function e(){t.destroyed||t.getStats(function(n,r){if(!t.destroyed){n&&(r=[]);var i={},o={},s={},a=!1;if(r.forEach(function(t){"remotecandidate"!==t.type&&"remote-candidate"!==t.type||(i[t.id]=t),"localcandidate"!==t.type&&"local-candidate"!==t.type||(o[t.id]=t),"candidatepair"!==t.type&&"candidate-pair"!==t.type||(s[t.id]=t)}),r.forEach(function(t){"transport"===t.type&&t.selectedCandidatePairId&&u(s[t.selectedCandidatePairId]),("googCandidatePair"===t.type&&"true"===t.googActiveConnection||("candidatepair"===t.type||"candidate-pair"===t.type)&&t.selected)&&u(t)}),a||Object.keys(s).length&&!Object.keys(o).length){if(t._connecting=!1,t.connected=!0,t._chunk){try{t.send(t._chunk)}catch(n){return t.destroy(f(n,"ERR_DATA_CHANNEL"))}t._chunk=null,t._debug('sent chunk from "write before connect"');var c=t._cb;t._cb=null,c(null)}"number"!=typeof t._channel.bufferedAmountLowThreshold&&(t._interval=setInterval(function(){t._onInterval()},150),t._interval.unref&&t._interval.unref()),t._debug("connect"),t.emit("connect")}else setTimeout(e,100)}function u(e){a=!0;var n=o[e.localCandidateId];n&&n.ip?(t.localAddress=n.ip,t.localPort=Number(n.port)):n&&n.ipAddress?(t.localAddress=n.ipAddress,t.localPort=Number(n.portNumber)):"string"==typeof e.googLocalAddress&&(n=e.googLocalAddress.split(":"),t.localAddress=n[0],t.localPort=Number(n[1]));var r=i[e.remoteCandidateId];r&&r.ip?(t.remoteAddress=r.ip,t.remotePort=Number(r.port)):r&&r.ipAddress?(t.remoteAddress=r.ipAddress,t.remotePort=Number(r.portNumber)):"string"==typeof e.googRemoteAddress&&(r=e.googRemoteAddress.split(":"),t.remoteAddress=r[0],t.remotePort=Number(r[1])),t.remoteFamily="IPv4",t._debug("connect local: %s:%s remote: %s:%s",t.localAddress,t.localPort,t.remoteAddress,t.remotePort)}})}())},u.prototype._onInterval=function(){!this._cb||!this._channel||this._channel.bufferedAmount>65536||this._onChannelBufferedAmountLow()},u.prototype._onSignalingStateChange=function(){var t=this;t.destroyed||("stable"===t._pc.signalingState&&(t._isNegotiating=!1,t._debug("flushing sender queue",t._sendersAwaitingStable),t._sendersAwaitingStable.forEach(function(e){t.removeTrack(e),t._queuedNegotiation=!0}),t._sendersAwaitingStable=[],t._queuedNegotiation&&(t._debug("flushing negotiation queue"),t._queuedNegotiation=!1,t._needsNegotiation()),t._debug("negotiate"),t.emit("negotiate")),t._debug("signalingStateChange %s",t._pc.signalingState),t.emit("signalingStateChange",t._pc.signalingState))},u.prototype._onIceCandidate=function(t){this.destroyed||(t.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:t.candidate.candidate,sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid}}):t.candidate||(this._iceComplete=!0,this.emit("_iceComplete")))},u.prototype._onChannelMessage=function(t){if(!this.destroyed){var n=t.data;n instanceof ArrayBuffer&&(n=e.from(n)),this.push(n)}},u.prototype._onChannelBufferedAmountLow=function(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var t=this._cb;this._cb=null,t(null)}},u.prototype._onChannelOpen=function(){this.connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())},u.prototype._onChannelClose=function(){this.destroyed||(this._debug("on channel close"),this.destroy())},u.prototype._onTrack=function(t){var e=this;e.destroyed||t.streams.forEach(function(n){e._debug("on track"),e.emit("track",t.track,n),e._remoteTracks.push({track:t.track,stream:n}),e._remoteStreams.some(function(t){return t.id===n.id})||(e._remoteStreams.push(n),setTimeout(function(){e.emit("stream",n)},0))})},u.prototype._debug=function(){var t=[].slice.call(arguments);t[0]="["+this._id+"] "+t[0],i.apply(null,t)},u.prototype._transformConstraints=function(t){if(0===Object.keys(t).length)return t;if((t.mandatory||t.optional)&&!this._isChromium){var e=Object.assign({},t.optional,t.mandatory);return void 0!==e.OfferToReceiveVideo&&(e.offerToReceiveVideo=e.OfferToReceiveVideo,delete e.OfferToReceiveVideo),void 0!==e.OfferToReceiveAudio&&(e.offerToReceiveAudio=e.OfferToReceiveAudio,delete e.OfferToReceiveAudio),e}return t.mandatory||t.optional||!this._isChromium?t:(void 0!==t.offerToReceiveVideo&&(t.OfferToReceiveVideo=t.offerToReceiveVideo,delete t.offerToReceiveVideo),void 0!==t.offerToReceiveAudio&&(t.OfferToReceiveAudio=t.offerToReceiveAudio,delete t.offerToReceiveAudio),{mandatory:t})}}).call(this,n(67).Buffer)},function(t,e,n){"use strict";function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,o=i-(n||i);t.diff=o,t.prev=n,t.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(t,o),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s),(r.log||e.log||console.log.bind(console)).apply(t,s)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var o=e.instances[n];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(53),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(126)("neighborhood-wrtc"),o=n(11),s=n(27),a=n(273),c=n(270),u=n(267),f=n(266),l=n(265),h=n(264),p=n(263),d=n(262),y=n(261),v=n(260),g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options={socketClass:a,peer:s(),config:{iceServers:[],trickle:!0,initiator:!1},timeout:6e4,pendingTimeout:1e4,encoding:function(t){return JSON.stringify(t)},decoding:function(t){return JSON.parse(t)}},this.options=o(this.options,e),this.encode=this.options.encoding,this.decode=this.options.decoding,this.PEER=this.options.peer,i("[%s] initialized.",this.PEER),this.pending=new Map,this.living=new c,this.dying=new Map,this.protocols=new Map}return r(t,[{key:"register",value:function(t){if(this.protocols.has(t._pid()))throw new y(t._pid());return i("[%s] protocol %s just registered.",this.PEER,t._pid()),this.protocols.set(t._pid(),t),new l(this.PEER,this._connect.bind(this,t._pid()),this._disconnect.bind(this,t._pid()),this._send.bind(this,t._pid()))}},{key:"_connect",value:function(t,e,n){"function"==typeof e&&void 0===n?this._initiate(t,e):"function"==typeof e&&void 0!==n?this._accept(t,e,n):this._finalize(t,e)}},{key:"_initiate",value:function(t,e){var n=this;this.options.config.initiator=!0;var r=new(0,this.options.socketClass)(this.options.config),o=new u(s(),null,t,r);this.pending.set(o.tid,o),r.once("connect",function(){o.successful=!0,n.living.contains(o.peer)?(o.alreadyExists=!0,o.successful=!0,n.living.insert(o.peer,t),i("[%s] --- arc --\x3e %s",n.PEER,o.peer),n.protocols.get(t)._connected(o.peer,!0),o.peer=null):(n.living.insert(o.peer,t,r),i("[%s] --- WebRTC --\x3e %s",n.PEER,o.peer),n.protocols.get(t)._connected(o.peer,!0)),n._checkPendingEntry(o)}),r.once("close",function(){if(null!==o.peer){if(n.living.contains(o.peer))n.living.removePeer(o.peer).forEach(function(t,e){for(var r=0;r<t;++r)n.protocols.get(e)._disconnected(o.peer)});else if(n.dying.has(o.peer)){var t=n.dying.get(o.peer);clearTimeout(t.timeout),n.dying.delete(o.peer)}i("[%s] -‡- WebRTC -‡> %s",n.PEER,o.peer)}else i("[%s] -‡- WebRTC -‡> %s",n.PEER,"unknown");n._checkPendingEntry(o)}),r.on("data",function(t){var e=n.decode(t);n.protocols.get(e.pid)._received(e.peer,e.payload)}),r.on("stream",function(t){n.protocols.get(o.pid)._streamed(o.peer,t)}),r.on("error",function(t){i(t),r.destroy()}),r.on("signal",function(i){r.connected&&r._isNegotiating?e(new p(o.tid,n.PEER,t,i,"renegociate")):e(new p(o.tid,n.PEER,t,i))}),setTimeout(function(){(!o.successful||o.alreadyExists)&&null!==o.socket&&o.socket.destroy(),!o.successful&&n.protocols.get(t)._failed(o.peer,!0),n.pending.delete(o.tid)},this.options.pendingTimeout)}},{key:"_finalize",value:function(t,e){if("renegociate"!==e.offerType){if(this.pending.has(e.tid)){var n=this.pending.get(e.tid);if(n&&(n.alreadyExists||n.successful))return this._checkPendingEntry(n),void i("The socket already exists: ",n.peer);if(this.living.contains(e.peer))n.alreadyExists=!0,n.successful=!0,this.living.insert(e.peer,t),i("[%s] --- arc --\x3e %s",this.PEER,e.peer),this.protocols.get(t)._connected(e.peer,!0),this._checkPendingEntry(n);else if(this.dying.has(e.peer)){n.alreadyExists=!0,n.successful=!0;var r=this.dying.get(e.peer);clearTimeout(r.timeout),this.dying.delete(e.peer),this.living.insert(e.peer,t,r.socket),i("[%s] -¡- arc -¡> %s",this.PEER,e.peer),this.protocols.get(t)._connected(e.peer,!0),this._checkPendingEntry(n)}else{if(n.peer=e.peer,!e.offer)throw new v("_finalize",n,e);n.socket.signal(e.offer)}}}else if(i("[%s] _finalize regenociation:",e),this.living.store.has(e.peer)){var o=this.living.get(e.peer).socket;o.connected&&!o._isNegociating&&o.signal(e.offer)}}},{key:"_accept",value:function(t,e,n){var r=this;if("renegociate"===n.offerType)return i("[%s] _accept regenociation:",n),void(this.living.store.has(n.peer)&&this.living.get(n.peer).socket.signal(n.offer));var o=!1,s=n.tid,a=n.peer;if(!this.pending.has(s)){o=!0;var c=new u(s,a,t);this.pending.set(s,c),setTimeout(function(){(!c.successful||c.alreadyExists)&&c.socket&&c.socket.destroy(),!c.successful&&r.protocols.get(t)._failed(a,!1),r.pending.delete(s)},this.options.pendingTimeout)}var f=this.pending.get(n.tid);if(!f.alreadyExists&&!f.successful)if(this.living.contains(n.peer))f.alreadyExists=!0,f.successful=!0,this.living.insert(n.peer,t),i("[%s] <-- arc --- %s",this.PEER,f.peer),this.protocols.get(t)._connected(n.peer,!1),o&&e(new h(f.tid,this.PEER,t,null)),this._checkPendingEntry(f);else if(this.dying.has(n.peer)){f.alreadyExists=!0,f.successful=!0;var l=this.dying.get(n.peer);clearTimeout(l.timeout),this.dying.delete(n.peer),this.living.insert(n.peer,t,l.socket),i("[%s] <¡- arc -¡- %s",this.PEER,n.peer),this.protocols.get(t)._connected(n.peer,!1),o&&e(new h(f.tid,this.PEER,t,null)),this._checkPendingEntry(f)}else{if(o&&!f.socket){this.options.config.initiator=!1;var p=new(0,this.options.socketClass)(this.options.config);f.socket=p,p.once("connect",function(){f.successful=!0,r.living.contains(f.peer)?(f.alreadyExists=!0,f.successful=!0,r.living.insert(f.peer,t),i("[%s] <-- arc --- %s",r.PEER,f.peer),r.protocols.get(t)._connected(f.peer,!1),f.peer=null):(r.living.insert(f.peer,t,p),i("[%s] <-- WebRTC --- %s",r.PEER,f.peer),r.protocols.get(t)._connected(f.peer,!1)),r._checkPendingEntry(f)}),p.once("close",function(){if(null!==f.peer){if(r.living.contains(f.peer))r.living.removePeer(f.peer).forEach(function(t,e){for(var n=0;n<t;++n)r.protocols.get(e)._disconnected(f.peer)});else if(r.dying.has(f.peer)){var t=r.dying.get(f.peer);clearTimeout(t.timeout),r.dying.delete(f.peer)}i("[%s] <‡- WebRTC -‡- %s",r.PEER,f.peer)}else i("[%s] <‡- WebRTC -‡- %s",r.PEER,"unknown");r._checkPendingEntry(f)}),p.on("data",function(t){var e=r.decode(t);r.protocols.get(e.pid)._received(e.peer,e.payload)}),p.on("stream",function(t){r.protocols.get(f.pid)._streamed(f.peer,t)}),p.on("error",function(t){i(t),p.destroy()}),p.on("signal",function(n){p.connected&&!p._isNegotiating?e(new h(f.tid,r.PEER,t,n,"renegociate")):e(new h(f.tid,r.PEER,t,n))})}f.socket.signal(n.offer)}}},{key:"_disconnect",value:function(t,e){var n=this;if(void 0===e){this.living.removeAll(t).forEach(function(r){if(null!==r.socket){var o=new f(r.peer,r.socket,setTimeout(function(){r.socket&&r.socket.destroy()},n.options.timeout));n.dying.set(o.peer,o)}for(var s=0;s<r.occ;++s)null===r.socket||null!==r.socket&&s<r.occ-1?i("[%s] ††† arc ††† %s",n.PEER,e):i("[%s] ††† WebRTC ††† %s",n.PEER,e),n.protocols.get(t)._disconnected(r.peer)})}else{var r=null;try{r=this.living.remove(e,t)}catch(t){console.log(t)}if(r){var o=new f(r.peer,r.socket,setTimeout(function(){r.socket&&r.socket.destroy()},this.options.timeout));this.dying.set(o.peer,o),i("[%s] ††† WebRTC ††† %s",this.PEER,e)}else i("[%s] ††† arc ††† %s",this.PEER,e);this.protocols.get(t)._disconnected(e)}}},{key:"_send",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new Promise(function(s,a){var c=null;r.living.contains(e)?c=r.living.get(e):r.dying.has(e)&&(c=r.dying.get(e)),null===c&&a(new Error("peer not found: "+e));!function u(f){try{c.socket.send(r.encode(new d(r.PEER,t,n))),i("[%s] --- msg --\x3e %s:%s",r.PEER,e,t),s()}catch(n){i("[%s] -X- msg -X> %s:%s",r.PEER,e,t),f<o?setTimeout(function(){u(f+1)},1e3):a(n)}}(0)})}},{key:"_checkPendingEntry",value:function(t){this.pending.has(t.tid)&&(null===t.peer&&t.socket&&(t.socket.destroy(),t.socket=null),this.pending.delete(t.tid))}}]),t}();t.exports=g},function(t,e,n){"use strict";function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,o=i-(n||i);t.diff=o,t.prev=n,t.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(t,o),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s),(r.log||e.log||console.log.bind(console)).apply(t,s)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var o=e.instances[n];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(53),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,n){"use strict";(function(r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(276)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(15))},function(t,e,n){"use strict";function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,o=i-(n||i);t.diff=o,t.prev=n,t.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(t,o),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s),(r.log||e.log||console.log.bind(console)).apply(t,s)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var o=e.instances[n];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(53),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,n){"use strict";(function(r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(278)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(15))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(279)("spray-wrtc"),o=n(86),s=n(11),a=n(255),c=n(253),u=n(252),f=n(251),l=(n(250),n(249)),h=n(248),p=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s({pid:"spray-wrtc",delta:12e4,timeout:6e4,a:1,b:0,retry:5},t)));return i("[%s] Initalized with ==> %s ==>",n.PID,n.PEER),n.partialView=new a,n.state="disconnected",n.periodic=null,n.on("receive",function(t,e){return n._receive(t,e)}),n.on("open",function(t){n._open(t),n._updateState()}),n.on("close",function(t){n._close(t),n._updateState()}),n.on("fail",function(t){n._onArcDown(t),n._updateState()}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),r(e,[{key:"_start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.delta;this.periodic=setInterval(function(){t._exchange()},e)}},{key:"_stop",value:function(){clearInterval(this.periodic)}},{key:"_receive",value:function(t,e){if(e.type&&"MExchange"===e.type)this._onExchange(t,e);else if(e.type&&"MJoin"===e.type)this._onJoin(t);else{if(!e.type||"MLeave"!==e.type)throw new l("_receive",e,"unhandled");this._onLeave(t)}}},{key:"_open",value:function(t){i("[%s] %s ===> %s",this.PID,this.PEER,t),this.partialView.add(t)}},{key:"_close",value:function(t){i("[%s] %s =†=> %s",this.PID,this.PEER,t)}},{key:"_updateState",value:function(){var t=this.state;this.i.size>0&&this.o.size>0&&"connected"!==t?this.state="connected":(this.i.size>0&&this.o.size<=0||this.o.size>0&&this.i.size<=0)&&"partially connected"!==t?this.state="partially connected":this.i.size<=0&&this.o.size<=0&&"disconnected"!==t&&(this.state="disconnected"),t!==this.state&&this.emit("statechange",this.state)}},{key:"join",value:function(t){var e=this,n=new Promise(function(t,n){"disconnected"!==e.state&&n(new h("join","Already connected."));var r=setTimeout(function(){n(new h("join","Timeout exceeded."))},e.options.timeout);e.once("open",function(i){e.send(i,new u,e.options.retry).then(function(){clearTimeout(r),e._start(),e._inject(e.options.a-1,0,i),t(i)}).catch(function(){n(new h("join","Could not notify remote contact."))})})});return this.connect(t),n}},{key:"_onJoin",value:function(t){var e=this;this.partialView.size>0?(i("[%s] %s ===> join %s ===> %s neighbors",this.PID,t,this.PEER,this.partialView.size),this.partialView.forEach(function(n,r){n.forEach(function(n){e.connect(r,t)})})):(i("[%s] %s ===> join %s ===> %s",this.PID,t,this.PEER,t),this._inject(2*this.options.a,2*this.options.b,t),this._start())}},{key:"leave",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.NI.options.timeout,r=this.NO.options.timeout;this.NI.options.timeout=e,this.NO.options.timeout=e,this._stop(),e>0?function(){var e=[];t.getInview().forEach(function(t,n){return e.push(n)});var n=t.getOutview(),r=[];n.forEach(function(t,e){return r.push(e)});for(var i=n.size-t.options.a,o=function(n){var i=Math.floor(Math.random()*e.length),o=r.filter(function(t){return t!==e[i]});if(o.length>0){var s=Math.floor(Math.random()*o.length);t.connect(e[i],o[s])}},s=0;s<Math.floor(i);++s)o();e.forEach(function(e){t.send(e,new f,t.options.retry).catch(function(t){})}),r.forEach(function(e){t._onLeave(e)})}():(this.partialView.clear(),this.disconnect()),this.NI.options.timeout=n,this.NO.options.timeout=r}},{key:"_onLeave",value:function(t){if(this.partialView.has(t)){i("[%s] %s ==> ††† %s †††",this.PID,this.PEER,t);for(var e=this.partialView.removeAll(t),n=0;n<e;++n)this.disconnect(t)}}},{key:"getPeers",value:function(t){var e=[];if(void 0===t)this.partialView.forEach(function(t,n){e.push(n)});else{var n=[];for(this.partialView.forEach(function(t,e){return n.push(e)});e.length<t&&n.length>0;){var r=Math.floor(Math.random()*n.length);e.push(n[r]),n.splice(r,1)}var o=[];for(this.i.forEach(function(t,e){return o.push(e)});e.length<t&&o.length>0;){var s=Math.floor(Math.random()*o.length);e.push(o[s]),o.splice(s,1)}}return i("[%s] %s provides %s peers",this.PID,this.PEER,e.length),e}},{key:"_checkPartialView",value:function(){var t=this,e=[];this.partialView.forEach(function(n,r){t.o.has(r)||e.push(r)}),e.forEach(function(e){t._onPeerDown(e)})}},{key:"_getSample",value:function(t){var e=[],n=[];this.partialView.forEach(function(t,e){t.forEach(function(t){n.push(e)})});var r=Math.ceil(n.length/2);for(void 0!==t&&(n.splice(n.indexOf(t),1),e.push(t));e.length<r;){var i=Math.floor(Math.random()*n.length);e.push(n[i]),n.splice(i,1)}return e}},{key:"_exchange",value:function(){var t=this;if(this._checkPartialView(),!(this.partialView.size<=0)){this.partialView.increment();var e=this.partialView.oldest;this.send(e,new c(this.getInviewId()),this.options.retry).then(function(){var n=t._getSample(e);i("[%s] %s ==> exchange %s ==> %s",t.PID,t.PEER,n.length,e),(n=n.map(function(n){return n===e&&t.getInviewId()||n})).forEach(function(n){t.connect(e,n)}),(n=n.map(function(n){return n===t.getInviewId()&&e||n})).forEach(function(n){t.disconnect(n),n===e?t.partialView.removeOldest(n):t.partialView.removeYoungest(n)})}).catch(function(n){i("[%s] %s =X> exchange =X> %s",t.PID,t.PEER,e),t._onPeerDown(e)})}}},{key:"_onExchange",value:function(t,e){var n=this;this._checkPartialView(),this.partialView.increment();var r=this._getSample();i("[%s] %s ==> exchange %s ==> %s",this.PID,t,r.length,this.PEER),(r=r.map(function(t){return t===e.inview&&n.getInviewId()||t})).forEach(function(e){n.connect(t,e)}),(r=r.map(function(t){return t===n.getInviewId()&&e.inview||t})).forEach(function(t){n.disconnect(t),n.partialView.removeYoungest(t)})}},{key:"_onPeerDown",value:function(t){i("[%s] ==> %s ==> XXX %s XXX",this.PID,this.PEER,t);var e=this.partialView.removeAll(t),n=this.options.a/(this.partialView.size+e);if(this.partialView.size>0)for(var r=0;r<e;++r)Math.random()>n&&this.connect(null,this.partialView.leastFrequent)}},{key:"_onArcDown",value:function(t){i("[%s] ==> %s =X> %s",this.PID,this.PEER,t||"unknown"),this.partialView.size>0&&this.connect(null,this.partialView.leastFrequent)}},{key:"_inject",value:function(t,e,n){for(var r=t,i=0;i<Math.floor(t);++i)this.connect(null,n),r-=1;Math.random()<r&&this.connect(null,n);for(var o=e,s=0;s<Math.floor(e);++s)this.connect(null,n),o-=1;Math.random()<o&&this.connect(null,n)}}]),e}();t.exports=p},function(t,e,n){"use strict";function r(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=r,r.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(t){this.ms=t},r.prototype.setMax=function(t){this.max=t},r.prototype.setJitter=function(t){this.jitter=t}},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=[],r=(e=e||0)||0;r<t.length;r++)n[r-e]=t[r];return n}},function(t,e){},function(t,e,n){"use strict";(function(e){var r,i=n(87),o=n(49),s=n(66),a=n(65),c=n(132),u=n(13)("engine.io-client:websocket"),f=e.WebSocket||e.MozWebSocket;if("undefined"==typeof window)try{r=n(283)}catch(t){}var l=f;function h(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=f&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(l=r),i.call(this,t)}l||"undefined"!=typeof window||(l=r),t.exports=h,a(h,i),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?e?new l(t,e):new l(t):new l(t,e,n)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},h.prototype.write=function(t){var n=this;this.writable=!1;for(var r=t.length,i=0,s=r;i<s;i++)!function(t){o.encodePacket(t,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var o={};if(t.options&&(o.compress=t.options.compress),n.perMessageDeflate)("string"==typeof i?e.Buffer.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,o)}catch(t){u("websocket closed before onclose event")}--r||a()})}(t[i]);function a(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}},h.prototype.onClose=function(){i.prototype.onClose.call(this)},h.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},h.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),(t=s.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t},h.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===h.prototype.name)}}).call(this,n(6))},function(t,e,n){"use strict";(function(e){var r=n(135),i=n(65);t.exports=u;var o,s=/\n/g,a=/\\n/g;function c(){}function u(t){r.call(this,t),this.query=this.query||{},o||(e.___eio||(e.___eio=[]),o=e.___eio),this.index=o.length;var n=this;o.push(function(t){n.onData(t)}),this.query.j=this.index,e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=c)},!1)}i(u,r),u.prototype.supportsBinary=!1,u.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},u.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},u.prototype.doWrite=function(t,e){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=c,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function u(){f(),e()}function f(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(t)}catch(t){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),f(),t=t.replace(a,"\\\n"),this.area.value=t.replace(s,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,n(6))},function(t,e,n){"use strict";(function(e){var n=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;function s(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}t[e]=r}}}function a(t,e){e=e||{};var r=new n;s(t);for(var i=0;i<t.length;i++)r.append(t[i]);return e.type?r.getBlob(e.type):r.getBlob()}function c(t,e){return s(t),new Blob(t,e||{})}t.exports=r?i?e.Blob:c:o?a:void 0}).call(this,n(6))},function(t,e,n){"use strict";!function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<t.length;r++)n[t.charCodeAt(r)]=r;e.encode=function(e){var n,r=new Uint8Array(e),i=r.length,o="";for(n=0;n<i;n+=3)o+=t[r[n]>>2],o+=t[(3&r[n])<<4|r[n+1]>>4],o+=t[(15&r[n+1])<<2|r[n+2]>>6],o+=t[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(t){var e,r,i,o,s,a=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var f=new ArrayBuffer(a),l=new Uint8Array(f);for(e=0;e<c;e+=4)r=n[t.charCodeAt(e)],i=n[t.charCodeAt(e+1)],o=n[t.charCodeAt(e+2)],s=n[t.charCodeAt(e+3)],l[u++]=r<<2|i>>4,l[u++]=(15&i)<<4|o>>2,l[u++]=(3&o)<<6|63&s;return f}}()},function(t,e,n){"use strict";(function(t,r){var i,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(s){var a="object"==o(e)&&e,c="object"==o(t)&&t&&t.exports==a&&t,u="object"==(void 0===r?"undefined":o(r))&&r;u.global!==u&&u.window!==u||(s=u);var f,l,h,p=String.fromCharCode;function d(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function y(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function v(t,e){return p(t>>e&63|128)}function g(t,e){if(0==(4294967168&t))return p(t);var n="";return 0==(4294965248&t)?n=p(t>>6&31|192):0==(4294901760&t)?(y(t,e)||(t=65533),n=p(t>>12&15|224),n+=v(t,6)):0==(4292870144&t)&&(n=p(t>>18&7|240),n+=v(t,12),n+=v(t,6)),n+=p(63&t|128)}function m(){if(h>=l)throw Error("Invalid byte index");var t=255&f[h];if(h++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function b(t){var e,n;if(h>l)throw Error("Invalid byte index");if(h==l)return!1;if(e=255&f[h],h++,0==(128&e))return e;if(192==(224&e)){if((n=(31&e)<<6|m())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&e)){if((n=(15&e)<<12|m()<<6|m())>=2048)return y(n,t)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(n=(7&e)<<18|m()<<12|m()<<6|m())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}var _={version:"2.1.2",encode:function(t,e){for(var n=!1!==(e=e||{}).strict,r=d(t),i=r.length,o=-1,s="";++o<i;)s+=g(r[o],n);return s},decode:function(t,e){var n=!1!==(e=e||{}).strict;f=d(t),l=f.length,h=0;for(var r,i=[];!1!==(r=b(n));)i.push(r);return function(t){for(var e,n=t.length,r=-1,i="";++r<n;)(e=t[r])>65535&&(i+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),i+=p(e);return i}(i)}};if("object"==o(n(133))&&n(133))void 0===(i=function(){return _}.call(e,n,e,t))||(t.exports=i);else if(a&&!a.nodeType)if(c)c.exports=_;else{var w={}.hasOwnProperty;for(var C in _)w.call(_,C)&&(a[C]=_[C])}else s.utf8=_}(void 0)}).call(this,n(54)(t),n(6))},function(t,e,n){"use strict";function r(){}t.exports=function(t,e,n){var i=!1;return n=n||r,o.count=t,0===t?e():o;function o(t,r){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(i=!0,e(t),e=n):0!==o.count||i||e(null,r)}}},function(t,e,n){"use strict";t.exports=function(t,e,n){var r=t.byteLength;if(e=e||0,n=n||r,t.slice)return t.slice(e,n);if(e<0&&(e+=r),n<0&&(n+=r),n>r&&(n=r),e>=r||e>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(t),o=new Uint8Array(n-e),s=e,a=0;s<n;s++,a++)o[a]=i[s];return o.buffer}},function(t,e,n){"use strict";var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,n){"use strict";t.exports=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var r in t)n.call(t,r)&&e.push(r);return e}},function(t,e,n){"use strict";(function(e){var r=n(88),i=n(135),o=n(50),s=n(65),a=n(13)("engine.io-client:polling-xhr");function c(){}function u(t){if(i.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,e.location){var n="https:"===location.protocol,r=location.port;r||(r=n?443:80),this.xd=t.hostname!==e.location.hostname||r!==t.port,this.xs=t.secure!==n}}function f(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function l(){for(var t in f.requests)f.requests.hasOwnProperty(t)&&f.requests[t].abort()}t.exports=u,t.exports.Request=f,s(u,i),u.prototype.supportsBinary=!0,u.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new f(t)},u.prototype.doWrite=function(t,e){var n="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:n}),i=this;r.on("success",e),r.on("error",function(t){i.onError("xhr post error",t)}),this.sendXhr=r},u.prototype.doPoll=function(){a("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},o(f.prototype),f.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new r(t),i=this;try{a("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this.extraHeaders[o])}catch(t){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{n.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){i.onLoad()},n.onerror=function(){i.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState)try{var t=n.getResponseHeader("Content-Type");i.supportsBinary&&"application/octet-stream"===t&&(n.responseType="arraybuffer")}catch(t){}4===n.readyState&&(200===n.status||1223===n.status?i.onLoad():setTimeout(function(){i.onError(n.status)},0))},a("xhr data %s",this.data),n.send(this.data)}catch(t){return void setTimeout(function(){i.onError(t)},0)}e.document&&(this.index=f.requestsCount++,f.requests[this.index]=this)},f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},f.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},f.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},f.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,t)try{this.xhr.abort()}catch(t){}e.document&&delete f.requests[this.index],this.xhr=null}},f.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},f.prototype.hasXDR=function(){return void 0!==e.XDomainRequest&&!this.xs&&this.enablesXDR},f.prototype.abort=function(){this.cleanup()},f.requestsCount=0,f.requests={},e.document&&(e.attachEvent?e.attachEvent("onunload",l):e.addEventListener&&e.addEventListener("beforeunload",l,!1))}).call(this,n(6))},function(t,e,n){"use strict";try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,n){"use strict";(function(e){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(136),o=n(50),s=n(13)("engine.io-client:socket"),a=n(131),c=n(49),u=n(140),f=n(66);function l(t,n){if(!(this instanceof l))return new l(t,n);n=n||{},t&&"object"===(void 0===t?"undefined":r(t))&&(n=t,t=null),t?(t=u(t),n.hostname=t.host,n.secure="https"===t.protocol||"wss"===t.protocol,n.port=t.port,t.query&&(n.query=t.query)):n.host&&(n.hostname=u(n.host).host),this.secure=null!=n.secure?n.secure:e.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(e.location?location.hostname:"localhost"),this.port=n.port||(e.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=f.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.transportOptions=n.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized,this.forceNode=!!n.forceNode;var i="object"===(void 0===e?"undefined":r(e))&&e;i.global===i&&(n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=l,l.priorWebsocketSuccess=!1,o(l.prototype),l.protocol=c.protocol,l.Socket=l,l.Transport=n(87),l.transports=n(136),l.parser=n(49),l.prototype.createTransport=function(t){s('creating transport "%s"',t);var e=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.query);e.EIO=c.protocol,e.transport=t;var n=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new i[t]({query:e,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},l.prototype.open=function(){var t;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},l.prototype.setTransport=function(t){s("setting transport %s",t.name);var e=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},l.prototype.probe=function(t){s('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(s('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(s('probe transport "%s" pong',t),r.upgrading=!0,r.emit("upgrading",e),!e)return;l.priorWebsocketSuccess="websocket"===e.name,s('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!==r.readyState&&(s("changing transport and sending upgrade packet"),h(),r.setTransport(e),e.send([{type:"upgrade"}]),r.emit("upgrade",e),e=null,r.upgrading=!1,r.flush())})}else{s('probe transport "%s" failed',t);var o=new Error("probe error");o.transport=e.name,r.emit("upgradeError",o)}}))}function o(){n||(n=!0,h(),e.close(),e=null)}function a(n){var i=new Error("probe error: "+n);i.transport=e.name,o(),s('probe transport "%s" failed because of error: %s',t,n),r.emit("upgradeError",i)}function c(){a("transport closed")}function u(){a("socket closed")}function f(t){e&&t.name!==e.name&&(s('"%s" works - aborting "%s"',t.name,e.name),o())}function h(){e.removeListener("open",i),e.removeListener("error",a),e.removeListener("close",c),r.removeListener("close",u),r.removeListener("upgrading",f)}l.priorWebsocketSuccess=!1,e.once("open",i),e.once("error",a),e.once("close",c),this.once("close",u),this.once("upgrading",f),e.open()},l.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},l.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else s('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},l.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},l.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},l.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},l.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},l.prototype.sendPacket=function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:t,data:e,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},l.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():e()}):this.upgrading?r():e()}function e(){t.onClose("forced close"),s("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function r(){t.once("upgrade",n),t.once("upgradeError",n)}return this},l.prototype.onError=function(t){s("socket error %j",t),l.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},l.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},l.prototype.filterUpgrades=function(t){for(var e=[],n=0,r=t.length;n<r;n++)~a(this.transports,t[n])&&e.push(t[n]);return e}}).call(this,n(6))},function(t,e,n){"use strict";t.exports=n(295),t.exports.parser=n(49)},function(t,e,n){"use strict";(function(t){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(139),o=n(138),s=Object.prototype.toString,a="function"==typeof t.Blob||"[object BlobConstructor]"===s.call(t.Blob),c="function"==typeof t.File||"[object FileConstructor]"===s.call(t.File);e.deconstructPacket=function(t){var e=[],n=t.data,s=t;return s.data=function t(e,n){if(!e)return e;if(o(e)){var s={_placeholder:!0,num:n.length};return n.push(e),s}if(i(e)){for(var a=new Array(e.length),c=0;c<e.length;c++)a[c]=t(e[c],n);return a}if("object"===(void 0===e?"undefined":r(e))&&!(e instanceof Date)){var a={};for(var u in e)a[u]=t(e[u],n);return a}return e}(n,e),s.attachments=e.length,{packet:s,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,n){if(!e)return e;if(e&&e._placeholder)return n[e.num];if(i(e))for(var o=0;o<e.length;o++)e[o]=t(e[o],n);else if("object"===(void 0===e?"undefined":r(e)))for(var s in e)e[s]=t(e[s],n);return e}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){var n=0,s=t;!function t(u,f,l){if(!u)return u;if(a&&u instanceof Blob||c&&u instanceof File){n++;var h=new FileReader;h.onload=function(){l?l[f]=this.result:s=this.result,--n||e(s)},h.readAsArrayBuffer(u)}else if(i(u))for(var p=0;p<u.length;p++)t(u[p],p,u);else if("object"===(void 0===u?"undefined":r(u))&&!o(u))for(var d in u)t(u[d],d,u)}(s),n||e(s)}}).call(this,n(6))},function(t,e,n){"use strict";(function(e){var r=n(140),i=n(13)("socket.io-client:url");t.exports=function(t,n){var o=t;n=n||e.location,null==t&&(t=n.protocol+"//"+n.host);"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t=void 0!==n?n.protocol+"//"+t:"https://"+t),i("parse %s",t),o=r(t));o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443"));o.path=o.path||"/";var s=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+s+":"+o.port,o.href=o.protocol+"://"+s+(n&&n.port===o.port?"":":"+o.port),o}}).call(this,n(6))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(91),o=n(13)("foglet-core:media"),s=n(151),a=n(92),c=n(27),u=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"foglet-media-unicast-protocol-"+n));return r.options={retry:1},r._activeMedia=new Map,r._broadcast=new s(t,n+"-stream-broadcast-internal"),r._broadcast.on("receive",function(t,e){r._receiveBroadcast(t,e)}),r._unicast=new a(t,n+"-stream-unicast-internal"),r._unicast.on("receive",function(t,e){r._receiveUnicast(t,e)}),r.NI=r._source.rps.NI,r.NO=r._source.rps.NO,r._source.rps.on("open",function(t){r._checkStreamConnect(t)}),r._source.rps.on("close",function(t){r._checkStreamDisconnect(t)}),r.i=r._source.rps.i,r.o=r._source.rps.o,r._source.rps.on("stream",function(t,e){r._receive(t,e)}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"_checkStreamConnect",value:function(t){}},{key:"_checkStreamDisconnect",value:function(t){}},{key:"_receiveUnicast",value:function(t,e){}},{key:"_receiveBroadcast",value:function(t,e){}},{key:"sendUnicast",value:function(t,e){return e.id||(e.id=c()),this._activeMedia.has(e.id)||(this._activeMedia.set(e.id,e),this._setListeners(e)),this._send(t,e,this.options.retry)}},{key:"sendBroadcast",value:function(t,e){return console.log(e),e.id||(e.id=c()),this._activeMedia.has(e.id)||(this._activeMedia.set(e.id,e),this._setListeners(e)),this._send(t,e,this.options.retry)}},{key:"_send",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.retry;return this.i.has(t)?this._sendBis(this.pid,t,e,r,this.NI):this.o.has(t)?this._sendBis(this.pid,t,e,r,this.NO):new Promise(function(i,o){!function s(a){n._sendBis(n.pid,t,e,r,n.NO).then(function(){i()}).catch(function(c){n._sendBis(n.pid,t,e,r,n.NI).then(function(){i()}).catch(function(t){a<r?setTimeout(function(){s(a+1)},1e3):o(t)})})}(0)})}},{key:"_sendBis",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments[4];return new Promise(function(s,a){var c=null;i.living.contains(e)?c=i.living.get(e):i.dying.has(e)&&(c=i.dying.get(e));!function u(f){try{console.log("sending:",c.socket,n),c.socket.addStream(n),o("[%s][%s] --- MEDIA msg --\x3e %s:%s",t,i.PEER,e,t),s()}catch(n){o("[%s][%s] -X- MEDIA msg -X> %s:%s",t,i.PEER,e,t),f<r?setTimeout(function(){u(f+1)},1e3):a(n)}}(0)})}},{key:"_receive",value:function(t,e){o("Receive a media stream: ",t,e),e.id||(e.id=c()),this._activeMedia.has(e.id)||(this._activeMedia.set(e.id,{peer:t,stream:e}),this._setListeners(e)),this.emit("receive",t,e)}},{key:"_setListeners",value:function(t){var e=this;t.onactive=function(){console.log("Media %s is active...",t.id)},t.oninactive=function(){console.log("Media %s is inactive...",t.id),e._sendRequest(t.id)},t.onended=function(){console.log("Media %s is finished...",t.id)}}},{key:"pid",get:function(){return this._source.rps._pid()}}]),e}();t.exports=u},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(90).PassThrough,o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{objectMode:!0}));return t._trailers=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"trailers",get:function(){return this._trailers}}]),e}();t.exports=o},function(t,e,n){"use strict";var r=function(t){return function(e,n){return{id:e,type:t,payload:n}}},i=r("chunk"),o=r("trailers"),s=r("end"),a=r("error");t.exports={StreamMessageChunk:i,StreamMessageTrailers:o,StreamMessageEnd:s,StreamMessageError:a}},function(t,e,n){"use strict";t.exports=o;var r=n(143),i=n(60);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=n(52),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){"use strict";(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,n(6))},function(t,e,n){"use strict";(function(t,e){!function(t,n){if(!t.setImmediate){var r,i,o,s,a,c=1,u={},f=!1,l=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){d(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},r=function(t){o.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(i=l.documentElement,r=function(t){var e=l.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(d,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&d(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(s+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return u[c]=i,r(c),c++},h.clearImmediate=p}function p(t){delete u[t]}function d(t){if(f)setTimeout(d,0,t);else{var e=u[t];if(e){f=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{p(t),f=!1}}}}}("undefined"==typeof self?void 0===t?void 0:t:self)}).call(this,n(6),n(15))},function(t,e,n){"use strict";(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(304),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||void 0,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||void 0}).call(this,n(6))},function(t,e){},function(t,e,n){"use strict";var r=n(61).Buffer,i=n(306);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e,n,i,o=r.allocUnsafe(t>>>0),s=this.head,a=0;s;)e=s.data,n=o,i=a,e.copy(n,i),a+=s.data.length,s=s.next;return o},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){"use strict";e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,f=-7,l=n?i-1:0,h=n?-1:1,p=t[e+l];for(l+=h,o=p&(1<<-f)-1,p>>=-f,f+=a;f>0;o=256*o+t[e+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+t[e+l],l+=h,f-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=u}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,c,u=8*o-i-1,f=(1<<u)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+l>=1?h/c:h*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(e*c-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+p]=255&s,p+=d,s/=256,u-=8);t[n+p-d]|=128*y}},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=u(t),r=n[0],s=n[1],a=new o(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),c=0,f=s>0?r-4:r,l=0;l<f;l+=4)e=i[t.charCodeAt(l)]<<18|i[t.charCodeAt(l+1)]<<12|i[t.charCodeAt(l+2)]<<6|i[t.charCodeAt(l+3)],a[c++]=e>>16&255,a[c++]=e>>8&255,a[c++]=255&e;2===s&&(e=i[t.charCodeAt(l)]<<2|i[t.charCodeAt(l+1)]>>4,a[c++]=255&e);1===s&&(e=i[t.charCodeAt(l)]<<10|i[t.charCodeAt(l+1)]<<4|i[t.charCodeAt(l+2)]>>2,a[c++]=e>>8&255,a[c++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(f(t,s,s+16383>a?a:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function f(t,e,n){for(var i,o,s=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(27),o=n(90).Writable,s=n(301),a=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{objectMode:!0}));return n._id=i(),n._send=t,n._trailers=[],n._last_id=void 0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),r(e,[{key:"addTrailer",value:function(t){this._trailers.push(t)}},{key:"destroy",value:function(t){this._last_id=this._send(s.StreamMessageError(this._id,t),null,this._last_id),function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this,t)}},{key:"_write",value:function(t,e,n){return this._last_id=this._send(s.StreamMessageChunk(this._id,t),null,this._last_id),n(),this._last_id}},{key:"_final",value:function(t){this._trailers.length>0&&(this._last_id=this._send(s.StreamMessageTrailers(this._id,this._trailers),null,this._last_id)),this._last_id=this._send(s.StreamMessageEnd(this._id),null,this._last_id),t()}}]),e}();t.exports=a},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._middlewares=[]}return r(t,[{key:"register",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!("in"in t||"out"in t))throw new Error('A middleware must contains two functions: "in" and "out"');this._middlewares.push({middleware:t,priority:e}),this._middlewares.sort(function(t,e){return t.priority-e.priority})}},{key:"in",value:function(t){var e=void 0;return this._middlewares.reduce(function(t,n){return void 0!==(e=n.middleware.in(t))||null!==e?e:t},t)}},{key:"out",value:function(t){var e=void 0;return this._middlewares.reduce(function(t,n){return void 0!==(e=n.middleware.out(t))||null!==e?e:t},t)}}]),t}();t.exports=i},function(t,e,n){"use strict";function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,o=i-(n||i);t.diff=o,t.prev=n,t.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(t,o),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s),(r.log||e.log||console.log.bind(console)).apply(t,s)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var o=e.instances[n];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(53),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e,n){"use strict";(function(t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=200,o="Expected a function",s="__lodash_hash_undefined__",a=1,c=2,u=1/0,f=9007199254740991,l=4294967294,h="[object Arguments]",p="[object Array]",d="[object Boolean]",y="[object Date]",v="[object Error]",g="[object Function]",m="[object GeneratorFunction]",b="[object Map]",_="[object Number]",w="[object Object]",C="[object RegExp]",k="[object Set]",S="[object String]",E="[object Symbol]",x="[object ArrayBuffer]",O="[object DataView]",A=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,P=/^\w*$/,j=/^\./,T=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,M=/\\(\\)?/g,R=/^\[object .+?Constructor\]$/,I=/^(?:0|[1-9]\d*)$/,F={};F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F[h]=F[p]=F[x]=F[d]=F[O]=F[y]=F[v]=F[g]=F[b]=F[_]=F[w]=F[C]=F[k]=F[S]=F["[object WeakMap]"]=!1;var N="object"==(void 0===t?"undefined":r(t))&&t&&t.Object===Object&&t,D="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,B=N||D||Function("return this")(),L="object"==r(e)&&e&&!e.nodeType&&e,U=L&&"object"==r(n)&&n&&!n.nodeType&&n,q=U&&U.exports===L&&N.process,z=function(){try{return q&&q.binding("util")}catch(t){}}(),V=z&&z.isTypedArray;function W(t,e){for(var n=-1,r=t?t.length:0;++n<r;)if(e(t[n],n,t))return!0;return!1}function J(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function H(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function $(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var G,Y,Q,X=Array.prototype,Z=Function.prototype,K=Object.prototype,tt=B["__core-js_shared__"],et=(G=/[^.]+$/.exec(tt&&tt.keys&&tt.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",nt=Z.toString,rt=K.hasOwnProperty,it=K.toString,ot=RegExp("^"+nt.call(rt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),st=B.Symbol,at=B.Uint8Array,ct=K.propertyIsEnumerable,ut=X.splice,ft=Math.floor,lt=(Y=Object.keys,Q=Object,function(t){return Y(Q(t))}),ht=Math.min,pt=Vt(B,"DataView"),dt=Vt(B,"Map"),yt=Vt(B,"Promise"),vt=Vt(B,"Set"),gt=Vt(B,"WeakMap"),mt=Vt(Object,"create"),bt=Xt(pt),_t=Xt(dt),wt=Xt(yt),Ct=Xt(vt),kt=Xt(gt),St=st?st.prototype:void 0,Et=St?St.valueOf:void 0,xt=St?St.toString:void 0;function Ot(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function At(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Pt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function jt(t){var e=-1,n=t?t.length:0;for(this.__data__=new Pt;++e<n;)this.add(t[e])}function Tt(t){this.__data__=new At(t)}function Mt(t,e){var n=ee(t)||te(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],r=n.length,i=!!r;for(var o in t)!e&&!rt.call(t,o)||i&&("length"==o||Jt(o,r))||n.push(o);return n}function Rt(t,e){for(var n=t.length;n--;)if(Kt(t[n][0],e))return n;return-1}function It(t,e){for(var n=0,r=(e=Ht(e,t)?[e]:Ut(e)).length;null!=t&&n<r;)t=t[Qt(e[n++])];return n&&n==r?t:void 0}function Ft(t,e){return null!=t&&e in Object(t)}function Nt(t,e,n,r,i){return t===e||(null==t||null==e||!oe(t)&&!se(e)?t!=t&&e!=e:function(t,e,n,r,i,o){var s=ee(t),u=ee(e),f=p,l=p;s||(f=(f=Wt(t))==h?w:f);u||(l=(l=Wt(e))==h?w:l);var g=f==w&&!J(t),m=l==w&&!J(e),A=f==l;if(A&&!g)return o||(o=new Tt),s||ce(t)?qt(t,e,n,r,i,o):function(t,e,n,r,i,o,s){switch(n){case O:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!r(new at(t),new at(e)));case d:case y:case _:return Kt(+t,+e);case v:return t.name==e.name&&t.message==e.message;case C:case S:return t==e+"";case b:var u=H;case k:var f=o&c;if(u||(u=$),t.size!=e.size&&!f)return!1;var l=s.get(t);if(l)return l==e;o|=a,s.set(t,e);var h=qt(u(t),u(e),r,i,o,s);return s.delete(t),h;case E:if(Et)return Et.call(t)==Et.call(e)}return!1}(t,e,f,n,r,i,o);if(!(i&c)){var P=g&&rt.call(t,"__wrapped__"),j=m&&rt.call(e,"__wrapped__");if(P||j){var T=P?t.value():t,M=j?e.value():e;return o||(o=new Tt),n(T,M,r,i,o)}}if(!A)return!1;return o||(o=new Tt),function(t,e,n,r,i,o){var s=i&c,a=ue(t),u=a.length,f=ue(e).length;if(u!=f&&!s)return!1;for(var l=u;l--;){var h=a[l];if(!(s?h in e:rt.call(e,h)))return!1}var p=o.get(t);if(p&&o.get(e))return p==e;var d=!0;o.set(t,e),o.set(e,t);for(var y=s;++l<u;){h=a[l];var v=t[h],g=e[h];if(r)var m=s?r(g,v,h,e,t,o):r(v,g,h,t,e,o);if(!(void 0===m?v===g||n(v,g,r,i,o):m)){d=!1;break}y||(y="constructor"==h)}if(d&&!y){var b=t.constructor,_=e.constructor;b!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _)&&(d=!1)}return o.delete(t),o.delete(e),d}(t,e,n,r,i,o)}(t,e,Nt,n,r,i))}function Dt(t){return!(!oe(t)||et&&et in t)&&(re(t)||J(t)?ot:R).test(Xt(t))}function Bt(t){return"function"==typeof t?t:null==t?fe:"object"==(void 0===t?"undefined":r(t))?ee(t)?function(t,e){if(Ht(t)&&$t(e))return Gt(Qt(t),e);return function(n){var r=function(t,e,n){var r=null==t?void 0:It(t,e);return void 0===r?n:r}(n,t);return void 0===r&&r===e?function(t,e){return null!=t&&function(t,e,n){var r,i=-1,o=(e=Ht(e,t)?[e]:Ut(e)).length;for(;++i<o;){var s=Qt(e[i]);if(!(r=null!=t&&n(t,s)))break;t=t[s]}if(r)return r;return!!(o=t?t.length:0)&&ie(o)&&Jt(s,o)&&(ee(t)||te(t))}(t,e,Ft)}(n,t):Nt(e,r,void 0,a|c)}}(t[0],t[1]):function(t){var e=function(t){var e=ue(t),n=e.length;for(;n--;){var r=e[n],i=t[r];e[n]=[r,i,$t(i)]}return e}(t);if(1==e.length&&e[0][2])return Gt(e[0][0],e[0][1]);return function(n){return n===t||function(t,e,n,r){var i=n.length,o=i,s=!r;if(null==t)return!o;for(t=Object(t);i--;){var u=n[i];if(s&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<o;){var f=(u=n[i])[0],l=t[f],h=u[1];if(s&&u[2]){if(void 0===l&&!(f in t))return!1}else{var p=new Tt;if(r)var d=r(l,h,f,t,e,p);if(!(void 0===d?Nt(h,l,r,a|c,p):d))return!1}}return!0}(n,t,e)}}(t):Ht(e=t)?(n=Qt(e),function(t){return null==t?void 0:t[n]}):function(t){return function(e){return It(e,t)}}(e);var e,n}function Lt(t){if(n=(e=t)&&e.constructor,r="function"==typeof n&&n.prototype||K,e!==r)return lt(t);var e,n,r,i=[];for(var o in Object(t))rt.call(t,o)&&"constructor"!=o&&i.push(o);return i}function Ut(t){return ee(t)?t:Yt(t)}function qt(t,e,n,r,i,o){var s=i&c,u=t.length,f=e.length;if(u!=f&&!(s&&f>u))return!1;var l=o.get(t);if(l&&o.get(e))return l==e;var h=-1,p=!0,d=i&a?new jt:void 0;for(o.set(t,e),o.set(e,t);++h<u;){var y=t[h],v=e[h];if(r)var g=s?r(v,y,h,e,t,o):r(y,v,h,t,e,o);if(void 0!==g){if(g)continue;p=!1;break}if(d){if(!W(e,function(t,e){if(!d.has(e)&&(y===t||n(y,t,r,i,o)))return d.add(e)})){p=!1;break}}else if(y!==v&&!n(y,v,r,i,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function zt(t,e){var n,i,o=t.__data__;return("string"==(i=void 0===(n=e)?"undefined":r(n))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Vt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return Dt(n)?n:void 0}Ot.prototype.clear=function(){this.__data__=mt?mt(null):{}},Ot.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Ot.prototype.get=function(t){var e=this.__data__;if(mt){var n=e[t];return n===s?void 0:n}return rt.call(e,t)?e[t]:void 0},Ot.prototype.has=function(t){var e=this.__data__;return mt?void 0!==e[t]:rt.call(e,t)},Ot.prototype.set=function(t,e){return this.__data__[t]=mt&&void 0===e?s:e,this},At.prototype.clear=function(){this.__data__=[]},At.prototype.delete=function(t){var e=this.__data__,n=Rt(e,t);return!(n<0||(n==e.length-1?e.pop():ut.call(e,n,1),0))},At.prototype.get=function(t){var e=this.__data__,n=Rt(e,t);return n<0?void 0:e[n][1]},At.prototype.has=function(t){return Rt(this.__data__,t)>-1},At.prototype.set=function(t,e){var n=this.__data__,r=Rt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},Pt.prototype.clear=function(){this.__data__={hash:new Ot,map:new(dt||At),string:new Ot}},Pt.prototype.delete=function(t){return zt(this,t).delete(t)},Pt.prototype.get=function(t){return zt(this,t).get(t)},Pt.prototype.has=function(t){return zt(this,t).has(t)},Pt.prototype.set=function(t,e){return zt(this,t).set(t,e),this},jt.prototype.add=jt.prototype.push=function(t){return this.__data__.set(t,s),this},jt.prototype.has=function(t){return this.__data__.has(t)},Tt.prototype.clear=function(){this.__data__=new At},Tt.prototype.delete=function(t){return this.__data__.delete(t)},Tt.prototype.get=function(t){return this.__data__.get(t)},Tt.prototype.has=function(t){return this.__data__.has(t)},Tt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof At){var r=n.__data__;if(!dt||r.length<i-1)return r.push([t,e]),this;n=this.__data__=new Pt(r)}return n.set(t,e),this};var Wt=function(t){return it.call(t)};function Jt(t,e){return!!(e=null==e?f:e)&&("number"==typeof t||I.test(t))&&t>-1&&t%1==0&&t<e}function Ht(t,e){if(ee(t))return!1;var n=void 0===t?"undefined":r(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ae(t))||(P.test(t)||!A.test(t)||null!=e&&t in Object(e))}function $t(t){return t==t&&!oe(t)}function Gt(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}(pt&&Wt(new pt(new ArrayBuffer(1)))!=O||dt&&Wt(new dt)!=b||yt&&"[object Promise]"!=Wt(yt.resolve())||vt&&Wt(new vt)!=k||gt&&"[object WeakMap]"!=Wt(new gt))&&(Wt=function(t){var e=it.call(t),n=e==w?t.constructor:void 0,r=n?Xt(n):void 0;if(r)switch(r){case bt:return O;case _t:return b;case wt:return"[object Promise]";case Ct:return k;case kt:return"[object WeakMap]"}return e});var Yt=Zt(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(ae(t))return xt?xt.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}(e);var n=[];return j.test(t)&&n.push(""),t.replace(T,function(t,e,r,i){n.push(r?i.replace(M,"$1"):e||t)}),n});function Qt(t){if("string"==typeof t||ae(t))return t;var e=t+"";return"0"==e&&1/t==-u?"-0":e}function Xt(t){if(null!=t){try{return nt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Zt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(o);var n=function n(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s),s};return n.cache=new(Zt.Cache||Pt),n}function Kt(t,e){return t===e||t!=t&&e!=e}function te(t){return function(t){return se(t)&&ne(t)}(t)&&rt.call(t,"callee")&&(!ct.call(t,"callee")||it.call(t)==h)}Zt.Cache=Pt;var ee=Array.isArray;function ne(t){return null!=t&&ie(t.length)&&!re(t)}function re(t){var e=oe(t)?it.call(t):"";return e==g||e==m}function ie(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=f}function oe(t){var e=void 0===t?"undefined":r(t);return!!t&&("object"==e||"function"==e)}function se(t){return!!t&&"object"==(void 0===t?"undefined":r(t))}function ae(t){return"symbol"==(void 0===t?"undefined":r(t))||se(t)&&it.call(t)==E}var ce=V?function(t){return function(e){return t(e)}}(V):function(t){return se(t)&&ie(t.length)&&!!F[it.call(t)]};function ue(t){return ne(t)?Mt(t):Lt(t)}function fe(t){return t}n.exports=function(t,e,n){return function(t,e,n,r){e=n(e);for(var i=0,o=t?t.length:0,s=e!=e,a=null===e,c=ae(e),u=void 0===e;i<o;){var f=ft((i+o)/2),h=n(t[f]),p=void 0!==h,d=null===h,y=h==h,v=ae(h);if(s)var g=r||y;else g=u?y&&(r||p):a?y&&p&&(r||!d):c?y&&p&&!d&&(r||!v):!d&&!v&&(r?h<=e:h<e);g?i=f+1:o=f}return ht(o,l)}(t,e,Bt(n))}}).call(this,n(6),n(54)(t))},function(t,e,n){"use strict";t.exports={BroadcastMessage:function(t,e,n,r){return{protocol:t,id:e,isReady:n,payload:r}},MAntiEntropyRequest:function(t){return{type:"MAntiEntropyRequest",causality:t}},MAntiEntropyResponse:function(t,e,n,r){return{type:"MAntiEntropyResponse",id:t,causality:e,nbElements:n,element:r,elements:[]}}}},function(t,e,n){"use strict";t.exports=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.e=e,this.c=n}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.e=e,this.v=0,this.x=[]}return r(t,[{key:"increment",value:function(){this.v+=1}},{key:"incrementFrom",value:function(t){if(t<this.v){var e=this.x.indexOf(t);e>=0&&this.x.splice(e,1)}if(t===this.v+1&&(this.v+=1),t>this.v+1){for(var n=this.v+1;n<t;++n)this.x.push(n);this.v=t}}}],[{key:"comparator",value:function(t,e){var n=t.e||t,r=e.e||e;return n<r?-1:n>r?1:0}}]),t}();t.exports=i},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){var o,s;if(void 0===r)r=0;else if((r|=0)<0||r>=t.length)throw new RangeError("invalid lower bound");if(void 0===i)i=t.length-1;else if((i|=0)<r||i>=t.length)throw new RangeError("invalid upper bound");for(;r<=i;)if((s=+n(t[o=r+(i-r>>1)],e))<0)r=o+1;else{if(!(s>0))return o;i=o-1}return~r}},function(t,e,n){"use strict";t.exports=i;var r=n(318);function i(t,e){if("function"!=typeof t)throw new TypeError("comparator must be a function");this.arr=e||[],this.cmp=t}i.prototype.insert=function(t){var e=r(this.arr,t,this.cmp);e<0&&(e=~e),this.arr.splice(e,0,t)},i.prototype.indexOf=function(t){var e=r(this.arr,t,this.cmp);return e>=0?e:-1},i.prototype.remove=function(t){var e=r(this.arr,t,this.cmp);return!(e<0)&&(this.arr.splice(e,1),!0)}},function(t,e,n){"use strict";var r=n(91),i=n(92),o=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"foglet-broadcast-protocol-"+n));return r._unicast=new i(r._source,r._protocol),r._unicast.on("receive",function(t,e){r._receive(t,e)}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),e}();t.exports=o},function(t,e,n){"use strict";t.exports=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pid=e,this.event=n,this.args=r,this.type="MUnicast"}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=1e3,o=60*i,s=60*o,a=24*s,c=365.25*a;function u(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var n,f=void 0===t?"undefined":r(t);if("string"===f&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*c;case"days":case"day":case"d":return n*a;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*o;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(t);if("number"===f&&!1===isNaN(t))return e.long?u(n=t,a,"day")||u(n,s,"hour")||u(n,o,"minute")||u(n,i,"second")||n+" ms":function(t){if(t>=a)return Math.round(t/a)+"d";if(t>=s)return Math.round(t/s)+"h";if(t>=o)return Math.round(t/o)+"m";if(t>=i)return Math.round(t/i)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";var r;function i(t){function n(){if(n.enabled){var t=n,i=+new Date,o=i-(r||i);t.diff=o,t.prev=r,t.curr=i,r=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(t,o),s.splice(c,1),c--}return n}),e.formatArgs.call(t,s),(n.log||e.log||console.log.bind(console)).apply(t,s)}}return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),"function"==typeof e.init&&e.init(n),n}(e=t.exports=i.debug=i.default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(322),e.names=[],e.skips=[],e.formatters={}},function(t,e,n){"use strict";(function(r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(323)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(this,n(15))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(324)("unicast-definition"),o=n(12),s=n(11),a=n(321),c=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));r.options=s({retry:0,pid:"default-unicast"},n),r.psp=t;var o=t._receive;return t._receive=function(e,n){try{o.call(t,e,n)}catch(t){if(!n.type||"MUnicast"!==n.type||n.pid!==r.options.pid)throw t;r._emit.apply(r,[n.event].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(n.args)))}},r._emit=r.emit,r.emit=function(e,n){for(var i=arguments.length,o=Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];return t.send(n,new a(r.options.pid,e,o),r.options.retry)},i("just initialized on top of %s@%s.",r.psp.PID,r.psp.PEER),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),r(e,[{key:"destroy",value:function(){this.removeAllListener(),this.emit=this._emit}}]),e}();t.exports=c},function(t,e,n){"use strict";var r=n(91),i=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"foglet-unicast-protocol-"+n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r),e}();t.exports=i},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(152),o=n(142),s=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._network=e,this._signaling=new o(e,n),this._communication=new i(e,r)}return r(t,[{key:"use",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.communication.use(t,e)}},{key:"network",get:function(){return this._network}},{key:"signaling",get:function(){return this._signaling}},{key:"communication",get:function(){return this._communication}}]),t}();t.exports=s},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var o=n(12),s=n(11),a=n(327),c=n(127),u=n(125),f=n(13)("foglet-core:network-manager"),l=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n._options=s({rps:{type:"spray-wrtc",options:{protocol:"spray-wrtc-communication"}},overlays:[]},t),n._rps=n._buildRPS(n._options.rps.type,n._options.rps.options),n._overlays=new Map,n._buildOverlays(n._options.overlays),f("Networks (Rps and overlays) initialized."),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"overlay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===t?this._rps:this._overlays.get(t)}},{key:"registerMiddleware",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._rps.use(t,e),this._overlays.forEach(function(n){return n.use(t,e)})}},{key:"_buildRPS",value:function(t,e){var n=new(this._chooseRps(t,e))(e);return new a(n,e.signaling,e.protocol)}},{key:"_chooseRps",value:function(t,e){var n=null;switch(t){case"spray-wrtc":n=c;break;case"cyclon":n=u;break;case"custom":n=e.class;break;default:n=c}return n}},{key:"_buildOverlays",value:function(t){var e=this;0===t.length&&f("No overlays added, only the base RPS is available"),t.forEach(function(t){e._buildOverlay(t)})}},{key:"_buildOverlay",value:function(t){if(!("object"===(void 0===t?"undefined":r(t))&&"name"in t&&"class"in t))throw new SyntaxError("An overlay is a configuration object {name: [string], class: [function], options: [Object]}");var e=t.options;if(!("protocol"in e))throw new SyntaxError("An overlay configuration requires a protocol name, e;g. { protocol: [string] }");if("signaling"in e||f('[WARNING] no signaling server given for overlay "'+t.name+'"! Only connections from inside the same app will be allowed!'),this._overlays.has(t.name))throw new Error('An overlay with the name "'+t.name+'" has already been registered!');var n=new t.class(this,e);this._overlays.set(t.name,new a(n,e.signaling,e.protocol))}}]),e}();t.exports=l},function(t,e,n){"use strict";for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);t.exports=function(t,e){var n=e||0,i=r;return i[t[n++]]+i[t[n++]]+i[t[n++]]+i[t[n++]]+"-"+i[t[n++]]+i[t[n++]]+"-"+i[t[n++]]+i[t[n++]]+"-"+i[t[n++]]+i[t[n++]]+"-"+i[t[n++]]+i[t[n++]]+i[t[n++]]+i[t[n++]]+i[t[n++]]+i[t[n++]]}},function(t,e,n){"use strict";var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);t.exports=function(){return r(i),i}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(12),o=n(27),s=n(11),a=n(328),c=n(245),u=function(){return{verbose:!0,rps:{type:"spray-wrtc",options:{protocol:"foglet-example-rps",webrtc:{trickle:!0,iceServers:[]},timeout:6e4,pendingTimeout:6e4,delta:6e4,maxPeers:5,a:1,b:5,signaling:{address:"https://signaling.herokuapp.com/",room:"best-room-for-foglet-rps"}}},overlays:[],ssh:void 0}},f=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n._options=s(u(),t),n._options.id||(n._options.id=o()),n._options.rps.options.peer=n._options.id,n._id=n._options.id,n._networkManager=new a(n._options),n._options.ssh&&n._options.ssh.address&&(n._ssh=new c({foglet:n,address:n._options.ssh.address})),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),r(e,[{key:"connection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._options.pendingTimeout;return new Promise(function(i,o){null!==t?e.overlay(n).signaling.connection(t.overlay(n).network,r).then(function(t){e.emit("connect"),i(t.connected)}).catch(function(t){o(t)}):e.overlay(n).signaling.connection(null,r).then(function(t){e.emit("connect"),i(t.connected)}).catch(function(t){o(t)})})}},{key:"share",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.overlay(t).signaling.signaling()}},{key:"unshare",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.overlay(t).signaling.unsignaling()}},{key:"overlay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._networkManager.overlay(t)}},{key:"use",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._networkManager.registerMiddleware(t,e)}},{key:"onBroadcast",value:function(t){this.overlay().communication.onBroadcast(t)}},{key:"onStreamBroadcast",value:function(t){this.overlay().communication.onStreamBroadcast(t)}},{key:"sendBroadcast",value:function(t){return this.overlay().communication.sendBroadcast(t)}},{key:"streamBroadcast",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return this.overlay().communication.streamBroadcast(t)}},{key:"onUnicast",value:function(t){this.overlay().communication.onUnicast(t)}},{key:"onStreamUnicast",value:function(t){this.overlay().communication.onStreamUnicast(t)}},{key:"sendUnicast",value:function(t,e){return this.overlay().communication.sendUnicast(t,e)}},{key:"streamUnicast",value:function(t){return this.overlay().communication.streamUnicast(t)}},{key:"sendMulticast",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];return this.overlay().communication.sendMulticast(t,e)}},{key:"getRandomNeighbourId",value:function(){var t=this.overlay().network.getNeighbours();if(0===t.length)return null;try{return t[Math.floor(Math.random()*t.length)]}catch(t){return console.err(t),null}}},{key:"getNeighbours",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return this.overlay().network.getNeighbours(t)}},{key:"id",get:function(){return this._id}},{key:"inViewID",get:function(){return this.overlay().network.inviewId}},{key:"outViewID",get:function(){return this.overlay().network.outviewId}}]),e}();t.exports=f},function(t,e,n){"use strict";t.exports=0},function(t,e,n){"use strict";var r=n(69);t.exports=function(t){if(!t||"string"!=typeof t||t.length<6)return!1;for(var e=r.characters(),n=t.length,i=0;i<n;i++)if(-1===e.indexOf(t[i]))return!1;return!0}},function(t,e,n){"use strict";var r,i,o=n(153),s=n(69),a=1459707606518,c=6;t.exports=function(t){var e="",n=Math.floor(.001*(Date.now()-a));return n===i?r++:(r=0,i=n),e+=o(s.lookup,c),e+=o(s.lookup,t),r>0&&(e+=o(s.lookup,r)),e+=o(s.lookup,n)}},function(t,e,n){"use strict";var r=n(69);t.exports=function(t){var e=r.shuffled();return{version:15&e.indexOf(t.substr(0,1)),worker:15&e.indexOf(t.substr(1,1))}}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i="object"===("undefined"==typeof window?"undefined":r(window))&&(window.crypto||window.msCrypto);t.exports=function(){if(!i||!i.getRandomValues)return 48&Math.floor(256*Math.random());var t=new Uint8Array(1);return i.getRandomValues(t),48&t[0]}},function(t,e,n){"use strict";var r=1;t.exports={nextValue:function(){return(r=(9301*r+49297)%233280)/233280},seed:function(t){r=t}}},function(t,e,n){"use strict";var r=n(69),i=(n(153),n(335)),o=n(334),s=n(333),a=n(332)||0;function c(){return o(a)}t.exports=c,t.exports.generate=c,t.exports.seed=function(e){return r.seed(e),t.exports},t.exports.worker=function(e){return a=e,t.exports},t.exports.characters=function(t){return void 0!==t&&r.characters(t),r.shuffled()},t.exports.decode=i,t.exports.isValid=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=(a(n(154)),n(93)),o=a(n(213)),s=n(12);function a(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r._foglet=n,r._options=t,r.name=t.name,r.date=new Date,r.user=t.user,r.uid=r.user.id,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.EventEmitter),r(e,[{key:"init",value:function(){var t,e=(t=regeneratorRuntime.mark(function t(){var e,r,s,a=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this._options,void 0,!e.foglet){t.next=8;break}return t.next=5,this._foglet.connection(e.foglet);case 5:t.sent,t.next=12;break;case 8:return this._foglet.share(),t.next=11,this._foglet.connection();case 11:t.sent;case 12:if(console.log("application connected!"),this._data_comm=new i.communication(this._foglet.overlay().network,"anti-entropy"),this._behaviours_comm=new i.communication(this._foglet.overlay().network,"No-anti-entropy"),this.core=new o.default(this.uid,{webrtc:e.webRTCOptions,signalingOptions:e.signalingOptions,editingSessionID:e.editingSessionID},this._data_comm,this._behaviours_comm),this.core.on("sendChangeTitle",function(){a.core.sendChangeTitle(a.name)}),this.core.on("changeTitle",function(t){a.title=t,a.name=t,a.emit("changeTitle",t)}),e.importFromJSON&&this.core.init(e.importFromJSON),this.broadcast=this._data_comm.broadcast,this.broadcastCaret=this._behaviours_comm.broadcast,this.rps=this._data_comm.network.rps,this.sequence=this.core.sequence,this.causality=this.broadcast._causality,this.signalingOptions=e.signalingOptions,!e.display){t.next=31;break}return t.next=28,Promise.resolve().then(n.t.bind(null,544,7));case 28:r=t.sent,s=r.View,this._view=new s(e,this,e.containerID);case 31:this._foglet.emit("connected"),this.emit("connected");case 33:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var s=e[i](o),a=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})});return function(){return e.apply(this,arguments)}}()}]),e}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=h(n(339)),s=n(93),a=h(n(154)),c=h(n(11)),u=h(n(201)),f=n(12),l=h(n(189));function h(t){return t&&t.__esModule?t:{default:t}}
/*!
 * \brief transform the selected division into a distributed and decentralized 
 * collaborative editor.
 * \param options {
 *   signalingOptions: configure the signaling service to join or share the
 *     document. {address: http://example.of.signaling.service.address,
 *                session: the-session-unique-identifier,
 *                connect: true|false}
 *   webRTCOptions: configure the STUN/TURN server to establish WebRTC
 *     connections.
 *   styleOptions: change the default styling options of the editor.
 *   name: the name of the document
 *   importFromJSON: the json object containing the aformentionned options plus
 *     the saved sequence. If any of the other above options are specified, the
 *     option in the json object are erased by them.
 * }
 */
var p=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n._defaultOptions=r({},t),n._options=r({},t),t.foglet?n.justDoIt():n.init(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,f.EventEmitter),i(e,[{key:"init",value:function(){var t=this;console.log(this._options);var e=this._options.signalingServer+"/ice";fetch(e).then(function(t){return t.json()}).then(function(e){t._options.webRTCOptions=(0,c.default)({config:{iceServers:[{url:t._options.stun,urls:t._options.stun}]}},{config:{iceServers:e.ice},trickle:!0}),t._options.webRTCOptions.config.iceServers.forEach(function(t){t.urls=t.url}),console.log(t._options.webRTCOptions),t.justDoIt()})}},{key:"justDoIt",value:function(){var t=this;this._options.editingSession&&(this._options.signalingOptions={server:this._options.signalingServer,session:this._options.editingSession},u.default.get("CRATE2-"+this._options.editingSession)&&(this._options.signalingOptions={},this._options.importFromJSON=u.default.get("CRATE2-"+this._options.editingSession),this._options.signalingOptions.connect=!0));var e=this.GUID();this._options.user={id:e,pseudo:"Anonymous"},this._options.display&&u.default.get("myId")&&(this._options.user=u.default.get("myId")),this._previous=null,this._next=null;var n=this.constructor;n.actualSession&&null!=n.actualSession?(n.lastSession._next=this,this._previous=n.lastSession,n.lastSession=this,n.actualSession=this):(n.actualSession=this,n.lastSession=this,n.headSession=this);var r=this._options.webRTCOptions;this._options.wrtc&&(r.wrtc=this._options.wrtc);var i=this._options&&this._options.storageServer||"",a=this.constructor.GUID(),f=(0,c.default)({address:this._options.signalingServer,session:a},this._options&&this._options.importFromJSON&&this._options.importFromJSON.signalingOptions,this._options&&this._options.signalingOptions||{});f.room=f.session,this._editingSessionID=this._options.user.id+"-"+this.constructor.GUID();var l={id:this._editingSessionID,verbose:!0,rps:{type:"spray-wrtc",options:{protocol:f.sessionId,webrtc:r,timeout:3e4,pendingTimeout:3e4,delta:3e4,signaling:f}}};this._options.name=this._options&&this._options.name||this._options&&this._options.importFromJSON&&this._options.importFromJSON.title||"Untitled document",this._options=(0,c.default)(this._options,{webRTCOptions:r,storageServer:i,signalingOptions:f,fogletOptions:l}),this._options.editingSessionID=this._editingSessionID,this._options.foglet||(this._options.webRTCOptions.trickle=!0),this._foglet=new s.Foglet(l),this._documents=[];var h=new o.default(this._options,this._foglet);this._documents.push(h),h.init().then(function(){t.emit("new_document",h)})}},{key:"GUID",value:function(){return a.default.generate()}},{key:"getNext",value:function(){return _next}},{key:"getId",value:function(){return this._options.signalingOptions.session}},{key:"getPrevious",value:function(){return _previous}},{key:"moveToNext",value:function(){null!=this._next&&(this.constructor.actualSession=this._next,this.goTo(this.constructor.actualSession.getId()))}},{key:"moveToPrevious",value:function(){null!=this._previous&&(this.constructor.actualSession=this._previous,this.goTo(this.constructor.actualSession.getId()))}},{key:"goTo",value:function(t){var e=this.constructor.getCrateSession(t);e._previous&&(t=e._previous.getId()),this.constructor.focusOnSession(t,e.getId())}},{key:"close",value:function(){var t=this;for(var e in this._foglet.unshare(),this._foglet._networkManager._rps.network._rps.disconnect(),this._documents[0]._view._editor.stopPing(),clearInterval(this._documents[0]._view._timerStorageServer),this._documents[0]._view._editor.markers)clearInterval(e.timer);setTimeout(function(){t._foglet._networkManager._rps.network._rps.disconnect(),t._document=null,t._foglet=null},2e3)}}],[{key:"getCrateSession",value:function(t){for(var e=this.headSession;null!==e;){if(t===e.getId())return e;e=e._next}return!1}},{key:"GUID",value:function(){return a.default.generate()}},{key:"focusOnSession",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;jQuery('*[id^="container"]').removeClass("activeEditor"),jQuery("#container-"+n).addClass("activeEditor");var i=void 0;r?r.viewEditor.focus():(i=e.getCrateSession(n))._documents[0]._view?i._documents[0]._view._editor.viewEditor.focus():console.warn("There is no view for the following session"+i),jQuery("html, body").animate({scrollLeft:jQuery("#container-"+t).offset().left-40},"slow")}},{key:"openIn",value:function(){var t=$("#content-default a"),n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var c=s.value;c.href.includes(window.location.href.split("?")[0])&&(c.onclick=function(){var t=this.href.split("?")[1],n=e.getCrateSession(t);if(n._previous&&(t=n._previous.getId()),jQuery("#container-"+t).length)e.focusOnSession(t,this.href.split("?")[1]);else new e(Object.assign(r({},e.actualSession._defaultOptions),{editingSession:t}))})}}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}}}]),e}();e.default=p,p.Marker=l.default},function(t,e,n){"use strict";t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){"use strict";var r=n(0),i=n(341)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(t){return i(t)}})},function(t,e,n){"use strict";n(342),t.exports=n(26).RegExp.escape},function(t,e,n){"use strict";(function(t,e){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var r,i=Object.prototype,o=i.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag",f="object"===n(e),l=t.regeneratorRuntime;if(l)f&&(e.exports=l);else{(l=t.regeneratorRuntime=f?e.exports:{}).wrap=w;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={},g={};g[a]=function(){return this};var m=Object.getPrototypeOf,b=m&&m(m(M([])));b&&b!==i&&o.call(b,a)&&(g=b);var _=E.prototype=k.prototype=Object.create(g);S.prototype=_.constructor=E,E.constructor=S,E[u]=S.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===S||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(_),t},l.awrap=function(t){return{__await:t}},x(O.prototype),O.prototype[c]=function(){return this},l.AsyncIterator=O,l.async=function(t,e,n,r){var i=new O(w(t,e,n,r));return l.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},x(_),_[u]="Generator",_[a]=function(){return this},_.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=M,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return a.type="throw",a.arg=t,e.next=n,i&&(e.method="next",e.arg=r),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var c=o.call(s,"catchLoc"),u=o.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;j(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:M(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),v}}}function w(t,e,n,r){var i=e&&e.prototype instanceof k?e:k,o=Object.create(i.prototype),s=new T(r||[]);return o._invoke=function(t,e,n){var r=h;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===y){if("throw"===i)throw o;return R()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=A(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var c=C(t,e,n);if("normal"===c.type){if(r=n.done?y:p,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=y,n.method="throw",n.arg=c.arg)}}}(t,n,s),o}function C(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function k(){}function S(){}function E(){}function x(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function O(e){function r(t,i,s,a){var c=C(e[t],e,i);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"===(void 0===f?"undefined":n(f))&&o.call(f,"__await")?Promise.resolve(f.__await).then(function(t){r("next",t,s,a)},function(t){r("throw",t,s,a)}):Promise.resolve(f).then(function(t){u.value=t,s(u)},a)}a(c.arg)}var i;"object"===n(t.process)&&t.process.domain&&(r=t.process.domain.bind(r)),this._invoke=function(t,e){function n(){return new Promise(function(n,i){r(t,e,n,i)})}return i=i?i.then(n,n):n()}}function A(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,A(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=C(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,v):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function M(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=r,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:r,done:!0}}}("object"===(void 0===t?"undefined":n(t))?t:"object"===("undefined"==typeof window?"undefined":n(window))?window:"object"===("undefined"==typeof self?"undefined":n(self))?self:void 0)}).call(this,n(6),n(54)(t))},function(t,e,n){"use strict";for(var r=n(98),i=n(45),o=n(17),s=n(2),a=n(18),c=n(56),u=n(5),f=u("iterator"),l=u("toStringTag"),h=c.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(p),y=0;y<d.length;y++){var v,g=d[y],m=p[g],b=s[g],_=b&&b.prototype;if(_&&(_[f]||a(_,f,h),_[l]||a(_,l,g),c[g]=h,m))for(v in r)_[v]||o(_,v,r[v],!0)}},function(t,e,n){"use strict";var r=n(0),i=n(97);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(75),s=[].slice,a=/MSIE .\./.test(o),c=function(t){return function(e,n){var r=arguments.length>2,i=!!r&&s.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*a,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},function(t,e,n){"use strict";var r=n(0),i=n(2),o=n(26),s=n(96)(),a=n(5)("observable"),c=n(14),u=n(1),f=n(40),l=n(38),h=n(18),p=n(39),d=p.RETURN,y=function(t){return null==t?void 0:c(t)},v=function(t){var e=t._c;e&&(t._c=void 0,e())},g=function(t){return void 0===t._o},m=function(t){g(t)||(t._o=void 0,v(t))},b=function(t,e){u(t),this._c=void 0,this._o=t,t=new _(this);try{var n=e(t),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:c(n),this._c=n)}catch(e){return void t.error(e)}g(this)&&v(this)};b.prototype=l({},{unsubscribe:function(){m(this)}});var _=function(t){this._s=t};_.prototype=l({},{next:function(t){var e=this._s;if(!g(e)){var n=e._o;try{var r=y(n.next);if(r)return r.call(n,t)}catch(t){try{m(e)}finally{throw t}}}},error:function(t){var e=this._s;if(g(e))throw t;var n=e._o;e._o=void 0;try{var r=y(n.error);if(!r)throw t;t=r.call(n,t)}catch(t){try{v(e)}finally{throw t}}return v(e),t},complete:function(t){var e=this._s;if(!g(e)){var n=e._o;e._o=void 0;try{var r=y(n.complete);t=r?r.call(n,t):void 0}catch(t){try{v(e)}finally{throw t}}return v(e),t}}});var w=function(t){f(this,w,"Observable","_f")._f=c(t)};l(w.prototype,{subscribe:function(t){return new b(t,this._f)},forEach:function(t){var e=this;return new(o.Promise||i.Promise)(function(n,r){c(t);var i=e.subscribe({next:function(e){try{return t(e)}catch(t){r(t),i.unsubscribe()}},error:r,complete:n})})}}),l(w,{from:function(t){var e="function"==typeof this?this:w,n=y(u(t)[a]);if(n){var r=u(n.call(t));return r.constructor===e?r:new e(function(t){return r.subscribe(t)})}return new e(function(e){var n=!1;return s(function(){if(!n){try{if(p(t,!1,function(t){if(e.next(t),n)return d})===d)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var e=!1;return s(function(){if(!e){for(var r=0;r<n.length;++r)if(t.next(n[r]),e)return;t.complete()}}),function(){e=!0}})}}),h(w.prototype,a,function(){return this}),r(r.G,{Observable:w}),n(41)("Observable")},function(t,e,n){"use strict";var r=n(0),i=n(96)(),o=n(2).process,s="process"==n(24)(o);r(r.G,{asap:function(t){var e=s&&o.domain;i(e?e.bind(t):t)}})},function(t,e,n){"use strict";var r=n(33),i=n(1),o=n(14),s=r.key,a=r.set;r.exp({metadata:function(t,e){return function(n,r){a(t,e,(void 0!==r?i:o)(n),s(r))}}})},function(t,e,n){"use strict";var r=n(33),i=n(1),o=r.has,s=r.key;r.exp({hasOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){"use strict";var r=n(33),i=n(1),o=n(19),s=r.has,a=r.key;r.exp({hasMetadata:function(t,e){return function t(e,n,r){if(s(e,n,r))return!0;var i=o(n);return null!==i&&t(e,i,r)}(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){"use strict";var r=n(33),i=n(1),o=r.keys,s=r.key;r.exp({getOwnMetadataKeys:function(t){return o(i(t),arguments.length<2?void 0:s(arguments[1]))}})},function(t,e,n){"use strict";var r=n(33),i=n(1),o=r.get,s=r.key;r.exp({getOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){"use strict";var r=n(165),i=n(156),o=n(33),s=n(1),a=n(19),c=o.keys,u=o.key;o.exp({getMetadataKeys:function(t){return function t(e,n){var o=c(e,n),s=a(e);if(null===s)return o;var u=t(s,n);return u.length?o.length?i(new r(o.concat(u))):u:o}(s(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,e,n){"use strict";var r=n(33),i=n(1),o=n(19),s=r.has,a=r.get,c=r.key;r.exp({getMetadata:function(t,e){return function t(e,n,r){if(s(e,n,r))return a(e,n,r);var i=o(n);return null!==i?t(e,i,r):void 0}(t,i(e),arguments.length<3?void 0:c(arguments[2]))}})},function(t,e,n){"use strict";var r=n(33),i=n(1),o=r.key,s=r.map,a=r.store;r.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:o(arguments[2]),r=s(i(e),n,!1);if(void 0===r||!r.delete(t))return!1;if(r.size)return!0;var c=a.get(e);return c.delete(n),!!c.size||a.delete(e)}})},function(t,e,n){"use strict";var r=n(33),i=n(1),o=r.key,s=r.set;r.exp({defineMetadata:function(t,e,n,r){s(t,e,i(n),o(r))}})},function(t,e,n){"use strict";var r=n(0),i=n(95),o=n(169);r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){"use strict";var r=n(0),i=n(26),o=n(2),s=n(76),a=n(168);r(r.P+r.R,"Promise",{finally:function(t){var e=s(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return a(e,t()).then(function(){return n})}:t,n?function(n){return a(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{umulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,s=n>>>16,a=r>>>16,c=(s*o>>>0)+(i*o>>>16);return s*a+(c>>>16)+((i*a>>>0)+(65535&c)>>>16)}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{scale:n(155)})},function(t,e,n){"use strict";var r=n(0),i=Math.PI/180;r(r.S,"Math",{radians:function(t){return t*i}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{imulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,s=n>>16,a=r>>16,c=(s*o>>>0)+(i*o>>>16);return s*a+(c>>16)+((i*a>>>0)+(65535&c)>>16)}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{isubh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{iaddh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(t,e,n){"use strict";var r=n(0),i=n(155),o=n(175);r(r.S,"Math",{fscale:function(t,e,n,r,s){return o(i(t,e,n,r,s))}})},function(t,e,n){"use strict";var r=n(0),i=180/Math.PI;r(r.S,"Math",{degrees:function(t){return t*i}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){"use strict";var r=n(0),i=n(24);r(r.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"System",{global:n(2)})},function(t,e,n){"use strict";var r=n(0);r(r.G,{global:n(2)})},function(t,e,n){"use strict";n(70)("WeakSet")},function(t,e,n){"use strict";n(70)("WeakMap")},function(t,e,n){"use strict";n(70)("Set")},function(t,e,n){"use strict";n(70)("Map")},function(t,e,n){"use strict";n(71)("WeakSet")},function(t,e,n){"use strict";n(71)("WeakMap")},function(t,e,n){"use strict";n(71)("Set")},function(t,e,n){"use strict";n(71)("Map")},function(t,e,n){"use strict";var r=n(0);r(r.P+r.R,"Set",{toJSON:n(157)("Set")})},function(t,e,n){"use strict";var r=n(0);r(r.P+r.R,"Map",{toJSON:n(157)("Map")})},function(t,e,n){"use strict";var r=n(0),i=n(10),o=n(32),s=n(19),a=n(20).f;n(9)&&r(r.P+n(72),"Object",{__lookupSetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=a(n,r))return e.set}while(n=s(n))}})},function(t,e,n){"use strict";var r=n(0),i=n(10),o=n(32),s=n(19),a=n(20).f;n(9)&&r(r.P+n(72),"Object",{__lookupGetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=a(n,r))return e.get}while(n=s(n))}})},function(t,e,n){"use strict";var r=n(0),i=n(10),o=n(14),s=n(8);n(9)&&r(r.P+n(72),"Object",{__defineSetter__:function(t,e){s.f(i(this),t,{set:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),i=n(10),o=n(14),s=n(8);n(9)&&r(r.P+n(72),"Object",{__defineGetter__:function(t,e){s.f(i(this),t,{get:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),i=n(158)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){"use strict";var r=n(0),i=n(158)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){"use strict";var r=n(0),i=n(161),o=n(21),s=n(20),a=n(102);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),c=s.f,u=i(r),f={},l=0;u.length>l;)void 0!==(n=c(r,e=u[l++]))&&a(f,e,n);return f}})},function(t,e,n){"use strict";n(118)("observable")},function(t,e,n){"use strict";n(118)("asyncIterator")},function(t,e,n){"use strict";var r=n(0),i=n(31),o=n(7),s=n(80),a=n(78),c=RegExp.prototype,u=function(t,e){this._r=t,this._s=e};n(106)(u,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),r(r.P,"String",{matchAll:function(t){if(i(this),!s(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in c?String(t.flags):a.call(t),r=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(t.lastIndex),new u(r,e)}})},function(t,e,n){"use strict";n(57)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";n(57)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";var r=n(0),i=n(159),o=n(75);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";var r=n(0),i=n(159),o=n(75);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(108)(!0);r(r.P,"String",{at:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(160),o=n(10),s=n(7),a=n(30),c=n(100);r(r.P,"Array",{flatten:function(){var t=arguments[0],e=o(this),n=s(e.length),r=c(e,0);return i(r,e,e,n,0,void 0===t?1:a(t)),r}}),n(35)("flatten")},function(t,e,n){"use strict";var r=n(0),i=n(160),o=n(10),s=n(7),a=n(14),c=n(100);r(r.P,"Array",{flatMap:function(t){var e,n,r=o(this);return a(t),e=s(r.length),n=c(r,0),i(n,r,r,e,0,1,t,arguments[1]),n}}),n(35)("flatMap")},function(t,e,n){"use strict";var r=n(0),i=n(83)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(35)("includes")},function(t,e,n){"use strict";var r=n(0),i=n(114);i&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var r=n(8),i=n(20),o=n(19),s=n(22),a=n(0),c=n(47),u=n(1),f=n(4);a(a.S,"Reflect",{set:function t(e,n,a){var l,h,p=arguments.length<4?e:arguments[3],d=i.f(u(e),n);if(!d){if(f(h=o(e)))return t(h,n,a,p);d=c(0)}if(s(d,"value")){if(!1===d.writable||!f(p))return!1;if(l=i.f(p,n)){if(l.get||l.set||!1===l.writable)return!1;l.value=a,r.f(p,n,l)}else r.f(p,n,c(0,a));return!0}return void 0!==d.set&&(d.set.call(p,a),!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Reflect",{ownKeys:n(161)})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){"use strict";var r=n(0),i=n(19),o=n(1);r(r.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,e,n){"use strict";var r=n(20),i=n(0),o=n(1);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(o(t),e)}})},function(t,e,n){"use strict";var r=n(20),i=n(19),o=n(22),s=n(0),a=n(4),c=n(1);s(s.S,"Reflect",{get:function t(e,n){var s,u,f=arguments.length<3?e:arguments[2];return c(e)===f?e[n]:(s=r.f(e,n))?o(s,"value")?s.value:void 0!==s.get?s.get.call(f):void 0:a(u=i(e))?t(u,n,f):void 0}})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(106)(o,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),r(r.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,n){"use strict";var r=n(0),i=n(20).f,o=n(1);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=i(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var r=n(8),i=n(0),o=n(1),s=n(32);i(i.S+i.F*n(3)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){o(t),e=s(e,!0),o(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var r=n(0),i=n(43),o=n(14),s=n(1),a=n(4),c=n(3),u=n(182),f=(n(2).Reflect||{}).construct,l=c(function(){function t(){}return!(f(function(){},[],t)instanceof t)}),h=!c(function(){f(function(){})});r(r.S+r.F*(l||h),"Reflect",{construct:function(t,e){o(t),s(e);var n=arguments.length<3?t:o(arguments[2]);if(h&&!l)return f(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(u.apply(t,r))}var c=n.prototype,p=i(a(c)?c:Object.prototype),d=Function.apply.call(t,p,e);return a(d)?d:p}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(1),s=(n(2).Reflect||{}).apply,a=Function.apply;r(r.S+r.F*!n(3)(function(){s(function(){})}),"Reflect",{apply:function(t,e,n){var r=i(t),c=o(n);return s?s(r,e,c):a.call(r,e,c)}})},function(t,e,n){"use strict";n(34)("Float64",8,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){"use strict";n(34)("Float32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){"use strict";n(34)("Uint32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){"use strict";n(34)("Int32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){"use strict";n(34)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){"use strict";n(34)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){"use strict";n(34)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},function(t,e,n){"use strict";n(34)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){"use strict";n(34)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){"use strict";var r=n(0);r(r.G+r.W+r.F*!n(73).ABV,{DataView:n(94).DataView})},function(t,e,n){"use strict";var r=n(0),i=n(73),o=n(94),s=n(1),a=n(44),c=n(7),u=n(4),f=n(2).ArrayBuffer,l=n(76),h=o.ArrayBuffer,p=o.DataView,d=i.ABV&&f.isView,y=h.prototype.slice,v=i.VIEW;r(r.G+r.W+r.F*(f!==h),{ArrayBuffer:h}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return d&&d(t)||u(t)&&v in t}}),r(r.P+r.U+r.F*n(3)(function(){return!new h(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==y&&void 0===e)return y.call(s(this),t);for(var n=s(this).byteLength,r=a(t,n),i=a(void 0===e?n:e,n),o=new(l(this,h))(c(i-r)),u=new p(this),f=new p(o),d=0;r<i;)f.setUint8(d++,u.getUint8(r++));return o}}),n(41)("ArrayBuffer")},function(t,e,n){"use strict";var r=n(163),i=n(55);n(74)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"WeakSet"),t,!0)}},r,!1,!0)},function(t,e,n){"use strict";var r,i,o,s,a=n(36),c=n(2),u=n(25),f=n(62),l=n(0),h=n(4),p=n(14),d=n(40),y=n(39),v=n(76),g=n(97).set,m=n(96)(),b=n(95),_=n(169),w=n(75),C=n(168),k=c.TypeError,S=c.process,E=S&&S.versions,x=E&&E.v8||"",O=c.Promise,A="process"==f(S),P=function(){},j=i=b.f,T=!!function(){try{var t=O.resolve(1),e=(t.constructor={})[n(5)("species")]=function(t){t(P,P)};return(A||"function"==typeof PromiseRejectionEvent)&&t.then(P)instanceof e&&0!==x.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(t){}}(),M=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},R=function(t,e){if(!t._n){t._n=!0;var n=t._c;m(function(){for(var r=t._v,i=1==t._s,o=0,s=function(e){var n,o,s,a=i?e.ok:e.fail,c=e.resolve,u=e.reject,f=e.domain;try{a?(i||(2==t._h&&N(t),t._h=1),!0===a?n=r:(f&&f.enter(),n=a(r),f&&(f.exit(),s=!0)),n===e.promise?u(k("Promise-chain cycle")):(o=M(n))?o.call(n,c,u):c(n)):u(r)}catch(t){f&&!s&&f.exit(),u(t)}};n.length>o;)s(n[o++]);t._c=[],t._n=!1,e&&!t._h&&I(t)})}},I=function(t){g.call(c,function(){var e,n,r,i=t._v,o=F(t);if(o&&(e=_(function(){A?S.emit("unhandledRejection",i,t):(n=c.onunhandledrejection)?n({promise:t,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=A||F(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},F=function(t){return 1!==t._h&&0===(t._a||t._c).length},N=function(t){g.call(c,function(){var e;A?S.emit("rejectionHandled",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})})},D=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),R(e,!0))},B=function t(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw k("Promise can't be resolved itself");(n=M(e))?m(function(){var i={_w:r,_d:!1};try{n.call(e,u(t,i,1),u(D,i,1))}catch(t){D.call(i,t)}}):(r._v=e,r._s=1,R(r,!1))}catch(t){D.call({_w:r,_d:!1},t)}}};T||(O=function(t){d(this,O,"Promise","_h"),p(t),r.call(this);try{t(u(B,this,1),u(D,this,1))}catch(t){D.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(38)(O.prototype,{then:function(t,e){var n=j(v(this,O));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=A?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&R(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=u(B,t,1),this.reject=u(D,t,1)},b.f=j=function(t){return t===O||t===s?new o(t):i(t)}),l(l.G+l.W+l.F*!T,{Promise:O}),n(58)(O,"Promise"),n(41)("Promise"),s=n(26).Promise,l(l.S+l.F*!T,"Promise",{reject:function(t){var e=j(this);return(0,e.reject)(t),e.promise}}),l(l.S+l.F*(a||!T),"Promise",{resolve:function(t){return C(a&&this===s?O:this,t)}}),l(l.S+l.F*!(T&&n(79)(function(t){O.all(t).catch(P)})),"Promise",{all:function(t){var e=this,n=j(e),r=n.resolve,i=n.reject,o=_(function(){var n=[],o=0,s=1;y(t,!1,function(t){var a=o++,c=!1;n.push(void 0),s++,e.resolve(t).then(function(t){c||(c=!0,n[a]=t,--s||r(n))},i)}),--s||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=j(e),r=n.reject,i=_(function(){y(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(t,e,n){"use strict";n(77)("split",2,function(t,e,r){var i=n(80),o=r,s=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var a=void 0===/()??/.exec("")[1];r=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!i(t))return o.call(n,t,e);var r,c,u,f,l,h=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,y=void 0===e?4294967295:e>>>0,v=new RegExp(t.source,p+"g");for(a||(r=new RegExp("^"+v.source+"$(?!\\s)",p));(c=v.exec(n))&&!((u=c.index+c[0].length)>d&&(h.push(n.slice(d,c.index)),!a&&c.length>1&&c[0].replace(r,function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(c[l]=void 0)}),c.length>1&&c.index<n.length&&s.apply(h,c.slice(1)),f=c[0].length,d=u,h.length>=y));)v.lastIndex===c.index&&v.lastIndex++;return d===n.length?!f&&v.test("")||h.push(""):h.push(n.slice(d)),h.length>y?h.slice(0,y):h}}else"0".split(void 0,0).length&&(r=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(n,i){var o=t(this),s=void 0==n?void 0:n[e];return void 0!==s?s.call(n,o,i):r.call(String(o),n,i)},r]})},function(t,e,n){"use strict";n(77)("search",1,function(t,e,n){return[function(n){var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){"use strict";n(77)("replace",2,function(t,e,n){return[function(r,i){var o=t(this),s=void 0==r?void 0:r[e];return void 0!==s?s.call(r,o,i):n.call(String(o),r,i)},n]})},function(t,e,n){"use strict";n(77)("match",1,function(t,e,n){return[function(n){var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){"use strict";n(170);var r=n(1),i=n(78),o=n(9),s=/./.toString,a=function(t){n(17)(RegExp.prototype,"toString",t,!0)};n(3)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?a(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=s.name&&a(function(){return s.call(this)})},function(t,e,n){"use strict";var r=n(2),i=n(112),o=n(8).f,s=n(42).f,a=n(80),c=n(78),u=r.RegExp,f=u,l=u.prototype,h=/a/g,p=/a/g,d=new u(h)!==h;if(n(9)&&(!d||n(3)(function(){return p[n(5)("match")]=!1,u(h)!=h||u(p)==p||"/a/i"!=u(h,"i")}))){u=function(t,e){var n=this instanceof u,r=a(t),o=void 0===e;return!n&&r&&t.constructor===u&&o?t:i(d?new f(r&&!o?t.source:t,e):f((r=t instanceof u)?t.source:t,r&&o?c.call(t):e),n?this:l,u)};for(var y=function(t){t in u||o(u,t,{configurable:!0,get:function(){return f[t]},set:function(e){f[t]=e}})},v=s(f),g=0;v.length>g;)y(v[g++]);l.constructor=u,u.prototype=l,n(17)(r,"RegExp",u)}n(41)("RegExp")},function(t,e,n){"use strict";n(41)("Array")},function(t,e,n){"use strict";var r=n(0),i=n(28)(6),o="findIndex",s=!0;o in[]&&Array(1)[o](function(){s=!1}),r(r.P+r.F*s,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(35)(o)},function(t,e,n){"use strict";var r=n(0),i=n(28)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(35)("find")},function(t,e,n){"use strict";var r=n(0);r(r.P,"Array",{fill:n(99)}),n(35)("fill")},function(t,e,n){"use strict";var r=n(0);r(r.P,"Array",{copyWithin:n(172)}),n(35)("copyWithin")},function(t,e,n){"use strict";var r=n(0),i=n(21),o=n(30),s=n(7),a=[].lastIndexOf,c=!!a&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(c||!n(23)(a)),"Array",{lastIndexOf:function(t){if(c)return a.apply(this,arguments)||0;var e=i(this),n=s(e.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}})},function(t,e,n){"use strict";var r=n(0),i=n(83)(!1),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(s||!n(23)(o)),"Array",{indexOf:function(t){return s?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(173);r(r.P+r.F*!n(23)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(173);r(r.P+r.F*!n(23)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var r=n(0),i=n(28)(4);r(r.P+r.F*!n(23)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(28)(3);r(r.P+r.F*!n(23)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(28)(2);r(r.P+r.F*!n(23)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(28)(1);r(r.P+r.F*!n(23)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(4),i=n(81),o=n(5)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(0),i=n(28)(0),o=n(23)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(10),s=n(3),a=[].sort,c=[1,2,3];r(r.P+r.F*(s(function(){c.sort(void 0)})||!s(function(){c.sort(null)})||!n(23)(a)),"Array",{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),i(t))}})},function(t,e,n){"use strict";var r=n(0),i=n(115),o=n(24),s=n(44),a=n(7),c=[].slice;r(r.P+r.F*n(3)(function(){i&&c.call(i)}),"Array",{slice:function(t,e){var n=a(this.length),r=o(this);if(e=void 0===e?n:e,"Array"==r)return c.call(this,t,e);for(var i=s(t,n),u=s(e,n),f=a(u-i),l=new Array(f),h=0;h<f;h++)l[h]="String"==r?this.charAt(i+h):this[i+h];return l}})},function(t,e,n){"use strict";var r=n(0),i=n(21),o=[].join;r(r.P+r.F*(n(64)!=Object||!n(23)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(0),i=n(102);r(r.S+r.F*n(3)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var r=n(25),i=n(0),o=n(10),s=n(174),a=n(103),c=n(7),u=n(102),f=n(101);i(i.S+i.F*!n(79)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,l,h=o(t),p="function"==typeof this?this:Array,d=arguments.length,y=d>1?arguments[1]:void 0,v=void 0!==y,g=0,m=f(h);if(v&&(y=r(y,d>2?arguments[2]:void 0,2)),void 0==m||p==Array&&a(m))for(n=new p(e=c(h.length));e>g;g++)u(n,g,v?y(h[g],g):h[g]);else for(l=m.call(h),n=new p;!(i=l.next()).done;g++)u(n,g,v?s(l,y,[i.value,g],!0):i.value);return n.length=g,n}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Array",{isArray:n(81)})},function(t,e,n){"use strict";var r=n(1),i=n(32);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(r(this),"number"!=t)}},function(t,e,n){"use strict";var r=n(5)("toPrimitive"),i=Date.prototype;r in i||n(18)(i,r,n(458))},function(t,e,n){"use strict";var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(17)(r,"toString",function(){var t=o.call(this);return t==t?i.call(this):"Invalid Date"})},function(t,e,n){"use strict";var r=n(3),i=Date.prototype.getTime,o=Date.prototype.toISOString,s=function(t){return t>9?t:"0"+t};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),r=e<0?"-":e>9999?"+":"";return r+("00000"+Math.abs(e)).slice(r?-6:-4)+"-"+s(t.getUTCMonth()+1)+"-"+s(t.getUTCDate())+"T"+s(t.getUTCHours())+":"+s(t.getUTCMinutes())+":"+s(t.getUTCSeconds())+"."+(n>99?n:"0"+s(n))+"Z"}:o},function(t,e,n){"use strict";var r=n(0),i=n(461);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){"use strict";var r=n(0),i=n(10),o=n(32);r(r.P+r.F*n(3)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";n(16)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){"use strict";n(16)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(16)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(16)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(16)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(16)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(16)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(16)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(16)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(16)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(16)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(16)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(16)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";var r=n(0),i=n(7),o=n(105),s="".startsWith;r(r.P+r.F*n(104)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return s?s.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";var r=n(0);r(r.P,"String",{repeat:n(111)})},function(t,e,n){"use strict";var r=n(0),i=n(105);r(r.P+r.F*n(104)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";var r=n(0),i=n(7),o=n(105),s="".endsWith;r(r.P+r.F*n(104)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),a=void 0===n?r:Math.min(i(n),r),c=String(t);return s?s.call(e,c,a):e.slice(a-c.length,a)===c}})},function(t,e,n){"use strict";var r=n(0),i=n(108)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(108)(!0);n(107)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";n(57)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var r=n(0),i=n(21),o=n(7);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=o(e.length),r=arguments.length,s=[],a=0;n>a;)s.push(String(e[a++])),a<r&&s.push(String(arguments[a]));return s.join("")}})},function(t,e,n){"use strict";var r=n(0),i=n(44),o=String.fromCharCode,s=String.fromCodePoint;r(r.S+r.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,s=0;r>s;){if(e=+arguments[s++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){"use strict";var r=n(0),i=n(109),o=Math.exp;r(r.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},function(t,e,n){"use strict";var r=n(0),i=n(109),o=Math.exp;r(r.S+r.F*n(3)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{sign:n(110)})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{log1p:n(176)})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){"use strict";var r=n(0),i=Math.imul;r(r.S+r.F*n(3)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){"use strict";var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var n,r,o=0,s=0,a=arguments.length,c=0;s<a;)c<(n=i(arguments[s++]))?(o=o*(r=c/n)*r+1,c=n):o+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*Math.sqrt(o)}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{fround:n(175)})},function(t,e,n){"use strict";var r=n(0),i=n(109);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){"use strict";var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){"use strict";var r=n(0),i=n(110);r(r.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){"use strict";var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){"use strict";var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){"use strict";var r=n(0),i=n(176),o=Math.sqrt,s=Math.acosh;r(r.S+r.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,e,n){"use strict";var r=n(0),i=n(180);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){"use strict";var r=n(0),i=n(179);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){"use strict";var r=n(0),i=n(177),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Number",{isInteger:n(177)})},function(t,e,n){"use strict";var r=n(0),i=n(2).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){"use strict";var r=n(0),i=n(3),o=n(178),s=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==s.call(1,void 0)})||!i(function(){s.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?s.call(e):s.call(e,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(30),o=n(178),s=n(111),a=1..toFixed,c=Math.floor,u=[0,0,0,0,0,0],f="Number.toFixed: incorrect invocation!",l=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*u[n],u[n]=r%1e7,r=c(r/1e7)},h=function(t){for(var e=6,n=0;--e>=0;)n+=u[e],u[e]=c(n/t),n=n%t*1e7},p=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==u[t]){var n=String(u[t]);e=""===e?n:e+s.call("0",7-n.length)+n}return e},d=function t(e,n,r){return 0===n?r:n%2==1?t(e,n-1,r*e):t(e*e,n/2,r)};r(r.P+r.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(3)(function(){a.call({})})),"Number",{toFixed:function(t){var e,n,r,a,c=o(this,f),u=i(t),y="",v="0";if(u<0||u>20)throw RangeError(f);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(y="-",c=-c),c>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(c*d(2,69,1))-69)<0?c*d(2,-e,1):c/d(2,e,1),n*=4503599627370496,(e=52-e)>0){for(l(0,n),r=u;r>=7;)l(1e7,0),r-=7;for(l(d(10,r,1),0),r=e-1;r>=23;)h(1<<23),r-=23;h(1<<r),l(1,1),h(2),v=p()}else l(0,n),l(1<<-e,0),v=p()+s.call("0",u);return v=u>0?y+((a=v.length)<=u?"0."+s.call("0",u-a)+v:v.slice(0,a-u)+"."+v.slice(a-u)):y+v}})},function(t,e,n){"use strict";var r=n(2),i=n(22),o=n(24),s=n(112),a=n(32),c=n(3),u=n(42).f,f=n(20).f,l=n(8).f,h=n(57).trim,p=r.Number,d=p,y=p.prototype,v="Number"==o(n(43)(y)),g="trim"in String.prototype,m=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){var n,r,i,o=(e=g?e.trim():h(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var s,c=e.slice(2),u=0,f=c.length;u<f;u++)if((s=c.charCodeAt(u))<48||s>i)return NaN;return parseInt(c,r)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(v?c(function(){y.valueOf.call(n)}):"Number"!=o(n))?s(new d(m(e)),n,p):m(e)};for(var b,_=n(9)?u(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;_.length>w;w++)i(d,b=_[w])&&!i(p,b)&&l(p,b,f(d,b));p.prototype=y,y.constructor=p,n(17)(r,"Number",p)}},function(t,e,n){"use strict";var r=n(0),i=n(179);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){"use strict";var r=n(0),i=n(180);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(t,e,n){"use strict";var r=n(4),i=n(19),o=n(5)("hasInstance"),s=Function.prototype;o in s||n(8).f(s,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){"use strict";var r=n(8).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(9)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(0);r(r.P,"Function",{bind:n(182)})},function(t,e,n){"use strict";var r=n(62),i={};i[n(5)("toStringTag")]="z",i+""!="[object z]"&&n(17)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(t,e,n){"use strict";var r=n(0);r(r.S,"Object",{setPrototypeOf:n(114).set})},function(t,e,n){"use strict";t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";var r=n(0);r(r.S,"Object",{is:n(523)})},function(t,e,n){"use strict";var r=n(0);r(r.S+r.F,"Object",{assign:n(183)})},function(t,e,n){"use strict";var r=n(4);n(29)("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},function(t,e,n){"use strict";var r=n(4);n(29)("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){"use strict";var r=n(4);n(29)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){"use strict";var r=n(4),i=n(37).onFreeze;n(29)("preventExtensions",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){"use strict";var r=n(4),i=n(37).onFreeze;n(29)("seal",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){"use strict";var r=n(4),i=n(37).onFreeze;n(29)("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){"use strict";n(29)("getOwnPropertyNames",function(){return n(184).f})},function(t,e,n){"use strict";var r=n(10),i=n(45);n(29)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){"use strict";var r=n(10),i=n(19);n(29)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){"use strict";var r=n(21),i=n(20).f;n(29)("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},function(t,e,n){"use strict";var r=n(0);r(r.S+r.F*!n(9),"Object",{defineProperties:n(185)})},function(t,e,n){"use strict";var r=n(0);r(r.S+r.F*!n(9),"Object",{defineProperty:n(8).f})},function(t,e,n){"use strict";var r=n(0);r(r.S,"Object",{create:n(43)})},function(t,e,n){"use strict";var r=n(45),i=n(82),o=n(63);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var s,a=n(t),c=o.f,u=0;a.length>u;)c.call(t,s=a[u++])&&e.push(s);return e}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(2),o=n(22),s=n(9),a=n(0),c=n(17),u=n(37).KEY,f=n(3),l=n(84),h=n(58),p=n(46),d=n(5),y=n(187),v=n(118),g=n(539),m=n(81),b=n(1),_=n(4),w=n(21),C=n(32),k=n(47),S=n(43),E=n(184),x=n(20),O=n(8),A=n(45),P=x.f,j=O.f,T=E.f,M=i.Symbol,R=i.JSON,I=R&&R.stringify,F=d("_hidden"),N=d("toPrimitive"),D={}.propertyIsEnumerable,B=l("symbol-registry"),L=l("symbols"),U=l("op-symbols"),q=Object.prototype,z="function"==typeof M,V=i.QObject,W=!V||!V.prototype||!V.prototype.findChild,J=s&&f(function(){return 7!=S(j({},"a",{get:function(){return j(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=P(q,e);r&&delete q[e],j(t,e,n),r&&t!==q&&j(q,e,r)}:j,H=function(t){var e=L[t]=S(M.prototype);return e._k=t,e},$=z&&"symbol"==r(M.iterator)?function(t){return"symbol"==(void 0===t?"undefined":r(t))}:function(t){return t instanceof M},G=function(t,e,n){return t===q&&G(U,e,n),b(t),e=C(e,!0),b(n),o(L,e)?(n.enumerable?(o(t,F)&&t[F][e]&&(t[F][e]=!1),n=S(n,{enumerable:k(0,!1)})):(o(t,F)||j(t,F,k(1,{})),t[F][e]=!0),J(t,e,n)):j(t,e,n)},Y=function(t,e){b(t);for(var n,r=g(e=w(e)),i=0,o=r.length;o>i;)G(t,n=r[i++],e[n]);return t},Q=function(t){var e=D.call(this,t=C(t,!0));return!(this===q&&o(L,t)&&!o(U,t))&&(!(e||!o(this,t)||!o(L,t)||o(this,F)&&this[F][t])||e)},X=function(t,e){if(t=w(t),e=C(e,!0),t!==q||!o(L,e)||o(U,e)){var n=P(t,e);return!n||!o(L,e)||o(t,F)&&t[F][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=T(w(t)),r=[],i=0;n.length>i;)o(L,e=n[i++])||e==F||e==u||r.push(e);return r},K=function(t){for(var e,n=t===q,r=T(n?U:w(t)),i=[],s=0;r.length>s;)!o(L,e=r[s++])||n&&!o(q,e)||i.push(L[e]);return i};z||(c((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0);return s&&W&&J(q,t,{configurable:!0,set:function e(n){this===q&&e.call(U,n),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),J(this,t,k(1,n))}}),H(t)}).prototype,"toString",function(){return this._k}),x.f=X,O.f=G,n(42).f=E.f=Z,n(63).f=Q,n(82).f=K,s&&!n(36)&&c(q,"propertyIsEnumerable",Q,!0),y.f=function(t){return H(d(t))}),a(a.G+a.W+a.F*!z,{Symbol:M});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)d(tt[et++]);for(var nt=A(d.store),rt=0;nt.length>rt;)v(nt[rt++]);a(a.S+a.F*!z,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=M(t)},keyFor:function(t){if(!$(t))throw TypeError(t+" is not a symbol!");for(var e in B)if(B[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),a(a.S+a.F*!z,"Object",{create:function(t,e){return void 0===e?S(t):Y(S(t),e)},defineProperty:G,defineProperties:Y,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:K}),R&&a(a.S+a.F*(!z||f(function(){var t=M();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(_(e)||void 0!==t)&&!$(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!$(e))return e}),r[1]=e,I.apply(R,r)}}),M.prototype[N]||n(18)(M.prototype,N,M.prototype.valueOf),h(M,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){"use strict";n(540),n(538),n(537),n(536),n(535),n(534),n(533),n(532),n(531),n(530),n(529),n(528),n(527),n(526),n(525),n(524),n(522),n(521),n(520),n(519),n(518),n(517),n(516),n(515),n(514),n(513),n(512),n(511),n(510),n(509),n(508),n(507),n(506),n(505),n(504),n(503),n(502),n(501),n(500),n(499),n(498),n(497),n(496),n(495),n(494),n(493),n(492),n(491),n(490),n(489),n(488),n(487),n(486),n(485),n(484),n(483),n(482),n(481),n(480),n(479),n(478),n(477),n(476),n(475),n(474),n(473),n(472),n(471),n(470),n(469),n(468),n(467),n(466),n(465),n(464),n(463),n(462),n(460),n(459),n(457),n(456),n(455),n(454),n(453),n(452),n(451),n(449),n(448),n(447),n(446),n(445),n(444),n(443),n(442),n(441),n(440),n(439),n(438),n(437),n(98),n(436),n(435),n(170),n(434),n(433),n(432),n(431),n(430),n(167),n(165),n(164),n(429),n(428),n(427),n(426),n(425),n(424),n(423),n(422),n(421),n(420),n(419),n(418),n(417),n(416),n(415),n(414),n(413),n(412),n(411),n(410),n(409),n(408),n(407),n(406),n(405),n(404),n(403),n(402),n(401),n(400),n(399),n(398),n(397),n(396),n(395),n(394),n(393),n(392),n(391),n(390),n(389),n(388),n(387),n(386),n(385),n(384),n(383),n(382),n(381),n(380),n(379),n(378),n(377),n(376),n(375),n(374),n(373),n(372),n(371),n(370),n(369),n(368),n(367),n(366),n(365),n(364),n(363),n(362),n(361),n(360),n(359),n(358),n(357),n(356),n(355),n(354),n(353),n(352),n(351),n(350),n(349),n(348),n(347),n(346),n(345),t.exports=n(26)},function(t,e,n){"use strict";(function(t){if(n(541),n(344),n(343),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";function r(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}r(String.prototype,"padLeft","".padStart),r(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&r(Array,t,Function.call.bind([][t]))})}).call(this,n(6))},function(t,e,n){n(542),t.exports=n(340)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(549),o=n(548),s=n(547);(e.View=function(){function t(e,n,r){var a=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._options=e,this._editorsHolderID=r,this._editorContainerID="container-"+this._options.signalingOptions.room,this.createCRATE(),this._model=n,this._editor=new s.EditorController(n,e.signalingOptions.room,this._editorContainerID),session.config.storageServer&&(this._storageServerState={},this.findremote(!0),this._timerStorageServer=setInterval(function(){return a.findremote()},5e3),this._editor.on("thereAreChanges",function(){2===a._storageServerState&&a.join()}));var c=this._options.signalingOptions.session,u=session.default.getCrateSession(c);u._previous&&(c=u._previous._options.signalingOptions.session),session.default.focusOnSession(c,this._options.signalingOptions.session,this._editor);var f=new i.LinkView(jQuery("#"+this._editorContainerID+" #sharinglink")),l=jQuery("#"+this._editorContainerID+" #shareicon");this._statesHeader=new o.StatesHeader(n,f,l,this._editorContainerID),jQuery("#"+this._editorContainerID+" #closeDocument").click(function(){var t=session.default.getCrateSession(a._options.signalingOptions.room);session.headSession!==t?(t._previous&&(t._previous._next=t._next),t._next?t._next._previous=t._previous:session.lastSession=t._previous,jQuery("#"+a._editorContainerID).remove(),t.moveToPrevious(),t.close()):console.log("You cannot remove the first document")})}return r(t,[{key:"createCRATE",value:function(){var t=this,e=' \n<div class="col-md-10 editorContainer" id="'+this._editorContainerID+'" >\n \x3c!-- Head --\x3e\n   <div id="head">\n      <div id="firstrow" class="row">\n         <div id="connectionState">\n         </div>\n         <div id="title">\n            '+this._options.name+'\n         </div>\n         <div id="features">\n            <div id="shareicon">\n               <i class="fa fa-link fa-2x ficon2"></i>\n            </div>\n            <div id="saveicon"><i class="fa fa-floppy-o fa-2x ficon2"></i></div>\n            <div id="remotesave" style=" width: 20px;">\n               <i class="fa fa-cloud fa-2x ficon2"></i>\n            </div>\n            <div id="closeDocument" style="\n              float: right;\n             position: relative;\n                ">\n            <i class="fa fa-window-close" aria-hidden="true" ></i>\n            </div>\n         </div>\n      </div>\n      <div id="sharinglink" class="row">\n      </div>\n   </div>\n   \n \x3c!-- Content --\x3e\n   <div id="content" class="content">\n      <div id="users" class="row">\n         <div id="state" style="margin-left: -50px;" ">\n            <i class="fa fa-globe fa-3x ficon "></i>\n         </div>\n      </div>\n      <div id="editorSection">\n         <div id="editor" class="editor">\n         </div>\n         <div id="comments">\n         </div>\n      </div>\n   </div>\n\n\n  <div id="inputCommentModal" class="modal fade" role="dialog" style="display: none;">\n            <div class="modal-dialog">\n        \n                \x3c!-- Modal content--\x3e\n                <div class="modal-content">\n                    <div class="modal-body">\n                    <button type="button" class="close" data-dismiss="modal">×</button>\n                    <h4>Comment</h4>\n                    <p><textarea name="commentInput" id="commentInput" style="width: 100%;" rows="5"></textarea></p>\n                    </div>\n                    <div class="modal-footer">\n                    <button type="button" class="btn btn-default" id="saveComment"data-dismiss="modal">Save</button>\n                    </div>\n                </div>\n        \n            </div>\n        </div>\n    ';jQuery("#"+this._editorsHolderID).append(e),jQuery("#"+this._editorContainerID+" #saveComment").click(function(){t.saveComment()}),jQuery("#"+this._editorContainerID+" #remotesave").click(function(){jQuery("#"+t._editorContainerID+" #remotesave").hasClass("PIN")?t.kill():t.join()})}},{key:"saveComment",value:function(){this._editor.saveComment()}},{key:"findremote",value:function(t){var e=this,n=this._options.signalingOptions.room,r=jQuery("#"+this._editorContainerID+" #remotesave");if(session.config.storageServer){var i=session.config.storageServer+"/exist/"+n;fetch(i).then(function(t){return t.json()}).then(function(n){e._storageServerState=n.results,0==n.results?e.unpin(r):1==n.results?e.pin(r,"active"):t?e.join():e.pin(r,"sleep")}).catch(function(t){console.log(t),clearInterval(e._timerStorageServer),e.unpin(r)})}}},{key:"pin",value:function(t,e){"active"===e?t.css("color","green"):t.css("color","gray"),t.removeClass("UNPIN"),t.addClass("PIN")}},{key:"unpin",value:function(t){t.css("color","red"),t.removeClass("PIN"),t.addClass("UNPIN")}},{key:"join",value:function(){var t=this,e=this._options.signalingOptions.room;$.ajax({type:"GET",url:session.config.storageServer+"/join/"+e,success:function(e,n){t.findremote()},error:function(){t.findremote()},async:!0})}},{key:"kill",value:function(){var t=this,e=this._options.signalingOptions.room;1==confirm("Do you want remove document from remote server!")&&$.ajax({type:"GET",url:session.config.storageServer+"/kill/"+e,success:function(n,r){t.findremote(e)},async:!1})}}],[{key:"addMoveShortcuts",value:function(){var t={37:"prev",39:"next"};document.addEventListener&&document.addEventListener("keydown",function(e){var n=t[e.keyCode];if((e.ctrlKey||e.metaKey)&&n){var r=document.createEvent("Event");r.initEvent(n,!0,!1),e.target.dispatchEvent(r),e.preventDefault()}},!1),$(document).on("next",function(){console.log("next"),session.default.actualSession.moveToNext()}),$(document).on("prev",function(){console.log("prev"),session.default.actualSession.moveToPrevious()})}}]),t}()).addMoveShortcuts()},function(t,e,n){"use strict";var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(o){var s,a,c,u=(s=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,a=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,function(t,e,n,r){if(1!==arguments.length||"string"!==(null===(o=t)?"null":void 0===o?"undefined":"object"!==(void 0===o?"undefined":i(o))?void 0===o?"undefined":i(o):Array.isArray(o)?"array":{}.toString.call(o).slice(8,-1).toLowerCase())||/\d/.test(t)||(e=t,t=void 0),(t=t||new Date)instanceof Date||(t=new Date(t)),isNaN(t))throw TypeError("Invalid date");var o,l=(e=String(u.masks[e]||e||u.masks.default)).slice(0,4);"UTC:"!==l&&"GMT:"!==l||(e=e.slice(4),n=!0,"GMT:"===l&&(r=!0));var h=n?"getUTC":"get",p=t[h+"Date"](),d=t[h+"Day"](),y=t[h+"Month"](),v=t[h+"FullYear"](),g=t[h+"Hours"](),m=t[h+"Minutes"](),b=t[h+"Seconds"](),_=t[h+"Milliseconds"](),w=n?0:t.getTimezoneOffset(),C=function(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate());e.setDate(e.getDate()-(e.getDay()+6)%7+3);var n=new Date(e.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var r=e.getTimezoneOffset()-n.getTimezoneOffset();e.setHours(e.getHours()-r);var i=(e-n)/6048e5;return 1+Math.floor(i)}(t),k=function(t){var e=t.getDay();return 0===e&&(e=7),e}(t),S={d:p,dd:f(p),ddd:u.i18n.dayNames[d],dddd:u.i18n.dayNames[d+7],m:y+1,mm:f(y+1),mmm:u.i18n.monthNames[y],mmmm:u.i18n.monthNames[y+12],yy:String(v).slice(2),yyyy:v,h:g%12||12,hh:f(g%12||12),H:g,HH:f(g),M:m,MM:f(m),s:b,ss:f(b),l:f(_,3),L:f(Math.round(_/10)),t:g<12?u.i18n.timeNames[0]:u.i18n.timeNames[1],tt:g<12?u.i18n.timeNames[2]:u.i18n.timeNames[3],T:g<12?u.i18n.timeNames[4]:u.i18n.timeNames[5],TT:g<12?u.i18n.timeNames[6]:u.i18n.timeNames[7],Z:r?"GMT":n?"UTC":(String(t).match(a)||[""]).pop().replace(c,""),o:(w>0?"-":"+")+f(100*Math.floor(Math.abs(w)/60)+Math.abs(w)%60,4),S:["th","st","nd","rd"][p%10>3?0:(p%100-p%10!=10)*p%10],W:C,N:k};return e.replace(s,function(t){return t in S?S[t]:t.slice(1,t.length-1)})});function f(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}u.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},u.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},void 0===(r=function(){return u}.call(e,n,e,t))||(t.exports=r)}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Comments=void 0;var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(545);(r=o)&&r.__esModule;e.Comments=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._editorContainerID=e,this._viewEditor={},this._inputCommentModel=$("#"+this._editorContainerID+" #inputCommentModal"),this._comments=$("#"+this._editorContainerID+" #comments"),this._ql_editor=$("#"+this._editorContainerID+" .ql-editor"),this._editor=$("#"+this._editorContainerID+" .editor"),this._commentInput=$("#"+this._editorContainerID+" #commentInput"),this._currentTimestamp={},this._commentCallback={},this.commentAddClick=this.commentAddClick.bind(this),this.commentsClick=this.commentsClick.bind(this)}return i(t,[{key:"commentAddClick",value:function(t,e){this._commentCallback=t.bind(e),this._inputCommentModel.modal("show")}},{key:"commentServerTimestamp",value:function(){var t=this;return new Promise(function(e,n){t._currentTimestamp=Math.round((new Date).getTime()/1e3),e(t._currentTimestamp)})}},{key:"commentsClick",value:function(){this._comments.is(":visible")?(this._ql_editor.hasClass("ql-comments")&&this._ql_editor.removeClass("ql-comments"),this._comments.hide(),this._comments.css("width","0%"),this._editor.css("width","100%")):(this._comments.addClass("comment"),this._editor.hasClass("ql-comments")||this._editor.addClass("ql-comments"),this._comments.css("width","30%"),this._editor.css("width","70%"),this._comments.show())}},{key:"addCommentToList",value:function(t,e,n,r,i,o){var s=this,a=o,c=new Date,u=dateFormat(c,"dddd, mmmm dS, yyyy, h:MM:ss TT"),f="ql-comment-"+e+"-"+a,l=$("<div class='comment-box "+f+" row' id='comment-box-"+f+"' tabindex=\"1\" title='"+u+"'>\n      <div class='comment-head row'>\n        <div id=\""+f+'"style="background-color:'+i+';width: 40px;" ><img class="imageuser" src="./icons/'+n+'.png" alt="'+r+"\"></div>\n    \n        <div class='comment-details'>\n          <div class='comment-author'>"+r+"</div>\n        </div>\n      </div>\n      <div class='comment-body row' >"+t+"</div>\n  \n    </div>");this._comments.append(l),$("#comment-box-"+f).focusin(function(){s.commentBoxFocus(f)}),$("#comment-box-"+f).focusout(function(){s.commentBoxFocus(f,"out")})}},{key:"saveComment",value:function(){var t=this._commentInput.val();this._commentCallback(t);var e=this._viewEditor.options.modules.comment.commentAddOn,n=this._viewEditor.options.modules.comment.commentAuthorId,r=this._viewEditor.options.modules.comment.color;this.addCommentToList(t,n,e,store.get("myId").pseudo,r,this._currentTimestamp)}},{key:"commentBoxFocus",value:function(t,e){"out"!==e?($(".ql-comments #"+t).addClass("commentFocus"),this._comments.find("."+t).css("border-color","red")):($(".ql-comments #"+t).removeClass("commentFocus"),this._comments.find(".comment-box").css("border-color","#F0F0F0"))}},{key:"viewEditor",get:function(){return this._viewEditor},set:function(t){this._viewEditor=t}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditorController=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(189),o=n(546),s=n(12);var a=n(190)("crate:view:editor");Quill.register("modules/cursors",QuillCursors),Quill.register("modules/comment",QuillComment);e.EditorController=function(t){function e(t,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.model=t,i.markers={},i.startTimer={},i.viewEditor={},i._editorContainerID=r,i._comments=new o.Comments(i._editorContainerID),i._sessionID=n,i.loadDocument(n),i.startPing(5e3),jQuery("#"+i._editorContainerID+" #saveicon").click(function(){i.saveDocument()}),jQuery("#"+i._editorContainerID+" #title").focusout(function(){i.changeTitle(),i.emit("thereAreChanges")}),i.viewEditor.on("selection-change",function(t,e,n){t&&i.model.core.caretMoved(t)}),i.viewEditor.on("text-change",function(t,e,n){i.textChange(t,e,n),i.emit("thereAreChanges")}),i.model.core.on("remoteInsert",function(t,e){i.remoteInsert(t,e),i.emit("thereAreChanges")}),i.model.core.on("remoteRemove",function(t){i.remoteRemove(t),i.emit("thereAreChanges")}),i.model.core.on("remoteCaretMoved",function(t,e){i.remoteCaretMoved(t,e)}),i.model.core.on("remoteCaretMoved",function(t,e){i.remoteCaretMoved(t,e)}),i.model.on("changeTitle",function(t){jQuery("#"+i._editorContainerID+" #title").text(t),i.emit("thereAreChanges")}),i.model.core.on("ping",function(t,e){i.atPing(t,e)}),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.EventEmitter),r(e,[{key:"loadDocument",value:function(t){var e=this;if(this.createViewDocument(),store.get("CRATE2-"+t)){var n=store.get("CRATE2-"+t);this.viewEditor.setContents(n.delta,"user"),jQuery("#"+this._editorContainerID+" #title").text(n.title),session.default.openIn()}jQuery("#"+this._editorContainerID+" #title").click(function(){jQuery("#"+e._editorContainerID+" #title").attr("contenteditable","true")}),this.markers={},this.model.markers=this.markers;var r=this.model.uid;this.markers[r]=new i.Marker(r,{lifeTime:5e3,range:{index:0,length:0},cursor:!1,isItME:!0},this),store.get("myId")?this.markers[r].setPseudo(store.get("myId").pseudo):store.set("myId",{id:r,pseudo:this.markers[r].pseudoName}),this.UpdateComments();var o=this.viewEditor.options.modules.comment;o.commentAddOn=this.markers[r].animal,o.commentAuthorId=this.model.uid,o.color=this.markers[r].colorRGB}},{key:"createViewDocument",value:function(){var t=new Quill("#"+this._editorContainerID+" #editor",{modules:{formula:!0,toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],["bold","italic","underline","strike"],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["clean"],["formula","image","link"],["subdocument"],["comments-toggle"],["comments-add"]],handlers:{subdocument:function(t){this.quill.getSelection();var e=window.location.href.split("?")[0]+"?"+session.default.GUID();this.quill.theme.tooltip.edit("link",e)},undo:function(t){this.quill.history.undo()},redo:function(t){this.quill.history.redo()}}},cursors:{autoRegisterListener:!0,hideDelay:500,hideSpeed:0},history:{delay:500,maxStack:1e3},comment:{enabled:!0,commentAuthorId:123,commentAddOn:"Author Name",color:"yellow",commentAddClick:this._comments.commentAddClick,commentsClick:this._comments.commentsClick,commentTimestamp:this._comments.commentServerTimestamp,containerID:this._editorContainerID}},theme:"snow"});$(".ql-subdocument .ql-comments-toggle .ql-comments-add").attr("data-toggle","tooltip"),$(".ql-comments-toggle,.ql-comments-add").css({position:"relative",top:"-5px"}),$(".ql-subdocument").html("<strong>SUB</strong>"),$(".ql-subdocument").attr("title","Add subdocument"),$(".ql-comments-toggle").html('<i class="fa fa-comments"></i>'),$(".ql-comments-toggle").attr("title","Show/hide comments"),$(".ql-comments-add").html('<i class="fa fa-comment"></i>'),$(".ql-comments-add").attr("title","Add comment"),t.theme.tooltip.save2=t.theme.tooltip.save,t.theme.tooltip.save=function(){t.theme.tooltip.save2(),session.default.openIn()},this._comments.viewEditor=t,this.viewEditor=t}},{key:"saveDocument",value:function(){var t={date:(new Date).getTime(),title:jQuery("#"+this._editorContainerID+" #title").text(),delta:this.viewEditor.editor.delta,sequence:this.model.sequence,causality:this.model.causality,name:this.model.name,webRTCOptions:this.model.webRTCOptions,markers:{},signalingOptions:this.model.signalingOptions};store.set("CRATE2-"+this.model.signalingOptions.session,t),alert("Document is saved successfully")}},{key:"textChange",value:function(t,e,n){this.cleanQuill(),this.applyChanges(t,0)}},{key:"applyChanges",value:function(t,e){var n=this,r=e;JSON.parse(JSON.stringify(t,null,2)).ops.forEach(function(t){for(var e=Object.keys(t),i="",o="",s="",a=e.length-1;a>=0;a--){var c=t[e[a]];"attributes"===e[a]?o=c:(i=e[a],s=c)}r=n.sendIt("",o,0,s,i,r,!1)})}},{key:"sendIt",value:function(t,e,n,r,i,o,s){switch(i){case"retain":if(""!=e){this.sendIt("","",o,r,"delete",o,!0);var c=this.viewEditor.editor.delta.slice(o,o+r);this.applyChanges(c,o)}else o+=r;break;case"insert":if(t=r,void 0!=r.formula)e=this.viewEditor.getFormat(o,1),this.model.core.insert({type:"formula",text:r,att:e},o);else if(void 0!=r.video)e=this.viewEditor.getFormat(o,1),this.model.core.insert({type:"video",text:r,att:e},o);else if(void 0!=r.image)e=this.viewEditor.getFormat(o,1),this.model.core.insert({type:"image",text:r,att:e},o);else{for(var u=o;u<o+t.length;++u)e=this.viewEditor.getFormat(u,1),a("Local insert : ",t[u-o],u),this.model.core.insert({type:"char",text:t[u-o],att:e},u);o+=t.length}break;case"delete":var f=r;s||this.UpdateComments(),0==n&&(n=o);for(u=n;u<n+f;++u)this.model.core.remove(n)}return o}},{key:"remoteInsert",value:function(t,e){var n=e-1;if(a("Remote Insert : ",t,n),-1!==n){switch(t.type){case"formula":this.viewEditor.insertEmbed(n,"formula",t.text.formula,"silent");break;case"image":this.viewEditor.insertEmbed(n,"image",t.text.image,"silent");break;case"video":this.viewEditor.insertEmbed(n,"video",t.text.video,"silent");break;case"char":this.viewEditor.insertText(n,t.text,t.att,"silent"),"\n"!=t.text&&this.viewEditor.removeFormat(n,1,"silent")}t.att&&("\n"!=t.text&&(this.viewEditor.formatLine(n,t.att,"silent"),this.viewEditor.formatText(n,1,t.att,"silent")),t.att.commentAuthor&&this.UpdateComments(),t.att.link&&session.default.openIn())}session.default.openIn(),this.cleanQuill()}},{key:"remoteRemove",value:function(t){a("Remote remove : ",t);var e=t-1;-1!==e&&(this.viewEditor.deleteText(e,1,"silent"),this.UpdateComments()),this.cleanQuill()}},{key:"remoteCaretMoved",value:function(t,e){if(e)if(this.markers[e])this.markers[e].update(t,!0);else{var n={lifeTime:5e3,range:t,cursor:!1,isItME:!1};this.markers[e]=new i.Marker(e,n,this)}}},{key:"cleanQuill",value:function(){}},{key:"changeTitle",value:function(){jQuery("#"+this._editorContainerID+" #title").attr("contenteditable","false"),""==jQuery("#"+this._editorContainerID+" #title").text()&&jQuery("#"+this._editorContainerID+" #title").text("Untitled document"),this.model.name=jQuery("#"+this._editorContainerID+" #title").text(),this.model.core.sendChangeTitle(jQuery("#"+this._editorContainerID+" #title").text())}},{key:"startPing",value:function(t){var e=this;this.startTimer=setInterval(function(){var t="Anonymous";store.get("myId").pseudo&&(t=store.get("myId").pseudo),e.model.core.sendPing(t)},t)}},{key:"stopPing",value:function(){clearInterval(this.startTimer)}},{key:"atPing",value:function(t,e){if(this.markers[t])this.markers[t].update(null,!1),this.markers[t].setPseudo(e);else{this.markers[t]=new i.Marker(t,{lifeTime:5e3,range:{index:0,length:0},cursor:!1,isItME:!1},this),this.markers[t].setPseudo(e)}}},{key:"UpdateComments",value:function(){var t=this;jQuery("#"+this._editorContainerID+" #comments").empty(),this.viewEditor.editor.delta.ops.forEach(function(e){if(e.insert&&e.attributes&&e.attributes.commentAuthor){var n=e.attributes.commentAuthor,r={},o=(r=t.markers[n]?t.markers[n]:{animal:i.Marker.getPseudoname(n,null),pseudoName:i.Marker.getPseudoname(n),colorRGB:i.Marker.getColor(n,"rgb")}).animal,s=r.pseudoName,a=r.colorRGB;t._comments.addCommentToList(e.attributes.comment,n,o,s,a,e.attributes.commentTimestamp)}})}},{key:"saveComment",value:function(){this._comments.saveComment()}}]),e}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.StatesHeader=function(){function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e,this.startSharingText='<i class="fa fa-link fa-2x ficon2"></i>',this.startSharingTooltip="start sharing",this.stopSharingText='<i class="fa fa-unlink fa-2x ficon2"></i>',this.stopSharingTooltip="stop sharing",this.red="#cd2626",this.yellow="#eead0e",this.green="#228b22",this.blue="#00BFFF",this._editorContainerID=i,this.networkState=jQuery("#"+this._editorContainerID+" #state"),this.setNetworkState("connected"),e.rps.on("statechange",function(t){switch(t){case"connected":o.setNetworkState("connected");break;case"partially connected":o.setNetworkState("partiallyConnected");break;case"disconnected":o.setNetworkState("disconnected")}}),r.click(function(){var t=window.location.href.split("?")[0];n.printLink(t+"?"+o.model.signalingOptions.session),jQuery("#"+o._editorContainerID+" #copyButton").click(function(){o.copyLink()})}),n.qrcode.click(function(){var t=window.location.href.split("?")[0];t=t+"?"+o.model.signalingOptions.session,n.qrcodeCanvas.html(""),n.qrcodeCanvas.qrcode({size:400,text:t})})}return r(t,[{key:"copyLink",value:function(){console.log("Copy => #"+this._editorContainerID+" #sessionUrl"),jQuery("#"+this._editorContainerID+" #sessionUrl").select(),document.execCommand("Copy")}},{key:"setNetworkState",value:function(t){switch(t){case"connected":this.networkState.css("color",this.green),this.networkState.attr("data-content","<span class='alert-success'>Congratulations!</span>\n                     You are connected to people, and people are \n                     connected to you. <span class='alert-info'>You can start editing \" \n                     together</span>.");break;case"partiallyConnected":this.networkState.css("color",this.green),this.networkState.attr("data-content","<span class='alert-warning'>Partially connected</span>: \n                     either you are connected to people, or people are connected to you. \n                     This is not great, but you <span class='alert-info'> still can edit.</span>");break;case"disconnected":this.networkState.css("color",this.red),this.networkState.attr("data-content","<span class='alert-danger'>Disconnected</span>:\n                     you are currently editing <span class='alert-info'>on\n                    your own</span>.")}}}]),t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.LinkView=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.linkContainer=jQuery("<div>").appendTo(e).css("position","relative").css("top","0px").css("width","45vw-25px").css("z-index","0").css("opacity","0.9").attr("id","linkContainer").hide();var r=jQuery("<div>").appendTo(e).attr("id","modalQRCode"+n).attr("tabindex","-1").attr("role","dialog").attr("aria-labelledby","modalQRCodeLabel").attr("aria-hidden","true").addClass("modal"),i=jQuery("<div>").appendTo(r).addClass("modal-dialog"),o=jQuery("<div>").appendTo(i).addClass("modal-content text-center");this.qrcodeCanvas=jQuery("<div>"),o.append(jQuery("<br>")).append(this.qrcodeCanvas).append(jQuery("<br>")),this.alert=jQuery("<div>").appendTo(this.linkContainer),this.dismiss=jQuery("<button>").appendTo(this.alert).attr("type","button").addClass("close").html('<span  aria-hidden="true">&times;</span><span class="sr-only"> Close </span>');var s=jQuery("<div>").appendTo(this.alert).addClass("container"),a=jQuery("<div>").appendTo(s).addClass("input-group").attr("style","margin-left: -16px;");this.input=jQuery("<input>").appendTo(a).attr("type","text").attr("id","sessionUrl").attr("placeholder","Nothing to see here, move along.").addClass("form-control");var c=jQuery("<span>").appendTo(a).addClass("input-group-btn");this.qrcode=jQuery("<button>").appendTo(c).attr("aria-label","QR-code").attr("type","button").attr("data-target","#modalQRCode"+n).attr("data-toggle","modal").addClass("btn btn-default").html('<i class="fa fa-qrcode"></i>'),this.action=jQuery('<button  id="copyButton">').appendTo(c).attr("aria-label","Go!").attr("type","button").addClass("btn btn-default").html("Go!").css("z-index","15");var u=this;this.dismiss.unbind("click").click(function(){u.linkContainer.hide()})}return r(t,[{key:"printLink",value:function(t){this.linkContainer.show(),this.action.html('<i class="fa fa-clipboard"></i>'),this.action.attr("aria-label","Copy to clipboard"),this.input.attr("readonly","readonly"),this.input.val(t),this.qrcode.show()}},{key:"printLaunchLink",value:function(t){return this.printLink(t),this.input.attr("placeholder","A link will appear in this field, give it to your friend!"),this.action.unbind("click"),this.qrcode.hide(),this.action}},{key:"printAnswerLink",value:function(t){return this.printLink(t),this.input.attr("placeholder","A link will appear in this field. Please give it back to your friend."),this.action.unbind("click"),this.qrcode.hide(),this.action}},{key:"askLink",value:function(){this.linkContainer.show(),this.alert.removeClass("alert-warning").addClass("alert-info"),this.action.html("Go!"),this.action.attr("aria-label","Stamp the ticket"),this.input.removeAttr("readonly"),this.input.val(""),this.action.unbind("click"),this.qrcode.hide()}},{key:"askLaunchLink",value:function(){return this.askLink(),this.input.attr("placeholder","Please, copy the ticket of your friend here to stamp it!"),this.qrcode.hide(),this.action}},{key:"askAnswerLink",value:function(){return this.askLink(),this.input.attr("placeholder","Copy the stamped ticket to confirm your arrival in the network"),this.qrcode.hide(),this.action}},{key:"hide",value:function(){this.linkContainer.hide()}}]),t}()}]);
//# sourceMappingURL=jquery-crate.bundle.js.map